import{s as u,j as e,L as q}from"./index-ryn4JIWc.js";import{r as s}from"./vendor-react-JFEV0ROX.js";import{P as O}from"./PageHeader-CckMRJhZ.js";import{U as F,as as K,C as p,y as h,k as M,z as V,Z as C,K as Y,O as N,Q as k}from"./vendor-icons-CiBQmrAI.js";import"./vendor-supabase-DgEUAXvv.js";function se(){const[B,E]=s.useState(!0),[o,l]=s.useState(!1),[i,U]=s.useState(null),[R,I]=s.useState(null),[d,x]=s.useState(""),[y,c]=s.useState(null),[j,b]=s.useState(null),[G,A]=s.useState(""),[a,w]=s.useState(""),[m,v]=s.useState(""),[H,Q]=s.useState(!1),[f,L]=s.useState(!1),[g,T]=s.useState(!1),[S,n]=s.useState(null),[P,z]=s.useState(null);s.useEffect(()=>{_()},[]);async function _(){try{const{data:{user:r}}=await u.auth.getUser();if(r){U(r),x(r.email||"");const{data:t}=await u.from("profiles").select("*").eq("id",r.id).single();t&&I(t)}}catch{}finally{E(!1)}}async function D(r){if(r.preventDefault(),c(null),b(null),!d){c("Please enter an email address");return}if(d===i.email){c("This is already your current email");return}l(!0);try{const{error:t}=await u.auth.updateUser({email:d});if(t)throw t;b("Confirmation email sent to your new address. Please check your inbox and confirm to complete the change.")}catch(t){c(t.message)}finally{l(!1)}}async function W(r){if(r.preventDefault(),n(null),z(null),!a){n("Please enter a new password");return}if(a.length<6){n("Password must be at least 6 characters");return}if(a!==m){n("Passwords do not match");return}l(!0);try{const{error:t}=await u.auth.updateUser({password:a});if(t)throw t;z("Password updated successfully!"),A(""),w(""),v("")}catch(t){n(t.message)}finally{l(!1)}}return B?e.jsx(q,{message:"Loading account settings...",size:"large",fullPage:!0}):e.jsxs("div",{className:"page-container",children:[e.jsx(O,{icon:F,title:"Account Settings",subtitle:"Manage your account details and security"}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(K,{size:20})," Account Overview"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f1f5f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.25rem"},children:"Current Email"}),e.jsx("div",{style:{fontWeight:"600",wordBreak:"break-all"},children:i?.email||"Not set"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f1f5f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.25rem"},children:"Role"}),e.jsx("div",{style:{fontWeight:"600",textTransform:"capitalize"},children:R?.role||"User"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f1f5f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.25rem"},children:"Email Verified"}),e.jsx("div",{style:{fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:i?.email_confirmed_at?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:16,style:{color:"#16a34a"}}),e.jsx("span",{style:{color:"#16a34a"},children:"Verified"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{size:16,style:{color:"#f59e0b"}}),e.jsx("span",{style:{color:"#f59e0b"},children:"Pending"})]})})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f1f5f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.25rem"},children:"Last Sign In"}),e.jsxs("div",{style:{fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(M,{size:16,style:{color:"#64748b"}}),i?.last_sign_in_at?new Date(i.last_sign_in_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(V,{size:20})," Update Email Address"]}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"New Email Address"}),e.jsx("input",{type:"email",className:"form-input",value:d,onChange:r=>x(r.target.value),placeholder:"new.email@example.com"}),e.jsx("p",{style:{fontSize:"0.8rem",color:"#64748b",marginTop:"0.5rem"},children:"A confirmation email will be sent to your new address."})]}),y&&e.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b",fontSize:"0.875rem"},children:[e.jsx(h,{size:18}),y]}),j&&e.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"flex-start",gap:"0.5rem",color:"#166534",fontSize:"0.875rem"},children:[e.jsx(p,{size:18,style:{marginTop:"2px",flexShrink:0}}),j]}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:o,children:[e.jsx(C,{size:16})," ",o?"Updating...":"Update Email"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Y,{size:20})," Update Password"]}),e.jsxs("form",{onSubmit:W,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:f?"text":"password",className:"form-input",value:a,onChange:r=>w(r.target.value),placeholder:"Enter new password",style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>L(!f),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:f?e.jsx(N,{size:18}):e.jsx(k,{size:18})})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:g?"text":"password",className:"form-input",value:m,onChange:r=>v(r.target.value),placeholder:"Confirm new password",style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>T(!g),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:g?e.jsx(N,{size:18}):e.jsx(k,{size:18})})]})]}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f1f5f9",borderRadius:"6px",marginBottom:"1rem",fontSize:"0.8rem",color:"#64748b"},children:[e.jsx("div",{style:{fontWeight:"500",marginBottom:"0.25rem"},children:"Password requirements:"}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"1.25rem"},children:[e.jsx("li",{style:{color:a.length>=6?"#16a34a":"#64748b"},children:"At least 6 characters"}),e.jsx("li",{style:{color:a&&a===m?"#16a34a":"#64748b"},children:"Passwords match"})]})]}),S&&e.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b",fontSize:"0.875rem"},children:[e.jsx(h,{size:18}),S]}),P&&e.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534",fontSize:"0.875rem"},children:[e.jsx(p,{size:18}),P]}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:o||!a||!m,children:[e.jsx(C,{size:16})," ",o?"Updating...":"Update Password"]})]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:"1.5rem",backgroundColor:"#f0fdf4",borderLeft:"4px solid #22c55e"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem",color:"#166534"},children:"ðŸ”’ Security Tips"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 1.5rem",color:"#166534",fontSize:"0.9rem"},children:[e.jsx("li",{children:"Use a strong, unique password that you don't use elsewhere"}),e.jsx("li",{children:"Never share your password with anyone"}),e.jsx("li",{children:"Sign out when using shared computers"}),e.jsx("li",{children:"Contact an admin if you notice any suspicious account activity"})]})]})]})}export{se as default};
