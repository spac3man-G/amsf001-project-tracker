import{u as _e,a as ke,b as Se,c as Ce,m as we,k as Ne,q as Re,d as p,j as e,L as De}from"./index-C7qTjlkw.js";import{r as n,L as Ae}from"./vendor-react-JFEV0ROX.js";import{u as qe}from"./usePermissions-w_54rfno.js";import{P as Ie}from"./PageHeader-BxcRJLYW.js";import{P as Pe,Y as Te,e as B,_ as Y,a as ze,y as Me,w as J,k as We,a8 as V,C as w,Z as O,T as Fe}from"./vendor-icons-CMdlt-Xc.js";import"./vendor-supabase-DgEUAXvv.js";const H=["Not Started","In Progress","Submitted for Review","Returned for More Work","Review Complete","Delivered"],G={Delivered:{bg:"#dcfce7",color:"#16a34a",icon:w},"Review Complete":{bg:"#dbeafe",color:"#2563eb",icon:V},"Submitted for Review":{bg:"#fef3c7",color:"#d97706",icon:B},"In Progress":{bg:"#e0e7ff",color:"#4f46e5",icon:We},"Returned for More Work":{bg:"#fee2e2",color:"#dc2626",icon:J},"Not Started":{bg:"#f1f5f9",color:"#64748b",icon:Me}};function X({kpis:_,selectedIds:u,onChange:d,label:g="Link to KPIs"}){return e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:g}),u.length>0&&e.jsx("button",{type:"button",onClick:()=>d([]),style:{fontSize:"0.8rem",color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"Clear"})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"0.5rem"},children:_.map(l=>{const m=u.includes(l.id);return e.jsxs("div",{onClick:()=>d(m?u.filter(v=>v!==l.id):[...u,l.id]),style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"0.75rem",marginBottom:"0.5rem",backgroundColor:m?"#dbeafe":"#f8fafc",border:m?"2px solid #3b82f6":"1px solid #e2e8f0",borderRadius:"8px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:m,onChange:()=>{},style:{marginTop:"3px"}}),e.jsxs("div",{children:[e.jsx("span",{style:{backgroundColor:"#3b82f6",color:"white",padding:"0.125rem 0.375rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"700"},children:l.kpi_ref})," ",e.jsx("span",{style:{fontWeight:"600"},children:l.name})]})]},l.id)})}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"#64748b"},children:[u.length," selected"]})]})}function Z({qualityStandards:_,selectedIds:u,onChange:d,label:g="Link to Quality Standards"}){return e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:g}),u.length>0&&e.jsx("button",{type:"button",onClick:()=>d([]),style:{fontSize:"0.8rem",color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"Clear"})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"0.5rem"},children:_.map(l=>{const m=u.includes(l.id);return e.jsxs("div",{onClick:()=>d(m?u.filter(v=>v!==l.id):[...u,l.id]),style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"0.75rem",marginBottom:"0.5rem",backgroundColor:m?"#f3e8ff":"#f8fafc",border:m?"2px solid #8b5cf6":"1px solid #e2e8f0",borderRadius:"8px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:m,onChange:()=>{},style:{marginTop:"3px"}}),e.jsxs("div",{children:[e.jsx("span",{style:{backgroundColor:"#8b5cf6",color:"white",padding:"0.125rem 0.375rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"700"},children:l.qs_ref})," ",e.jsx("span",{style:{fontWeight:"600"},children:l.name})]})]},l.id)})}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"#64748b"},children:[u.length," selected"]})]})}function $e(){const{user:_,role:u}=_e(),{projectId:d}=ke(),{showSuccess:g,showError:l,showWarning:m}=Se(),{showTestUsers:v}=Ce(),S=_?.id||null,{canEditDeliverable:ee,canReviewDeliverable:se,canDeleteDeliverable:te}=qe(),[k,re]=n.useState([]),[N,ie]=n.useState([]),[R,ae]=n.useState([]),[D,le]=n.useState([]),[ne,E]=n.useState(!0),[K,A]=n.useState(!1),[de,q]=n.useState(!1),[oe,I]=n.useState(!1),[o,ce]=n.useState(null),[j,P]=n.useState({}),[y,T]=n.useState({}),[z,Q]=n.useState(""),[M,U]=n.useState(""),[C,ue]=n.useState(!1),[a,x]=n.useState({deliverable_ref:"",name:"",description:"",milestone_id:"",status:"Not Started",progress:0,assigned_to:"",due_date:"",kpi_ids:[],qs_ids:[]}),[r,h]=n.useState({id:"",deliverable_ref:"",name:"",description:"",milestone_id:"",status:"Not Started",progress:0,assigned_to:"",due_date:"",kpi_ids:[],qs_ids:[]}),f=n.useCallback(async()=>{if(d){E(!0);try{const s=await we.getAll(d,{orderBy:{column:"milestone_ref",ascending:!0}});ie(s);const t=await Ne.getAll(d,{orderBy:{column:"kpi_ref",ascending:!0}});ae(t);const i=await Re.getAll(d,{orderBy:{column:"qs_ref",ascending:!0}});le(i);const c=await p.getAllWithRelations(d,v);re(c||[])}catch{l("Failed to load deliverables")}finally{E(!1)}}},[d,v,l]);n.useEffect(()=>{f()},[f]);async function me(s){s.preventDefault();try{const t=await p.create({project_id:d,deliverable_ref:a.deliverable_ref,name:a.name,description:a.description,milestone_id:a.milestone_id||null,status:a.status,progress:parseInt(a.progress)||0,assigned_to:a.assigned_to,due_date:a.due_date||null,created_by:S});await p.syncKPILinks(t.id,a.kpi_ids),await p.syncQSLinks(t.id,a.qs_ids),x({deliverable_ref:"",name:"",description:"",milestone_id:"",status:"Not Started",progress:0,assigned_to:"",due_date:"",kpi_ids:[],qs_ids:[]}),A(!1),f(),g("Deliverable added!")}catch(t){l("Failed: "+t.message)}}function pe(s){h({id:s.id,deliverable_ref:s.deliverable_ref,name:s.name,description:s.description||"",milestone_id:s.milestone_id||"",status:s.status,progress:s.progress||0,assigned_to:s.assigned_to||"",due_date:s.due_date||"",kpi_ids:s.deliverable_kpis?.map(t=>t.kpi_id)||[],qs_ids:s.deliverable_quality_standards?.map(t=>t.quality_standard_id)||[]}),q(!0)}async function he(){try{await p.update(r.id,{name:r.name,description:r.description,milestone_id:r.milestone_id||null,status:r.status,progress:parseInt(r.progress)||0,assigned_to:r.assigned_to,due_date:r.due_date||null}),await p.syncKPILinks(r.id,r.kpi_ids),await p.syncQSLinks(r.id,r.qs_ids),q(!1),f(),g("Deliverable updated!")}catch(s){l("Failed: "+s.message)}}async function W(s,t){try{let i=s.progress;t==="Not Started"?i=0:["Submitted for Review","Review Complete","Delivered"].includes(t)?i=100:t==="Returned for More Work"&&(i=50),await p.update(s.id,{status:t,progress:i}),f()}catch(i){l("Failed: "+i.message)}}function xe(s){ce(s),P({}),T({}),I(!0)}async function ge(){if(!o)return;const s=o.deliverable_kpis||[],t=o.deliverable_quality_standards||[];if(s.length>0&&!s.every(i=>j[i.kpi_id]!==void 0)){m("Please assess all linked KPIs.");return}if(t.length>0&&!t.every(i=>y[i.quality_standard_id]!==void 0)){m("Please assess all linked Quality Standards.");return}try{if(await p.update(o.id,{status:"Delivered",progress:100}),s.length>0){const i=s.map(c=>({kpiId:c.kpi_id,criteriaMet:j[c.kpi_id]}));await p.upsertKPIAssessments(o.id,i,S)}if(t.length>0){const i=t.map(c=>({qsId:c.quality_standard_id,criteriaMet:y[c.quality_standard_id]}));await p.upsertQSAssessments(o.id,i,S)}g("Deliverable marked as delivered!"),I(!1),f()}catch(i){l("Failed: "+i.message)}}async function be(s){if(confirm("Delete this deliverable?"))try{await p.delete(s,S),f(),g("Deleted")}catch(t){l("Failed: "+t.message)}}let b=k;z&&(b=b.filter(s=>s.milestone_id===z)),M&&(b=b.filter(s=>s.status===M)),C&&(b=b.filter(s=>s.status==="Submitted for Review"));const fe=k.length,F=k.filter(s=>s.status==="Submitted for Review").length,ve=k.filter(s=>s.status==="In Progress").length,je=k.filter(s=>s.status==="Delivered").length,L=ee,$=se,ye=te;return ne?e.jsx(De,{message:"Loading deliverables...",size:"large",fullPage:!0}):e.jsxs("div",{className:"page-container",children:[e.jsx(Ie,{icon:Pe,title:"Deliverables",subtitle:"Track project deliverables with review workflow",children:L&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>A(!K),children:[e.jsx(Te,{size:18})," Add Deliverable"]})}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-label",children:"Total"}),e.jsx("div",{className:"stat-value",children:fe})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-label",style:{color:"#d97706"},children:"For Review"}),e.jsx("div",{className:"stat-value",style:{color:"#d97706"},children:F})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-label",style:{color:"#4f46e5"},children:"In Progress"}),e.jsx("div",{className:"stat-value",style:{color:"#4f46e5"},children:ve})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-label",style:{color:"#16a34a"},children:"Delivered"}),e.jsx("div",{className:"stat-value",style:{color:"#16a34a"},children:je})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginBottom:"1rem",flexWrap:"wrap"},children:[e.jsxs("select",{value:z,onChange:s=>Q(s.target.value),style:{minWidth:"200px"},children:[e.jsx("option",{value:"",children:"All Milestones"}),N.map(s=>e.jsxs("option",{value:s.id,children:[s.milestone_ref," - ",s.name]},s.id))]}),e.jsxs("select",{value:M,onChange:s=>U(s.target.value),style:{minWidth:"150px"},children:[e.jsx("option",{value:"",children:"All Statuses"}),H.map(s=>e.jsx("option",{value:s,children:s},s))]}),F>0&&e.jsxs("button",{onClick:()=>{ue(!C),C||(Q(""),U(""))},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:C?"#fef3c7":"#fffbeb",border:"1px solid #fbbf24",borderRadius:"6px",color:"#92400e",cursor:"pointer",fontWeight:"500"},children:[e.jsx(B,{size:16})," ",F," Awaiting Review"]})]}),K&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{children:"Add New Deliverable"}),e.jsxs("form",{onSubmit:me,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Ref *"}),e.jsx("input",{type:"text",value:a.deliverable_ref,onChange:s=>x({...a,deliverable_ref:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>x({...a,name:s.target.value}),required:!0})]})]}),e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:a.description,onChange:s=>x({...a,description:s.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Milestone *"}),e.jsxs("select",{value:a.milestone_id,onChange:s=>x({...a,milestone_id:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),N.map(s=>e.jsx("option",{value:s.id,children:s.milestone_ref},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Assigned To"}),e.jsx("input",{type:"text",value:a.assigned_to,onChange:s=>x({...a,assigned_to:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",value:a.due_date,onChange:s=>x({...a,due_date:s.target.value})})]})]}),e.jsx(X,{kpis:R,selectedIds:a.kpi_ids,onChange:s=>x({...a,kpi_ids:s})}),e.jsx(Z,{qualityStandards:D,selectedIds:a.qs_ids,onChange:s=>x({...a,qs_ids:s})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem"},children:[e.jsxs("button",{type:"submit",className:"btn-primary",children:[e.jsx(Y,{size:16})," Save"]}),e.jsxs("button",{type:"button",className:"btn-secondary",onClick:()=>A(!1),children:[e.jsx(ze,{size:16})," Cancel"]})]})]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Milestone"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Progress"}),e.jsx("th",{children:"KPIs"}),e.jsx("th",{children:"QS"}),e.jsx("th",{children:"Due"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{textAlign:"center",padding:"2rem",color:"#64748b"},children:"No deliverables found"})}):b.map(s=>{const t=G[s.status]||G["Not Started"],i=t.icon;return e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:"600"},children:s.deliverable_ref}),e.jsx("td",{style:{fontWeight:"500"},children:s.name}),e.jsx("td",{children:s.milestones?e.jsx(Ae,{to:`/milestones/${s.milestone_id}`,style:{color:"#3b82f6"},children:s.milestones.milestone_ref}):"-"}),e.jsx("td",{children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem",backgroundColor:t.bg,color:t.color},children:[e.jsx(i,{size:14}),s.status]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"60px",height:"8px",backgroundColor:"#e2e8f0",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s.progress||0}%`,height:"100%",backgroundColor:s.status==="Delivered"?"#16a34a":"#4f46e5"}})}),e.jsxs("span",{style:{fontSize:"0.85rem"},children:[s.progress||0,"%"]})]})}),e.jsx("td",{children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:s.deliverable_kpis?.map(c=>e.jsx("span",{style:{padding:"0.125rem 0.375rem",backgroundColor:"#dbeafe",color:"#2563eb",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"600"},children:c.kpis?.kpi_ref},c.kpi_id))})}),e.jsx("td",{children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:s.deliverable_quality_standards?.map(c=>e.jsx("span",{style:{padding:"0.125rem 0.375rem",backgroundColor:"#f3e8ff",color:"#7c3aed",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"600"},children:c.quality_standards?.qs_ref},c.quality_standard_id))})}),e.jsx("td",{children:s.due_date?new Date(s.due_date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[L&&e.jsx("button",{onClick:()=>pe(s),title:"Edit",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:e.jsx(O,{size:16})}),L&&["In Progress","Returned for More Work"].includes(s.status)&&e.jsx("button",{onClick:()=>W(s,"Submitted for Review"),title:"Submit",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#d97706"},children:e.jsx(B,{size:16})}),$&&s.status==="Submitted for Review"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>W(s,"Review Complete"),title:"Accept",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#2563eb"},children:e.jsx(V,{size:16})}),e.jsx("button",{onClick:()=>W(s,"Returned for More Work"),title:"Return",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#dc2626"},children:e.jsx(J,{size:16})})]}),$&&s.status==="Review Complete"&&e.jsx("button",{onClick:()=>xe(s),title:"Deliver",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#16a34a"},children:e.jsx(w,{size:16})}),ye&&e.jsx("button",{onClick:()=>be(s.id),title:"Delete",style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"#dc2626"},children:e.jsx(Fe,{size:16})})]})})]},s.id)})})]})}),de&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal modal-lg",children:[e.jsx("div",{className:"modal-header",children:e.jsxs("h3",{className:"modal-title",children:[e.jsx(O,{size:20})," Edit ",r.deliverable_ref]})}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Ref"}),e.jsx("input",{type:"text",value:r.deliverable_ref,disabled:!0,style:{backgroundColor:"var(--color-bg-secondary)"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>h({...r,name:s.target.value})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:s=>h({...r,description:s.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Milestone"}),e.jsxs("select",{value:r.milestone_id,onChange:s=>h({...r,milestone_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),N.map(s=>e.jsx("option",{value:s.id,children:s.milestone_ref},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Assigned To"}),e.jsx("input",{type:"text",value:r.assigned_to,onChange:s=>h({...r,assigned_to:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Due Date"}),e.jsx("input",{type:"date",value:r.due_date,onChange:s=>h({...r,due_date:s.target.value})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("select",{value:r.status,onChange:s=>{const t=s.target.value;let i=r.progress;t==="Not Started"?i=0:["Submitted for Review","Review Complete","Delivered"].includes(t)?i=100:t==="Returned for More Work"&&(i=50),h({...r,status:t,progress:i})},children:H.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Progress: ",r.progress,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",value:r.progress,onChange:s=>h({...r,progress:parseInt(s.target.value)}),style:{width:"100%"},disabled:["Delivered","Submitted for Review","Review Complete"].includes(r.status)})]})]}),e.jsx(X,{kpis:R,selectedIds:r.kpi_ids,onChange:s=>h({...r,kpi_ids:s})}),e.jsx(Z,{qualityStandards:D,selectedIds:r.qs_ids,onChange:s=>h({...r,qs_ids:s})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>q(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:he,children:[e.jsx(Y,{size:16})," Save"]})]})]})}),oe&&o&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal modal-lg",children:[e.jsx("div",{className:"modal-header",children:e.jsxs("h3",{className:"modal-title",children:[e.jsx(w,{size:20,style:{color:"var(--color-success)"}})," Mark as Delivered"]})}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{style:{color:"var(--color-text-secondary)",marginBottom:"var(--space-lg)"},children:[o.deliverable_ref," - ",o.name]}),o.deliverable_kpis?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{padding:"var(--space-md)",backgroundColor:"var(--color-warning-light)",borderLeft:"4px solid var(--color-warning)",borderRadius:"var(--radius)",marginBottom:"var(--space-md)"},children:e.jsx("strong",{style:{color:"#92400e"},children:"KPI Assessment Required"})}),o.deliverable_kpis.map(s=>{const t=R.find(i=>i.id===s.kpi_id);return t?e.jsxs("div",{style:{padding:"var(--space-md)",border:"1px solid var(--color-border)",borderRadius:"var(--radius)",marginBottom:"var(--space-sm)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge badge-info",children:t.kpi_ref})," ",e.jsx("strong",{style:{marginLeft:"var(--space-sm)"},children:t.name})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[e.jsx("button",{onClick:()=>P({...j,[s.kpi_id]:!0}),className:`btn btn-sm ${j[s.kpi_id]===!0?"btn-success":"btn-secondary"}`,children:"✓ Yes"}),e.jsx("button",{onClick:()=>P({...j,[s.kpi_id]:!1}),className:`btn btn-sm ${j[s.kpi_id]===!1?"btn-danger":"btn-secondary"}`,children:"✗ No"})]})]},s.kpi_id):null})]}),o.deliverable_quality_standards?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{padding:"var(--space-md)",backgroundColor:"var(--color-purple-light)",borderLeft:"4px solid var(--color-purple)",borderRadius:"var(--radius)",marginBottom:"var(--space-md)",marginTop:"var(--space-lg)"},children:e.jsx("strong",{style:{color:"#6b21a8"},children:"Quality Standards Assessment"})}),o.deliverable_quality_standards.map(s=>{const t=D.find(i=>i.id===s.quality_standard_id);return t?e.jsxs("div",{style:{padding:"var(--space-md)",border:"1px solid var(--color-border)",borderRadius:"var(--radius)",marginBottom:"var(--space-sm)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge badge-purple",children:t.qs_ref})," ",e.jsx("strong",{style:{marginLeft:"var(--space-sm)"},children:t.name})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[e.jsx("button",{onClick:()=>T({...y,[s.quality_standard_id]:!0}),className:`btn btn-sm ${y[s.quality_standard_id]===!0?"btn-success":"btn-secondary"}`,children:"✓ Yes"}),e.jsx("button",{onClick:()=>T({...y,[s.quality_standard_id]:!1}),className:`btn btn-sm ${y[s.quality_standard_id]===!1?"btn-danger":"btn-secondary"}`,children:"✗ No"})]})]},s.quality_standard_id):null})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>I(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-success",onClick:ge,children:[e.jsx(w,{size:16})," Mark Delivered"]})]})]})})]})}export{$e as default};
