import{j as e,s as U,v as C,u as ne,a as de,c as ce,L as oe}from"./index-Jc8UWcdf.js";import{r as l}from"./vendor-react-JFEV0ROX.js";import{C as me}from"./ConfirmDialog-BwKxWdna.js";import{ad as E,E as $,I as P,A as z,a as T,U as J,V as K,aw as ue,k as he,T as xe,a2 as Q,a1 as je,R as pe,a0 as ve,ax as ge,ay as Ne}from"./vendor-icons-yzeFIsqS.js";import"./vendor-supabase-DgEUAXvv.js";const W={Risk:{icon:z,className:"cat-risk"},Assumption:{icon:P,className:"cat-assumption"},Issue:{icon:$,className:"cat-issue"},Dependency:{icon:E,className:"cat-dependency"}};function B(i){switch(i){case"High":return"severity-high";case"Medium":return"severity-medium";case"Low":return"severity-low";default:return"severity-none"}}function V(i){switch(i){case"Open":return"status-open";case"In Progress":return"status-progress";case"Closed":return"status-closed";case"Accepted":return"status-accepted";case"Mitigated":return"status-mitigated";default:return"status-default"}}function fe({item:i,canEdit:x,canDelete:S,onClose:j,onUpdate:y,onDelete:w}){const[g,p]=l.useState(!1),[u,s]=l.useState({...i}),[N,f]=l.useState(!1),o=W[i.category]||W.Risk,v=o.icon;async function a(){f(!0);try{await y(u)}catch{alert("Failed to save changes")}finally{f(!1),p(!1)}}function d(t){s(n=>({...n,status:t,closed_date:["Closed","Accepted","Mitigated"].includes(t)?new Date().toISOString().split("T")[0]:null}))}function h(){s({...i}),p(!1)}return e.jsx("div",{className:"raid-modal-overlay",onClick:j,children:e.jsxs("div",{className:"raid-modal-container",onClick:t=>t.stopPropagation(),children:[e.jsxs("header",{className:`raid-modal-header ${o.className}`,children:[e.jsxs("div",{className:"raid-modal-header-left",children:[e.jsx("div",{className:"raid-modal-icon",children:e.jsx(v,{size:22})}),e.jsxs("div",{className:"raid-modal-title-group",children:[e.jsx("span",{className:"raid-modal-ref",children:i.raid_ref}),e.jsx("h2",{children:i.category})]})]}),e.jsxs("div",{className:"raid-modal-header-right",children:[e.jsx("span",{className:`raid-modal-status ${V(i.status)}`,children:i.status}),e.jsx("button",{className:"raid-modal-close",onClick:j,children:e.jsx(T,{size:20})})]})]}),e.jsx("div",{className:"raid-modal-body",children:g?e.jsxs("div",{className:"raid-edit-form",children:[e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Title"}),e.jsx("input",{type:"text",value:u.title||"",onChange:t=>s(n=>({...n,title:t.target.value})),placeholder:"Short title for this item"})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:u.description||"",onChange:t=>s(n=>({...n,description:t.target.value})),rows:4})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Impact"}),e.jsx("textarea",{value:u.impact||"",onChange:t=>s(n=>({...n,impact:t.target.value})),rows:2,placeholder:"What is the impact if this materialises?"})]}),e.jsxs("div",{className:"raid-form-row",children:[e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Probability"}),e.jsxs("select",{value:u.probability||"",onChange:t=>s(n=>({...n,probability:t.target.value})),children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Severity"}),e.jsxs("select",{value:u.severity||"",onChange:t=>s(n=>({...n,severity:t.target.value})),children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:u.status||"Open",onChange:t=>d(t.target.value),children:[e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Closed",children:"Closed"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Mitigated",children:"Mitigated"})]})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Mitigation / Action Plan"}),e.jsx("textarea",{value:u.mitigation||"",onChange:t=>s(n=>({...n,mitigation:t.target.value})),rows:3,placeholder:"Actions to mitigate or address this item"})]}),e.jsxs("div",{className:"raid-form-row",children:[e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",value:u.due_date||"",onChange:t=>s(n=>({...n,due_date:t.target.value}))})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{children:"Resolution"}),e.jsx("input",{type:"text",value:u.resolution||"",onChange:t=>s(n=>({...n,resolution:t.target.value})),placeholder:"How was this resolved?"})]})]})]}):e.jsxs("div",{className:"raid-view-content",children:[e.jsx("div",{className:"raid-detail-section",children:e.jsx("h3",{className:"raid-detail-title",children:i.title||e.jsx("span",{className:"raid-no-value",children:"No title"})})}),e.jsxs("div",{className:"raid-detail-section",children:[e.jsx("span",{className:"raid-detail-label",children:"Description"}),e.jsx("p",{className:"raid-detail-text",children:i.description})]}),i.impact&&e.jsxs("div",{className:"raid-detail-section",children:[e.jsx("span",{className:"raid-detail-label",children:"Impact"}),e.jsx("p",{className:"raid-detail-text",children:i.impact})]}),e.jsxs("div",{className:"raid-badges-grid",children:[e.jsxs("div",{className:"raid-badge-item",children:[e.jsx("span",{className:"raid-badge-label",children:"Probability"}),e.jsx("span",{className:`raid-badge ${B(i.probability)}`,children:i.probability||"Not set"})]}),e.jsxs("div",{className:"raid-badge-item",children:[e.jsx("span",{className:"raid-badge-label",children:"Severity"}),e.jsx("span",{className:`raid-badge ${B(i.severity)}`,children:i.severity||"Not set"})]}),e.jsxs("div",{className:"raid-badge-item",children:[e.jsx("span",{className:"raid-badge-label",children:"Status"}),e.jsx("span",{className:`raid-badge ${V(i.status)}`,children:i.status})]})]}),i.mitigation&&e.jsxs("div",{className:"raid-detail-section",children:[e.jsx("span",{className:"raid-detail-label",children:"Mitigation / Action Plan"}),e.jsx("p",{className:"raid-detail-text",children:i.mitigation})]}),i.resolution&&e.jsxs("div",{className:"raid-detail-section",children:[e.jsx("span",{className:"raid-detail-label",children:"Resolution"}),e.jsx("p",{className:"raid-detail-text",children:i.resolution})]}),e.jsxs("div",{className:"raid-metadata",children:[i.owner&&e.jsxs("div",{className:"raid-meta-item",children:[e.jsx(J,{size:15}),e.jsxs("span",{children:["Owner: ",i.owner.name]})]}),i.due_date&&e.jsxs("div",{className:"raid-meta-item",children:[e.jsx(K,{size:15}),e.jsxs("span",{children:["Due: ",new Date(i.due_date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})]}),i.milestone&&e.jsxs("div",{className:"raid-meta-item",children:[e.jsx(ue,{size:15}),e.jsxs("span",{children:["Milestone: ",i.milestone.milestone_ref]})]}),i.raised_date&&e.jsxs("div",{className:"raid-meta-item",children:[e.jsx(he,{size:15}),e.jsxs("span",{children:["Raised: ",new Date(i.raised_date).toLocaleDateString("en-GB")]})]}),i.source&&e.jsxs("div",{className:"raid-meta-item",children:[e.jsx(P,{size:15}),e.jsxs("span",{children:["Source: ",i.source]})]})]})]})}),e.jsxs("footer",{className:"raid-modal-footer",children:[e.jsx("div",{className:"raid-footer-left",children:S&&!g&&e.jsxs("button",{onClick:w,className:"raid-btn raid-btn-danger",children:[e.jsx(xe,{size:16})," Delete"]})}),e.jsx("div",{className:"raid-footer-right",children:g?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:h,className:"raid-btn raid-btn-secondary",children:"Cancel"}),e.jsxs("button",{onClick:a,disabled:N,className:"raid-btn raid-btn-primary",children:[e.jsx(Q,{size:16})," ",N?"Saving...":"Save Changes"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,className:"raid-btn raid-btn-secondary",children:"Close"}),x&&e.jsxs("button",{onClick:()=>p(!0),className:"raid-btn raid-btn-primary",children:[e.jsx(je,{size:16})," Edit"]})]})})]})]})})}const X=[{value:"Risk",icon:z,className:"cat-risk"},{value:"Assumption",icon:P,className:"cat-assumption"},{value:"Issue",icon:$,className:"cat-issue"},{value:"Dependency",icon:E,className:"cat-dependency"}];function ye({projectId:i,onClose:x,onSaved:S}){const[j,y]=l.useState(!1),[w,g]=l.useState([]),[p,u]=l.useState([]),[s,N]=l.useState({category:"Risk",raid_ref:"",title:"",description:"",impact:"",probability:"Medium",severity:"Medium",mitigation:"",status:"Open",owner_id:"",milestone_id:"",due_date:"",source:""});l.useEffect(()=>{async function a(){try{const[{data:d},{data:h}]=await Promise.all([U.from("resources").select("id, name, email").eq("project_id",i).is("deleted_at",null).order("name"),U.from("milestones").select("id, name, milestone_ref").eq("project_id",i).is("deleted_at",null).order("milestone_ref")]);g(d||[]),u(h||[])}catch{}}i&&a()},[i]),l.useEffect(()=>{async function a(){try{const d=await C.getNextRef(i,s.category);N(h=>({...h,raid_ref:d}))}catch{}}i&&s.category&&a()},[i,s.category]);async function f(a){if(a.preventDefault(),!s.description.trim()){alert("Please enter a description");return}y(!0);try{await C.create({project_id:i,raid_ref:s.raid_ref,category:s.category,title:s.title||null,description:s.description,impact:s.impact||null,probability:s.probability||null,severity:s.severity||null,mitigation:s.mitigation||null,status:s.status,owner_id:s.owner_id||null,milestone_id:s.milestone_id||null,due_date:s.due_date||null,source:s.source||null,raised_date:new Date().toISOString().split("T")[0]}),S()}catch{alert("Failed to create item. Please try again.")}finally{y(!1)}}function o(a,d){N(h=>({...h,[a]:d}))}const v=X.find(a=>a.value===s.category);return e.jsx("div",{className:"raid-add-overlay",onClick:x,children:e.jsxs("div",{className:"raid-add-modal",onClick:a=>a.stopPropagation(),children:[e.jsxs("header",{className:`raid-add-header ${v?.className||""}`,children:[e.jsxs("div",{className:"raid-add-header-content",children:[e.jsx("div",{className:"raid-add-icon",children:v&&e.jsx(v.icon,{size:22})}),e.jsxs("div",{children:[e.jsxs("h2",{children:["New ",s.category]}),e.jsx("span",{className:"raid-add-ref",children:s.raid_ref})]})]}),e.jsx("button",{className:"raid-add-close",onClick:x,children:e.jsx(T,{size:20})})]}),e.jsxs("form",{onSubmit:f,className:"raid-add-body",children:[e.jsxs("div",{className:"raid-form-section",children:[e.jsx("label",{className:"raid-form-label",children:"Category"}),e.jsx("div",{className:"raid-category-grid",children:X.map(a=>{const d=a.icon,h=s.category===a.value;return e.jsxs("button",{type:"button",onClick:()=>o("category",a.value),className:`raid-category-card ${a.className} ${h?"selected":""}`,children:[e.jsx(d,{size:20}),e.jsx("span",{children:a.value})]},a.value)})})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Title"}),e.jsx("input",{type:"text",value:s.title,onChange:a=>o("title",a.target.value),placeholder:"Short title for quick identification",className:"raid-form-input"})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsxs("label",{className:"raid-form-label",children:["Description ",e.jsx("span",{className:"required",children:"*"})]}),e.jsx("textarea",{value:s.description,onChange:a=>o("description",a.target.value),rows:3,placeholder:"Detailed description of the item",className:"raid-form-textarea",required:!0})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Impact"}),e.jsx("textarea",{value:s.impact,onChange:a=>o("impact",a.target.value),rows:2,placeholder:"What is the impact if this materialises?",className:"raid-form-textarea"})]}),e.jsxs("div",{className:"raid-form-row",children:[e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Probability"}),e.jsxs("select",{value:s.probability,onChange:a=>o("probability",a.target.value),className:"raid-form-select",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Severity"}),e.jsxs("select",{value:s.severity,onChange:a=>o("severity",a.target.value),className:"raid-form-select",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Mitigation / Action Plan"}),e.jsx("textarea",{value:s.mitigation,onChange:a=>o("mitigation",a.target.value),rows:2,placeholder:"Actions to mitigate or address this item",className:"raid-form-textarea"})]}),e.jsxs("div",{className:"raid-form-row",children:[e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Owner"}),e.jsxs("select",{value:s.owner_id,onChange:a=>o("owner_id",a.target.value),className:"raid-form-select",children:[e.jsx("option",{value:"",children:"Select owner..."}),w.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Due Date"}),e.jsx("input",{type:"date",value:s.due_date,onChange:a=>o("due_date",a.target.value),className:"raid-form-input"})]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Linked Milestone"}),e.jsxs("select",{value:s.milestone_id,onChange:a=>o("milestone_id",a.target.value),className:"raid-form-select",children:[e.jsx("option",{value:"",children:"No linked milestone"}),p.map(a=>e.jsxs("option",{value:a.id,children:[a.milestone_ref," - ",a.name]},a.id))]})]}),e.jsxs("div",{className:"raid-form-group",children:[e.jsx("label",{className:"raid-form-label",children:"Source"}),e.jsx("input",{type:"text",value:s.source,onChange:a=>o("source",a.target.value),placeholder:"e.g., Project Meeting, SoW v2.61",className:"raid-form-input"})]})]}),e.jsxs("footer",{className:"raid-add-footer",children:[e.jsx("button",{type:"button",onClick:x,className:"raid-btn raid-btn-secondary",children:"Cancel"}),e.jsxs("button",{onClick:f,disabled:j||!s.description.trim(),className:"raid-btn raid-btn-primary",children:[e.jsx(Q,{size:16}),j?"Creating...":"Create Item"]})]})]})})}const Y={Risk:{icon:z,className:"risk",plural:"Risks"},Assumption:{icon:P,className:"assumption",plural:"Assumptions"},Issue:{icon:$,className:"issue",plural:"Issues"},Dependency:{icon:E,className:"dependency",plural:"Dependencies"}};function _e(){const{user:i}=ne(),{projectId:x}=de(),S=i?.id||null,{can:j}=ce(),y=j("raid","create"),w=j("raid","edit"),g=j("raid","delete"),[p,u]=l.useState([]),[s,N]=l.useState(null),[f,o]=l.useState(!0),[v,a]=l.useState(!1),[d,h]=l.useState("all"),[t,n]=l.useState("all"),[D,H]=l.useState("all"),[_,G]=l.useState(""),[Z,O]=l.useState(!1),[R,k]=l.useState(null),[M,F]=l.useState({isOpen:!1,item:null}),[ee,ae]=l.useState({Risk:!0,Assumption:!0,Issue:!0,Dependency:!0});l.useEffect(()=>{x&&A()},[x]);async function A(){try{const[r,m]=await Promise.all([C.getAllWithRelations(x),C.getSummary(x)]);u(r||[]),N(m)}catch{}finally{o(!1),a(!1)}}async function se(){a(!0),await A()}const ie=d!=="all"||t!=="all"||D!=="all"||_,I=l.useMemo(()=>p.filter(r=>{if(d!=="all"&&r.category!==d||t!=="all"&&r.status!==t||D!=="all"&&r.severity!==D)return!1;if(_){const m=_.toLowerCase();return r.raid_ref?.toLowerCase().includes(m)||r.title?.toLowerCase().includes(m)||r.description?.toLowerCase().includes(m)}return!0}),[p,d,t,D,_]),re=l.useMemo(()=>({Risk:I.filter(r=>r.category==="Risk"),Assumption:I.filter(r=>r.category==="Assumption"),Issue:I.filter(r=>r.category==="Issue"),Dependency:I.filter(r=>r.category==="Dependency")}),[I]);async function te(){if(M.item)try{await C.delete(M.item.id,S),F({isOpen:!1,item:null}),await A()}catch{alert("Failed to delete item")}}function le(){h("all"),n("all"),H("all"),G("")}return f?e.jsx("div",{className:"raid-log",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(oe,{})})}):e.jsxs("div",{className:"raid-log",children:[e.jsx("header",{className:"raid-header",children:e.jsxs("div",{className:"raid-header-content",children:[e.jsxs("div",{className:"raid-header-left",children:[e.jsx("h1",{children:"RAID Log"}),e.jsx("p",{children:"Risks, Assumptions, Issues, and Dependencies"})]}),e.jsxs("div",{className:"raid-header-actions",children:[e.jsxs("button",{className:"raid-btn raid-btn-secondary",onClick:se,disabled:v,children:[e.jsx(pe,{size:16,className:v?"spinning":""}),"Refresh"]}),y&&e.jsxs("button",{className:"raid-btn raid-btn-primary",onClick:()=>O(!0),children:[e.jsx(ve,{size:16}),"Add Item"]})]})]})}),e.jsxs("div",{className:"raid-content",children:[s&&e.jsx("div",{className:"raid-summary-grid",children:Object.entries(Y).map(([r,m])=>{const L=m.icon,b=s.byCategory[r]||{total:0,open:0};return e.jsxs("div",{className:`raid-summary-card ${m.className}`,onClick:()=>h(r),children:[e.jsx("div",{className:"raid-summary-icon",children:e.jsx(L,{size:22})}),e.jsx("div",{className:"raid-summary-value",children:b.total}),e.jsx("div",{className:"raid-summary-label",children:m.plural}),e.jsxs("div",{className:"raid-summary-sub",children:[b.open," open"]})]},r)})}),s?.highPriorityItems?.length>0&&e.jsxs("div",{className:"raid-priority-alert",children:[e.jsxs("div",{className:"raid-priority-header",children:[e.jsx(z,{size:18}),e.jsxs("span",{children:[s.highPriorityItems.length," High Priority Items Requiring Attention"]})]}),e.jsx("div",{className:"raid-priority-items",children:s.highPriorityItems.map(r=>e.jsxs("div",{className:"raid-priority-item",onClick:()=>k(p.find(m=>m.id===r.id)),children:[e.jsx("span",{className:"raid-priority-ref",children:r.raid_ref}),e.jsx("span",{children:r.title})]},r.id))})]}),e.jsxs("div",{className:"raid-filter-bar",children:[e.jsxs("div",{className:"raid-search",children:[e.jsx(ge,{size:16}),e.jsx("input",{type:"text",placeholder:"Search RAID items...",value:_,onChange:r=>G(r.target.value)})]}),e.jsxs("select",{className:"raid-filter-select",value:d,onChange:r=>h(r.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Risk",children:"Risks"}),e.jsx("option",{value:"Assumption",children:"Assumptions"}),e.jsx("option",{value:"Issue",children:"Issues"}),e.jsx("option",{value:"Dependency",children:"Dependencies"})]}),e.jsxs("select",{className:"raid-filter-select",value:t,onChange:r=>n(r.target.value),children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Closed",children:"Closed"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Mitigated",children:"Mitigated"})]}),e.jsxs("select",{className:"raid-filter-select",value:D,onChange:r=>H(r.target.value),children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),ie&&e.jsxs("button",{className:"raid-clear-filters",onClick:le,children:[e.jsx(T,{size:14}),"Clear filters"]})]}),e.jsx("div",{className:"raid-categories",children:Object.entries(Y).map(([r,m])=>{const L=m.icon,b=re[r],q=ee[r];return e.jsxs("div",{className:`raid-category ${m.className} ${q?"expanded":""}`,children:[e.jsxs("button",{className:"raid-category-header",onClick:()=>ae(c=>({...c,[r]:!c[r]})),children:[e.jsxs("div",{className:"raid-category-left",children:[e.jsx("div",{className:"raid-category-icon",children:e.jsx(L,{size:18})}),e.jsxs("span",{className:"raid-category-title",children:[m.plural,e.jsxs("span",{className:"raid-category-count",children:["(",b.length,")"]})]})]}),e.jsx(Ne,{size:20,className:"raid-category-chevron"})]}),q&&e.jsx("div",{className:"raid-items-list",children:b.length===0?e.jsxs("div",{className:"raid-empty",children:[e.jsx(L,{size:32,className:"raid-empty-icon"}),e.jsxs("div",{className:"raid-empty-text",children:["No ",m.plural.toLowerCase()," found"]})]}):b.map(c=>e.jsx("div",{className:"raid-item",onClick:()=>k(c),children:e.jsxs("div",{className:"raid-item-main",children:[e.jsxs("div",{className:"raid-item-content",children:[e.jsxs("div",{className:"raid-item-header",children:[e.jsx("span",{className:"raid-item-ref",children:c.raid_ref}),e.jsx("span",{className:"raid-item-title",children:c.title||"Untitled"})]}),e.jsx("div",{className:"raid-item-description",children:c.description}),e.jsxs("div",{className:"raid-item-meta",children:[c.owner&&e.jsxs("span",{className:"raid-item-meta-item",children:[e.jsx(J,{size:14}),c.owner.name]}),c.due_date&&e.jsxs("span",{className:"raid-item-meta-item",children:[e.jsx(K,{size:14}),new Date(c.due_date).toLocaleDateString("en-GB",{day:"numeric",month:"short"})]})]})]}),e.jsxs("div",{className:"raid-item-badges",children:[c.severity&&e.jsxs("span",{className:`raid-badge severity-${c.severity.toLowerCase()}`,children:[e.jsx("span",{className:"raid-badge-dot"}),c.severity]}),e.jsx("span",{className:`raid-badge status-${c.status.toLowerCase().replace(" ","-")}`,children:c.status})]})]})},c.id))})]},r)})})]}),Z&&e.jsx(ye,{projectId:x,onClose:()=>O(!1),onSaved:()=>{O(!1),A()}}),R&&e.jsx(fe,{item:R,canEdit:w,canDelete:g,onClose:()=>k(null),onUpdate:async r=>{await C.update(R.id,r),await A(),k(null)},onDelete:()=>{F({isOpen:!0,item:R}),k(null)}}),e.jsx(me,{isOpen:M.isOpen,title:"Delete RAID Item",message:`Are you sure you want to delete ${M.item?.raid_ref}? This action cannot be undone.`,confirmText:"Delete",confirmVariant:"danger",onConfirm:te,onCancel:()=>F({isOpen:!1,item:null})})]})}export{_e as default};
