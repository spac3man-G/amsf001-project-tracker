import{s as h,j as e,L as B}from"./index-CiFWgt5u.js";import{d as R,r}from"./vendor-react-BUTV5ZEl.js";import{b as E,a5 as x,a6 as L,a4 as g,x as p}from"./vendor-icons-Hb5rh3SC.js";import"./vendor-supabase-6faYzd5A.js";function U(){const n=R(),[m,u]=r.useState(!1),[s,f]=r.useState(""),[a,w]=r.useState(""),[l,b]=r.useState(!1),[c,j]=r.useState(!1),[d,o]=r.useState(null),[y,v]=r.useState(!1),[N,P]=r.useState(!1),[S,k]=r.useState(!0);r.useEffect(()=>{C()},[]);async function C(){try{const{data:{session:t}}=await h.auth.getSession();t?P(!0):o("Invalid or expired reset link. Please request a new password reset.")}catch{o("Unable to verify reset link. Please try again.")}finally{k(!1)}}async function z(t){if(t.preventDefault(),o(null),!s){o("Please enter a new password");return}if(s.length<6){o("Password must be at least 6 characters");return}if(s!==a){o("Passwords do not match");return}u(!0);try{const{error:i}=await h.auth.updateUser({password:s});if(i)throw i;v(!0),setTimeout(()=>{n("/login")},3e3)}catch(i){o(i.message)}finally{u(!1)}}return S?e.jsx("div",{className:"auth-container",children:e.jsx("div",{className:"auth-box",children:e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx(B,{message:"Verifying reset link...",size:"medium"})})})}):y?e.jsx("div",{className:"auth-container",children:e.jsx("div",{className:"auth-box",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(E,{size:60,style:{color:"#16a34a",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem",color:"#166534"},children:"Password Reset Successful!"}),e.jsx("p",{style:{color:"#64748b",marginBottom:"1.5rem"},children:"Your password has been updated. Redirecting to login..."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>n("/login"),style:{width:"100%",justifyContent:"center"},children:"Go to Login"})]})})}):N?e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-box",children:[e.jsxs("div",{className:"auth-logo",children:[e.jsx(L,{size:40,style:{color:"var(--primary)",marginBottom:"0.5rem"}}),e.jsx("h1",{className:"auth-title",children:"Set New Password"}),e.jsx("p",{className:"auth-subtitle",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{id:"newPassword",className:"form-input",type:l?"text":"password",placeholder:"Enter new password",value:s,onChange:t=>f(t.target.value),required:!0,style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>b(!l),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:l?e.jsx(g,{size:18}):e.jsx(p,{size:18})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{id:"confirmPassword",className:"form-input",type:c?"text":"password",placeholder:"Confirm new password",value:a,onChange:t=>w(t.target.value),required:!0,style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>j(!c),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:c?e.jsx(g,{size:18}):e.jsx(p,{size:18})})]})]}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f1f5f9",borderRadius:"6px",marginBottom:"1rem",fontSize:"0.85rem"},children:[e.jsx("div",{style:{fontWeight:"500",marginBottom:"0.25rem",color:"#475569"},children:"Password requirements:"}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"1.25rem",color:"#64748b"},children:[e.jsxs("li",{style:{color:s.length>=6?"#16a34a":"#64748b"},children:["At least 6 characters ",s.length>=6&&"✓"]}),e.jsxs("li",{style:{color:s&&s===a?"#16a34a":"#64748b"},children:["Passwords match ",s&&s===a&&"✓"]})]})]}),d&&e.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[e.jsx(x,{size:20}),e.jsx("span",{style:{fontSize:"0.875rem"},children:d})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m||!s||!a,style:{width:"100%",justifyContent:"center"},children:m?"Updating...":"Reset Password"})]}),e.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:e.jsx("button",{onClick:()=>n("/login"),style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:"← Back to Login"})})]})}):e.jsx("div",{className:"auth-container",children:e.jsx("div",{className:"auth-box",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(x,{size:60,style:{color:"#dc2626",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem",color:"#991b1b"},children:"Invalid Reset Link"}),e.jsx("p",{style:{color:"#64748b",marginBottom:"1.5rem"},children:d||"This password reset link is invalid or has expired."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>n("/login"),style:{width:"100%",justifyContent:"center"},children:"Back to Login"})]})})})}export{U as default};
