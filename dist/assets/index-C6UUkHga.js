const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ResetPassword-DyZjW1KT.js","assets/vendor-react-CaXNtsgv.js","assets/vendor-icons--BgpcKrK.js","assets/vendor-supabase-qY1sfceY.js","assets/vendor-charts-_mIYJ_kN.js","assets/Milestones-HCnu7lkZ.js","assets/usePermissions-Bty26PMP.js","assets/ConfirmDialog-lhwBZBSC.js","assets/MilestoneDetail-D2w-Q2BE.js","assets/Gantt-Dl-gBpXo.js","assets/Deliverables-DvbNGen6.js","assets/Resources-CDmOVNmp.js","assets/ResourceDetail-BUnrAezW.js","assets/Partners-sBmHA7gT.js","assets/PartnerDetail-3j4oiCuu.js","assets/Timesheets-DnBgBFCX.js","assets/Expenses-t3b4yu2L.js","assets/Expenses-BoxYWZca.css","assets/KPIs-CpKEac_s.js","assets/KPIDetail-BSE7gtcV.js","assets/QualityStandards-xCQRewkx.js","assets/QualityStandardDetail-j3D0u4E3.js","assets/Reports-CD0O9MHS.js","assets/Users-CsI26eqj.js","assets/Settings-B3R6ihIm.js","assets/AccountSettings-LTpLHwAN.js","assets/WorkflowSummary-BefKYOPp.js","assets/AuditLog-zHLqzqva.js","assets/DeletedItems-BuI3UNPJ.js"])))=>i.map(i=>d[i]);
var Ks=Object.defineProperty;var Xs=(r,e,t)=>e in r?Ks(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Kt=(r,e,t)=>Xs(r,typeof e!="symbol"?e+"":e,t);import{r as f,a as Rt,R as En,u as Cr,b as Qs,L as Le,c as Js,d as Zs,g as eo,B as to,e as ro,f as Q,N as dr,O as no}from"./vendor-react-CaXNtsgv.js";import{c as so}from"./vendor-supabase-qY1sfceY.js";import{A as Cn,R as fr,L as Dn,I as oo,X as io,C as ao,a as Ze,M as lo,S as co,B as Xt,T as uo,U as fo,D as ho,b as po,c as Qt,d as mo,e as Mn,f as vt,F as On,g as kn,h as at,i as go,H as yo,j as In,k as bo,l as vo,m as xo,n as yt,P as hr,o as wo,G as _o,p as So,q as jo,r as Po,s as Ro,t as zn,u as Eo,K as Co,v as Jt,w as Zt,E as Do,x as Mo,y as Oo,z as en,J as ko,N as Io,O as zo}from"./vendor-icons--BgpcKrK.js";import{p as qe,c as Et}from"./vendor-charts-_mIYJ_kN.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var Nn={exports:{}},Ct={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var No=f,To=Symbol.for("react.element"),Ao=Symbol.for("react.fragment"),Lo=Object.prototype.hasOwnProperty,qo=No.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wo={key:!0,ref:!0,__self:!0,__source:!0};function Tn(r,e,t){var n,s={},o=null,a=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Lo.call(e,n)&&!Wo.hasOwnProperty(n)&&(s[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:To,type:r,key:o,ref:a,props:s,_owner:qo.current}}Ct.Fragment=Ao;Ct.jsx=Tn;Ct.jsxs=Tn;Nn.exports=Ct;var i=Nn.exports,pr={},tn=Rt;pr.createRoot=tn.createRoot,pr.hydrateRoot=tn.hydrateRoot;const Bo="modulepreload",Ho=function(r){return"/"+r},rn={},ne=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");s=Promise.allSettled(t.map(c=>{if(c=Ho(c),c in rn)return;rn[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Bo,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((y,P)=>{m.addEventListener("load",y),m.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})};var nn={},$o="@vercel/analytics",Uo="1.6.0",Fo=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function An(){return typeof window<"u"}function Ln(){try{const r="production"}catch{}return"production"}function Go(r="auto"){if(r==="auto"){window.vam=Ln();return}window.vam=r}function Vo(){return(An()?window.vam:Ln())||"production"}function mr(){return Vo()==="development"}function Yo(r){return r.scriptSrc?r.scriptSrc:mr()?"https://va.vercel-scripts.com/v1/script.debug.js":r.basePath?`${r.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function Ko(r={debug:!0}){var e;if(!An())return;Go(r.mode),Fo(),r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend));const t=Yo(r);if(document.head.querySelector(`script[src*="${t}"]`))return;const n=document.createElement("script");n.src=t,n.defer=!0,n.dataset.sdkn=$o+(r.framework?`/${r.framework}`:""),n.dataset.sdkv=Uo,r.disableAutoTrack&&(n.dataset.disableAutoTrack="1"),r.endpoint?n.dataset.endpoint=r.endpoint:r.basePath&&(n.dataset.endpoint=`${r.basePath}/insights`),r.dsn&&(n.dataset.dsn=r.dsn),n.onerror=()=>{const s=mr()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information."},mr()&&r.debug===!1&&(n.dataset.debug="false"),document.head.appendChild(n)}function Xo({route:r,path:e}){var t;(t=window.va)==null||t.call(window,"pageview",{route:r,path:e})}function Qo(){if(!(typeof process>"u"||typeof nn>"u"))return nn.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function Jo(r){return f.useEffect(()=>{var e;r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend))},[r.beforeSend]),f.useEffect(()=>{Ko({framework:r.framework||"react",basePath:r.basePath??Qo(),...r.route!==void 0&&{disableAutoTrack:!0},...r})},[]),f.useEffect(()=>{r.route&&r.path&&Xo({route:r.route,path:r.path})},[r.route,r.path]),null}var sn={},Zo="@vercel/speed-insights",ei="1.2.0",ti=()=>{window.si||(window.si=function(...e){(window.siq=window.siq||[]).push(e)})};function ri(){return typeof window<"u"}function ni(){try{const r="production"}catch{}return"production"}function qn(){return ni()==="development"}function si(r){return r.scriptSrc?r.scriptSrc:qn()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":r.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":r.basePath?`${r.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function oi(r={}){var e;if(!ri()||r.route===null)return null;ti();const t=si(r);if(document.head.querySelector(`script[src*="${t}"]`))return null;r.beforeSend&&((e=window.si)==null||e.call(window,"beforeSend",r.beforeSend));const n=document.createElement("script");return n.src=t,n.defer=!0,n.dataset.sdkn=Zo+(r.framework?`/${r.framework}`:""),n.dataset.sdkv=ei,r.sampleRate&&(n.dataset.sampleRate=r.sampleRate.toString()),r.route&&(n.dataset.route=r.route),r.endpoint?n.dataset.endpoint=r.endpoint:r.basePath&&(n.dataset.endpoint=`${r.basePath}/speed-insights/vitals`),r.dsn&&(n.dataset.dsn=r.dsn),qn()&&r.debug===!1&&(n.dataset.debug="false"),n.onerror=()=>{},document.head.appendChild(n),{setRoute:s=>{n.dataset.route=s??void 0}}}function ii(){if(!(typeof process>"u"||typeof sn>"u"))return sn.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function ai(r){f.useEffect(()=>{var t;r.beforeSend&&((t=window.si)==null||t.call(window,"beforeSend",r.beforeSend))},[r.beforeSend]);const e=f.useRef(null);return f.useEffect(()=>{if(e.current)r.route&&e.current(r.route);else{const t=oi({framework:r.framework??"react",basePath:r.basePath??ii(),...r});t&&(e.current=t.setRoute)}},[r.route]),null}const li=void 0,ci=void 0;throw new Error("Missing Supabase environment variables");const j=so(li,ci),Wn=f.createContext(null),ui=60*1e3,di=5*60*1e3;function fi({children:r}){const[e,t]=f.useState(null),[n,s]=f.useState(null),[o,a]=f.useState(null),[l,c]=f.useState(!0),[u,h]=f.useState(null),[m,y]=f.useState(!1),P=f.useRef(null),M=f.useRef(Date.now()),w=f.useCallback(()=>{M.current=Date.now()},[]);async function E(x){if(!x){s(null),a(null);return}try{const{data:R,error:z}=await j.from("profiles").select("*").eq("id",x.id).single();if(z){h(z);return}s(R);const{data:ee}=await j.from("resources").select("*").eq("user_id",x.id).maybeSingle();a(ee),h(null)}catch(R){h(R)}}const S=f.useCallback(async()=>{try{const{data:{session:x},error:R}=await j.auth.getSession();if(R)return;if(!x){await D();return}const z=x.expires_at*1e3,ee=Date.now(),A=z-ee;if(A<=0)await D();else if(A<=di){y(!0);const{data:K,error:oe}=await j.auth.refreshSession();oe||!K.session||y(!1)}else y(!1)}catch{}},[]);async function D(){t(null),s(null),a(null),y(!1),await j.auth.signOut();const x=window.location.pathname;x!=="/login"&&x!=="/register"&&(window.location.href="/login?expired=true")}const v=f.useCallback(()=>{P.current&&clearInterval(P.current),P.current=setInterval(()=>{S()},ui);const x=()=>{document.visibilityState==="visible"&&S()};document.addEventListener("visibilitychange",x);const R=["mousedown","keydown","touchstart","scroll"];return R.forEach(z=>{document.addEventListener(z,w,{passive:!0})}),()=>{P.current&&clearInterval(P.current),document.removeEventListener("visibilitychange",x),R.forEach(z=>{document.removeEventListener(z,w)})}},[S,w]);f.useEffect(()=>{let x=!0,R=null;async function z(){try{const{data:{session:A},error:K}=await j.auth.getSession();K&&x&&h(K),x&&(t(A?.user??null),c(!1),A?.user&&(E(A.user),R=v()))}catch(A){x&&(h(A),c(!1))}}z();const{data:{subscription:ee}}=j.auth.onAuthStateChange(async(A,K)=>{x&&(t(K?.user??null),c(!1),K?.user?(E(K.user),R&&R(),R=v()):(s(null),a(null),R&&(R(),R=null)),(A==="SIGNED_OUT"||A==="TOKEN_REFRESHED")&&y(!1))});return()=>{x=!1,ee.unsubscribe(),R&&R()}},[v]);async function g(){try{await j.auth.signOut(),t(null),s(null),a(null),y(!1)}catch(x){h(x)}}async function p(){e&&await E(e)}async function b(){try{const{data:x,error:R}=await j.auth.refreshSession();return R?!1:x.session?(y(!1),!0):!1}catch{return!1}}const _={user:e,profile:n,role:n?.role||"viewer",linkedResource:o,isLoading:l,error:u,signOut:g,refreshUserData:p,refreshSession:b,isAuthenticated:!!e,sessionExpiring:m};return i.jsx(Wn.Provider,{value:_,children:r})}function Dt(){const r=f.useContext(Wn);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r}const Bn=f.createContext(null);function hi({children:r}){const[e,t]=f.useState(null),[n,s]=f.useState(!0),[o,a]=f.useState(null);f.useEffect(()=>{let h=!0;async function m(){try{const{data:y,error:P}=await j.from("projects").select("*").eq("reference","AMSF001").single();P?h&&a(P):h&&(t(y),a(null))}catch(y){h&&a(y)}finally{h&&s(!1)}}return m(),()=>{h=!1}},[]);async function l(h){s(!0),a(null);try{const{data:m,error:y}=await j.from("projects").select("*").eq("reference",h).single();y?a(y):t(m)}catch(m){a(m)}finally{s(!1)}}async function c(){if(e)try{const{data:h,error:m}=await j.from("projects").select("*").eq("id",e.id).single();m?a(m):t(h)}catch(h){a(h)}}const u={currentProject:e,projectId:e?.id||null,projectRef:e?.reference||null,projectName:e?.name||null,isLoading:n,error:o,switchProject:l,refreshProject:c};return i.jsx(Bn.Provider,{value:u,children:r})}function Hn(){const r=f.useContext(Bn);if(!r)throw new Error("useProject must be used within a ProjectProvider");return r}const $n=f.createContext();function pi({children:r}){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[o,a]=f.useState([]);f.useEffect(()=>{l(),c()},[]);async function l(){const{data:{user:w}}=await j.auth.getUser();if(w){const{data:E}=await j.from("profiles").select("role").eq("id",w.id).single();E&&s(E.role)}}async function c(){const{data:w}=await j.from("profiles").select("id").eq("is_test_user",!0);w&&a(w.map(E=>E.id))}const u=n==="admin"||n==="supplier_pm";function h(){u&&t(w=>!w)}function m(w){return o.includes(w)}function y(w,E="user_id"){return!w||e?w:w.filter(S=>!o.includes(S[E]))}function P(w){return!w||e?w:w.filter(E=>!E.is_test_content)}const M={showTestUsers:e,setShowTestUsers:t,toggleTestUsers:h,canToggleTestUsers:u,testUserIds:o,isTestUser:m,filterTestContent:y,filterByTestFlag:P,userRole:n};return i.jsx($n.Provider,{value:M,children:r})}function mi(){const r=f.useContext($n);if(!r)throw new Error("useTestUsers must be used within a TestUserProvider");return r}const Un=f.createContext();function gi(){return f.useContext(Un)}function yi({children:r}){const[e,t]=f.useState([]),[n,s]=f.useState(0),[o,a]=f.useState(0),[l,c]=f.useState(!0),[u,h]=f.useState(null),[m,y]=f.useState(null),P=p=>["admin","supplier_pm","customer_pm"].includes(p),M=f.useCallback(async(p,b)=>{try{let _=[];if(P(b)){const{data:x}=await j.from("timesheets").select("id, hours_worked, hours, work_date, date").eq("status","Submitted"),{data:R}=await j.from("expenses").select("id, amount, category, reason, resource_name, chargeable_to_customer").eq("status","Submitted"),{data:z}=await j.from("deliverables").select("id, name, deliverable_ref").eq("status","Submitted"),{data:ee}=await j.from("milestone_certificates").select("id, milestone_id").eq("status","Submitted");x&&x.forEach(A=>{_.push({id:`ts-${A.id}`,type:"timesheet",notification_type:"action",title:"Timesheet Submitted",message:`Timesheet (${A.hours_worked||A.hours||0}h) pending approval`,action_url:"/timesheets",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),R&&R.forEach(A=>{const K=A.chargeable_to_customer!==!1;_.push({id:`exp-${A.id}`,type:"expense",notification_type:"action",title:"Expense Submitted",message:`${A.resource_name||"Unknown"} expense (£${parseFloat(A.amount||0).toFixed(2)}) pending validation`,action_url:"/expenses",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1,isChargeable:K})}),z&&z.forEach(A=>{_.push({id:`del-${A.id}`,type:"deliverable",notification_type:"action",title:"Deliverable Submitted",message:`${A.deliverable_ref}: ${A.name} pending review`,action_url:"/deliverables",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),ee&&ee.forEach(A=>{_.push({id:`cert-${A.id}`,type:"certificate",notification_type:"action",title:"Certificate Submitted",message:"Milestone certificate pending approval",action_url:"/milestones",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})})}else{const{data:x}=await j.from("timesheets").select("id, hours_worked, hours, work_date, date, resource_id").eq("status","Submitted").eq("user_id",p),{data:R}=await j.from("expenses").select("id, amount, category, reason, resource_name").eq("status","Submitted").eq("created_by",p);x&&x.forEach(z=>{_.push({id:`ts-${z.id}`,type:"timesheet",notification_type:"action",title:"Timesheet Submitted",message:`Your timesheet for ${z.hours_worked||z.hours||0}h is pending approval`,action_url:"/timesheets",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),R&&R.forEach(z=>{_.push({id:`exp-${z.id}`,type:"expense",notification_type:"action",title:"Expense Submitted",message:`Your expense (£${parseFloat(z.amount||0).toFixed(2)}) is pending validation`,action_url:"/expenses",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})})}return{count:_.length,items:_}}catch{return{count:0,items:[]}}},[]),w=f.useCallback(async()=>{try{const{data:{user:p}}=await j.auth.getUser();if(!p){t([]),s(0),a(0),c(!1);return}h(p.id);const{data:b}=await j.from("profiles").select("role").eq("id",p.id).single(),_=b?.role||"viewer";y(_);const{count:x,items:R}=await M(p.id,_);t(R),s(x),a(x)}catch{}finally{c(!1)}},[M]),E=f.useCallback(async p=>{t(b=>b.map(_=>_.id===p?{..._,is_read:!0}:_)),s(b=>Math.max(0,b-1))},[]),S=f.useCallback(async p=>{t(b=>b.map(_=>_.id===p?{..._,is_actioned:!0,is_read:!0}:_)),s(b=>Math.max(0,b-1)),a(b=>Math.max(0,b-1))},[]),D=f.useCallback(async()=>{t(p=>p.map(b=>({...b,is_read:!0}))),s(0)},[]),v=f.useCallback(async p=>{const b=e.find(_=>_.id===p);b&&(t(_=>_.filter(x=>x.id!==p)),b.is_read||s(_=>Math.max(0,_-1)),b.notification_type==="action"&&!b.is_actioned&&a(_=>Math.max(0,_-1)))},[e]);f.useEffect(()=>{w();const p=setInterval(()=>{w()},3e4);return()=>clearInterval(p)},[w]),f.useEffect(()=>{const{data:{subscription:p}}=j.auth.onAuthStateChange((b,_)=>{b==="SIGNED_IN"?w():b==="SIGNED_OUT"&&(t([]),s(0),a(0),h(null),y(null))});return()=>p.unsubscribe()},[w]);const g={notifications:e,unreadCount:n,actionCount:o,loading:l,fetchNotifications:w,markAsRead:E,markAsActioned:S,markAllAsRead:D,dismissNotification:v};return i.jsx(Un.Provider,{value:g,children:r})}const Fn=f.createContext(null);function bi({children:r}){const{user:e,profile:t,linkedResource:n,role:s}=Dt(),{projectId:o,projectName:a,projectRef:l,currentProject:c}=Hn(),[u,h]=f.useState(!1),[m,y]=f.useState([]),[P,M]=f.useState(!1),[w,E]=f.useState(null),S=f.useCallback(()=>c?{id:o,reference:l||c?.reference,name:a||c?.name,description:c?.description||null}:null,[c,o,l,a]),D=f.useCallback(()=>({name:t?.full_name||e?.email?.split("@")[0]||"User",email:e?.email,role:s||t?.role||"unknown",linkedResourceName:n?.name||null,linkedResourceId:n?.id||null,partnerId:n?.partner_id||null,partnerName:n?.partners?.name||null}),[e,t,n,s]),v=f.useCallback(async _=>{if(!_.trim()||P)return;const x={role:"user",content:_.trim()};y(R=>[...R,x]),M(!0),E(null);try{const R=S(),z=D(),ee=[...m.slice(-9),x].map(oe=>({role:oe.role,content:oe.content})),A=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:ee,projectContext:R,userContext:z,projectId:o})});if(!A.ok){const oe=await A.json().catch(()=>({}));throw new Error(oe.error||"Failed to get response")}const K=await A.json();y(oe=>[...oe,{role:"assistant",content:K.message,toolsUsed:K.toolsUsed||!1}])}catch(R){E(R.message||"Failed to send message. Please try again."),y(z=>z.slice(0,-1))}finally{M(!1)}},[m,P,S,D,o]),g=f.useCallback(()=>{y([]),E(null)},[]),p=f.useCallback(()=>{h(_=>!_)},[]),b={isOpen:u,setIsOpen:h,toggleChat:p,messages:m,isLoading:P,error:w,sendMessage:v,clearChat:g};return i.jsx(Fn.Provider,{value:b,children:r})}function vi(){const r=f.useContext(Fn);if(!r)throw new Error("useChat must be used within a ChatProvider");return r}class xi extends En.Component{constructor(t){super(t);Kt(this,"handleReload",()=>{window.location.reload()});Kt(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){this.setState({errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem",backgroundColor:"#fef2f2",borderRadius:"12px",margin:"1rem",border:"1px solid #fecaca"},children:[i.jsx(Cn,{size:48,style:{color:"#dc2626",marginBottom:"1rem"}}),i.jsx("h2",{style:{color:"#991b1b",margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600"},children:"Something went wrong"}),i.jsx("p",{style:{color:"#64748b",margin:"0 0 1.5rem 0",textAlign:"center",maxWidth:"400px"},children:this.state.error?.message||"An unexpected error occurred. Please try again."}),i.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[i.jsx("button",{onClick:this.handleReset,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:"Try Again"}),i.jsxs("button",{onClick:this.handleReload,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:[i.jsx(fr,{size:16}),"Reload Page"]})]})]}):this.props.children}}function Dr({message:r,size:e="medium",fullPage:t=!1}){const n={small:{icon:16,text:"0.75rem",padding:"0.5rem"},medium:{icon:24,text:"0.875rem",padding:"1.5rem"},large:{icon:40,text:"1rem",padding:"3rem"}},s=n[e]||n.medium,o={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:s.padding,...t&&{minHeight:"60vh"}},a={animation:"spin 1s linear infinite",color:"#3b82f6"},l={marginTop:"0.75rem",color:"#64748b",fontSize:s.text};return i.jsxs("div",{style:o,children:[i.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `}),i.jsx(Dn,{size:s.icon,style:a}),r&&i.jsx("p",{style:l,children:r})]})}const wi={background:"linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%)",backgroundSize:"200% 100%",animation:"shimmer 1.5s infinite"};function je({width:r="100%",height:e="1rem",style:t={},className:n=""}){return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      `}),i.jsx("div",{className:n,style:{width:r,height:e,borderRadius:"4px",...wi,...t}})]})}function gr({width:r="100%",lines:e=1}){return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Array.from({length:e}).map((t,n)=>i.jsx(je,{width:n===e-1&&e>1?"70%":r,height:"1rem"},n))})}function _i(){return i.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx(je,{width:"48px",height:"48px",style:{borderRadius:"12px"}}),i.jsxs("div",{style:{flex:1},children:[i.jsx(je,{width:"60%",height:"0.875rem",style:{marginBottom:"0.5rem"}}),i.jsx(je,{width:"40%",height:"1.5rem"})]})]})}function Si({columns:r=6}){return i.jsx("tr",{children:Array.from({length:r}).map((e,t)=>i.jsx("td",{style:{padding:"0.75rem 1rem"},children:i.jsx(je,{width:t===0?"80%":t===r-1?"60px":"70%",height:"1rem"})},t))})}function er({hasHeader:r=!0}){return i.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[r&&i.jsx(je,{width:"40%",height:"1.5rem",style:{marginBottom:"1rem"}}),i.jsx(gr,{lines:3})]})}function st({type:r="text",count:e=1,...t}){return(()=>{switch(r){case"text":return i.jsx(gr,{...t});case"stat-card":case"stats":return i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:Array.from({length:e}).map((s,o)=>i.jsx(_i,{},o))});case"table":return i.jsx("div",{className:"card",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsx("tr",{children:Array.from({length:t.columns||6}).map((s,o)=>i.jsx("th",{style:{padding:"0.75rem 1rem"},children:i.jsx(je,{width:"60%",height:"0.875rem"})},o))})}),i.jsx("tbody",{children:Array.from({length:t.rows||5}).map((s,o)=>i.jsx(Si,{columns:t.columns||6},o))})]})});case"card":return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:Array.from({length:e}).map((s,o)=>i.jsx(er,{...t},o))});case"page":return i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx(je,{width:"200px",height:"1.75rem",style:{marginBottom:"0.5rem"}}),i.jsx(je,{width:"300px",height:"1rem"})]}),i.jsx(je,{width:"120px",height:"40px",style:{borderRadius:"8px"}})]}),i.jsx(st,{type:"stats",count:4}),i.jsx(st,{type:"table",rows:8,columns:6})]});case"detail":return i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx(je,{width:"80px",height:"36px",style:{borderRadius:"8px"}}),i.jsx(je,{width:"250px",height:"1.75rem"})]}),i.jsx(st,{type:"stats",count:4}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[i.jsx(er,{}),i.jsx(er,{})]}),i.jsx(st,{type:"table",rows:5,columns:5})]});default:return i.jsx(gr,{...t})}})()}function ft({icon:r,label:e,value:t,subtext:n,color:s="#3b82f6",borderColor:o,backgroundColor:a,style:l={},onClick:c}){const u={...o&&{borderLeft:`4px solid ${o}`},...a&&{backgroundColor:a},...c&&{cursor:"pointer"},...l};return i.jsxs("div",{className:"stat-card",style:u,onClick:c,role:c?"button":void 0,tabIndex:c?0:void 0,children:[i.jsxs("div",{className:"stat-label",children:[r&&i.jsx(r,{size:20,style:{color:s}}),e]}),i.jsx("div",{className:"stat-value",style:{color:s},children:t}),n&&i.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b"},children:n})]})}function ji({icon:r,title:e,subtitle:t,children:n,style:s={}}){return i.jsxs("div",{className:"page-header",style:s,children:[i.jsxs("div",{className:"page-title",children:[r&&i.jsx(r,{size:28}),i.jsxs("div",{children:[i.jsx("h1",{children:e}),t&&i.jsx("p",{children:t})]})]}),n&&i.jsx("div",{className:"page-actions",children:n})]})}const on={success:{icon:ao,bgColor:"#dcfce7",borderColor:"#86efac",textColor:"#166534",iconColor:"#16a34a"},error:{icon:io,bgColor:"#fee2e2",borderColor:"#fecaca",textColor:"#991b1b",iconColor:"#dc2626"},warning:{icon:Cn,bgColor:"#fef3c7",borderColor:"#fde68a",textColor:"#92400e",iconColor:"#d97706"},info:{icon:oo,bgColor:"#dbeafe",borderColor:"#93c5fd",textColor:"#1e40af",iconColor:"#3b82f6"}};function Pi({id:r,message:e,type:t="info",duration:n=4e3,onClose:s}){const o=on[t]||on.info,a=o.icon;return f.useEffect(()=>{if(n>0){const l=setTimeout(()=>{s(r)},n);return()=>clearTimeout(l)}},[r,n,s]),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.875rem 1rem",backgroundColor:o.bgColor,border:`1px solid ${o.borderColor}`,borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",minWidth:"300px",maxWidth:"450px",animation:"slideIn 0.3s ease-out"},children:[i.jsx(a,{size:20,style:{color:o.iconColor,flexShrink:0}}),i.jsx("span",{style:{color:o.textColor,fontSize:"0.875rem",fontWeight:"500",flex:1},children:e}),i.jsx("button",{onClick:()=>s(r),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center",color:o.textColor,opacity:.7,borderRadius:"4px"},onMouseEnter:l=>l.target.style.opacity=1,onMouseLeave:l=>l.target.style.opacity=.7,children:i.jsx(Ze,{size:16})})]})}function Ri({toasts:r,removeToast:e}){return r.length===0?null:i.jsxs("div",{style:{position:"fixed",top:"1rem",right:"1rem",zIndex:9999,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `}),r.map(t=>i.jsx(Pi,{id:t.id,message:t.message,type:t.type,duration:t.duration,onClose:e},t.id))]})}const Gn=f.createContext(null),Ei=4e3;function Ci({children:r}){const[e,t]=f.useState([]),n=f.useCallback(h=>{t(m=>m.filter(y=>y.id!==h))},[]),s=f.useCallback((h,m="info",y=Ei)=>{const P=Date.now()+Math.random(),M={id:P,message:h,type:m,duration:y};return t(w=>[...w,M]),P},[]),o=f.useCallback((h,m)=>s(h,"success",m),[s]),a=f.useCallback((h,m)=>s(h,"error",m||6e3),[s]),l=f.useCallback((h,m)=>s(h,"warning",m),[s]),c=f.useCallback((h,m)=>s(h,"info",m),[s]),u={showToast:s,showSuccess:o,showError:a,showWarning:l,showInfo:c,removeToast:n};return i.jsxs(Gn.Provider,{value:u,children:[r,i.jsx(Ri,{toasts:e,removeToast:n})]})}function Di(){const r=f.useContext(Gn);if(!r)throw new Error("useToast must be used within a ToastProvider");return r}function Mi(){const{isOpen:r,toggleChat:e,messages:t,isLoading:n,error:s,sendMessage:o,clearChat:a}=vi(),[l,c]=f.useState(""),u=f.useRef(null),h=f.useRef(null);f.useEffect(()=>{u.current?.scrollIntoView({behavior:"smooth"})},[t]),f.useEffect(()=>{r&&setTimeout(()=>h.current?.focus(),100)},[r]);const m=w=>{w.preventDefault(),l.trim()&&!n&&(o(l),c(""))},y=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),m(w))},P={role:"assistant",content:`Hello! I'm your Project Assistant. I can query your project data and help you understand what's happening. Try asking:

• **"What do I need to do?"** - See your pending actions
• **"Show my timesheets this month"** - Query your time entries
• **"What milestones are at risk?"** - Check project progress
• **"What's the budget status?"** - View spend vs forecast
• **"What can my role do?"** - Understand your permissions

All data is scoped to your role, so just ask naturally!`},M=t.length===0?[P]:t;return i.jsxs(i.Fragment,{children:[i.jsx("button",{className:`chat-toggle-btn ${r?"chat-open":""}`,onClick:e,"aria-label":r?"Close chat":"Open AI assistant",children:r?i.jsx(Ze,{size:24}):i.jsxs(i.Fragment,{children:[i.jsx(lo,{size:24}),i.jsx(co,{className:"chat-sparkle",size:12})]})}),i.jsxs("div",{className:`chat-panel ${r?"chat-panel-open":""}`,children:[i.jsxs("div",{className:"chat-header",children:[i.jsxs("div",{className:"chat-header-title",children:[i.jsx(Xt,{size:20}),i.jsx("span",{children:"Project Assistant"})]}),i.jsxs("div",{className:"chat-header-actions",children:[t.length>0&&i.jsx("button",{className:"chat-clear-btn",onClick:a,title:"Clear chat",children:i.jsx(uo,{size:16})}),i.jsx("button",{className:"chat-close-btn",onClick:e,"aria-label":"Close chat",children:i.jsx(Ze,{size:20})})]})]}),i.jsxs("div",{className:"chat-messages",children:[M.map((w,E)=>i.jsxs("div",{className:`chat-message ${w.role==="user"?"chat-message-user":"chat-message-assistant"}`,children:[i.jsx("div",{className:"chat-message-avatar",children:w.role==="user"?i.jsx(fo,{size:16}):i.jsx(Xt,{size:16})}),i.jsxs("div",{className:"chat-message-content",children:[i.jsx(Oi,{content:w.content}),w.toolsUsed&&i.jsx("div",{className:"chat-tools-indicator",title:"Queried project data",children:i.jsx(ho,{size:12})})]})]},E)),n&&i.jsxs("div",{className:"chat-message chat-message-assistant",children:[i.jsx("div",{className:"chat-message-avatar",children:i.jsx(Xt,{size:16})}),i.jsxs("div",{className:"chat-message-content chat-typing",children:[i.jsx(Dn,{className:"chat-typing-icon",size:16}),i.jsx("span",{children:"Querying data..."})]})]}),s&&i.jsx("div",{className:"chat-error",children:s}),i.jsx("div",{ref:u})]}),i.jsxs("form",{className:"chat-input-form",onSubmit:m,children:[i.jsx("textarea",{ref:h,className:"chat-input",value:l,onChange:w=>c(w.target.value),onKeyDown:y,placeholder:"Ask me anything about the project...",rows:1,disabled:n}),i.jsx("button",{type:"submit",className:"chat-send-btn",disabled:!l.trim()||n,"aria-label":"Send message",children:i.jsx(po,{size:18})})]}),i.jsx("div",{className:"chat-footer",children:"Powered by Claude AI"})]})]})}function Oi({content:r}){const e=r.split(`
`);return i.jsx("div",{className:"chat-message-text",children:e.map((t,n)=>{if(t.startsWith("• ")||t.startsWith("- ")){const s=t.substring(2);return i.jsxs("div",{className:"chat-bullet",children:[i.jsx("span",{className:"chat-bullet-dot",children:"•"}),i.jsx("span",{dangerouslySetInnerHTML:{__html:an(s)}})]},n)}return t.trim()===""?i.jsx("div",{className:"chat-line-break"},n):i.jsx("p",{dangerouslySetInnerHTML:{__html:an(t)}},n)})})}function an(r){return r.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>")}function ki(){const[r,e]=f.useState(!1),t=f.useRef(null),n=Cr(),{notifications:s,unreadCount:o,actionCount:a,loading:l,markAsRead:c,markAsActioned:u,markAllAsRead:h,dismissNotification:m}=gi();f.useEffect(()=>{function g(p){t.current&&!t.current.contains(p.target)&&e(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const y=g=>{switch(g){case"timesheet":return i.jsx(at,{size:16});case"expense":return i.jsx(kn,{size:16});case"deliverable":return i.jsx(On,{size:16});case"certificate":return i.jsx(vt,{size:16});default:return i.jsx(Qt,{size:16})}},P=g=>g.notification_type==="action"?g.is_actioned?"#10b981":"#f59e0b":"#3b82f6",M=async g=>{g.is_read||await c(g.id),g.action_url&&(n(g.action_url),e(!1))},w=async(g,p)=>{g.stopPropagation(),await u(p.id),p.action_url&&(n(p.action_url),e(!1))},E=async(g,p)=>{g.stopPropagation(),await m(p.id)},S=g=>{const p=new Date(g),_=new Date-p,x=Math.floor(_/6e4),R=Math.floor(_/36e5),z=Math.floor(_/864e5);return x<1?"Just now":x<60?`${x}m ago`:R<24?`${R}h ago`:z<7?`${z}d ago`:p.toLocaleDateString("en-GB",{day:"numeric",month:"short"})},D=s.slice(0,10),v=s.filter(g=>g.notification_type==="action"&&!g.is_actioned);return i.jsxs("div",{className:"notification-bell-container",ref:t,style:{position:"relative"},children:[i.jsxs("button",{onClick:()=>e(!r),style:{position:"relative",background:"none",border:"none",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s",backgroundColor:r?"#f1f5f9":"transparent"},onMouseEnter:g=>g.target.style.backgroundColor="#f1f5f9",onMouseLeave:g=>g.target.style.backgroundColor=r?"#f1f5f9":"transparent",title:`${a} actions pending`,children:[i.jsx(Qt,{size:22,color:"#64748b"}),(o>0||a>0)&&i.jsx("span",{style:{position:"absolute",top:"2px",right:"2px",backgroundColor:a>0?"#ef4444":"#3b82f6",color:"white",fontSize:"11px",fontWeight:"600",minWidth:"18px",height:"18px",borderRadius:"9px",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},children:a>0?a:o})]}),r&&i.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"380px",maxHeight:"500px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.15)",border:"1px solid #e2e8f0",zIndex:1e3,overflow:"hidden"},children:[i.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600"},children:"Notifications"}),a>0&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:"13px",color:"#f59e0b"},children:[a," action",a!==1?"s":""," required"]})]}),o>0&&i.jsx("button",{onClick:h,style:{background:"none",border:"none",color:"#3b82f6",fontSize:"13px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px"},children:"Mark all read"})]}),v.length>0&&i.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#fffbeb",borderBottom:"1px solid #fef3c7"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[i.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b",animation:"pulse 2s infinite"}}),i.jsx("span",{style:{fontWeight:"600",fontSize:"13px",color:"#92400e"},children:"Actions Requiring Attention"})]}),i.jsxs("button",{onClick:()=>{n("/workflow-summary"),e(!1)},style:{width:"100%",padding:"8px 12px",backgroundColor:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:["View Workflow Summary",i.jsx(mo,{size:16})]})]}),i.jsx("div",{style:{maxHeight:"350px",overflowY:"auto"},children:l?i.jsx("div",{style:{padding:"32px",textAlign:"center",color:"#64748b"},children:"Loading..."}):D.length===0?i.jsxs("div",{style:{padding:"32px",textAlign:"center",color:"#64748b"},children:[i.jsx(Qt,{size:32,style:{marginBottom:"8px",opacity:.5}}),i.jsx("p",{style:{margin:0},children:"No notifications"})]}):D.map(g=>i.jsx("div",{onClick:()=>M(g),style:{padding:"12px 16px",borderBottom:"1px solid #f1f5f9",cursor:"pointer",backgroundColor:g.is_read?"white":"#f8fafc",transition:"background-color 0.15s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f1f5f9",onMouseLeave:p=>p.currentTarget.style.backgroundColor=g.is_read?"white":"#f8fafc",children:i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",backgroundColor:g.notification_type==="action"&&!g.is_actioned?"#fef3c7":"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",color:P(g),flexShrink:0},children:y(g.category)}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},children:[i.jsx("span",{style:{fontWeight:g.is_read?"400":"600",fontSize:"14px",color:"#1e293b"},children:g.title}),i.jsx("span",{style:{fontSize:"12px",color:"#94a3b8",flexShrink:0},children:S(g.created_at)})]}),i.jsx("p",{style:{margin:"4px 0 0",fontSize:"13px",color:"#64748b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g.message}),i.jsxs("div",{style:{marginTop:"8px",display:"flex",gap:"8px"},children:[g.notification_type==="action"&&!g.is_actioned&&g.action_label&&i.jsx("button",{onClick:p=>w(p,g),style:{padding:"4px 12px",fontSize:"12px",fontWeight:"500",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:g.action_label}),g.notification_type==="info"&&i.jsxs("button",{onClick:p=>E(p,g),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"transparent",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx(Ze,{size:12}),"Dismiss"]}),g.is_actioned&&i.jsxs("span",{style:{padding:"4px 8px",fontSize:"12px",color:"#10b981",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx(Mn,{size:12}),"Completed"]})]})]})]})},g.id))}),s.length>10&&i.jsx("div",{style:{padding:"12px 16px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:i.jsx("button",{onClick:()=>{n("/workflow-summary"),e(!1)},style:{background:"none",border:"none",color:"#3b82f6",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"View all notifications"})})]}),i.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})}const d={ADMIN:"admin",SUPPLIER_PM:"supplier_pm",CUSTOMER_PM:"customer_pm",CONTRIBUTOR:"contributor",VIEWER:"viewer"};function H(r,e){return e.includes(r)}function Uu(r){return H(r,[d.ADMIN,d.SUPPLIER_PM])}function Vn(r){return H(r,[d.CONTRIBUTOR,d.SUPPLIER_PM,d.ADMIN])}function Yn(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Ii(r){return H(r,[d.CUSTOMER_PM,d.ADMIN])}function Fu(r,e,t,n){if(H(r,[d.ADMIN,d.SUPPLIER_PM]))return!0;let s,o,a;return typeof e=="object"&&e!==null?(s=e.status,o=e.created_by||e.resource?.user_id,a=t):(s=e,o=t,a=n),o===a&&(s==="Draft"||s==="Rejected")}function Gu(r,e,t,n){if(r===d.ADMIN||r===d.SUPPLIER_PM)return!0;let s,o,a;return typeof e=="object"&&e!==null?(s=e.status,o=e.created_by||e.resource?.user_id,a=t):(s=e,o=t,a=n),o===a&&s==="Draft"}function Vu(r,e,t,n){let s,o,a;return typeof e=="object"&&e!==null?(s=e.status,o=e.created_by||e.resource?.user_id,a=t):(s=e,o=t,a=n),s!=="Draft"&&s!=="Rejected"?!1:H(r,[d.ADMIN,d.SUPPLIER_PM])?!0:o===a&&Vn(r)}function zi(r){return H(r,[d.CONTRIBUTOR,d.SUPPLIER_PM,d.ADMIN])}function Ni(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Yu(r,e,t){let n,s;return typeof e=="object"&&e!==null?(n=e.status,s=e.chargeable||e.chargeable_to_customer):(n=e,s=t),n!=="Submitted"?!1:r===d.ADMIN?!0:s?r===d.CUSTOMER_PM:r===d.SUPPLIER_PM}function Ti(r){return H(r,[d.CUSTOMER_PM,d.ADMIN])}function Ai(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Ku(r,e,t,n){if(H(r,[d.ADMIN,d.SUPPLIER_PM]))return!0;let s,o,a;return typeof e=="object"&&e!==null?(s=e.status,o=e.created_by,a=t):(s=e,o=t,a=n),o===a&&(s==="Draft"||s==="Rejected")}function Xu(r,e,t,n){if(r===d.ADMIN||r===d.SUPPLIER_PM)return!0;let s,o,a;return typeof e=="object"&&e!==null?(s=e.status,o=e.created_by,a=t):(s=e,o=t,a=n),o===a&&s==="Draft"}function Li(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function qi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Wi(r){return r===d.ADMIN}function Bi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Hi(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function $i(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function Qu(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Ju(r,e,t){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])?!0:r===d.CONTRIBUTOR?e?.assigned_to===t||e?.resource?.user_id===t:!1}function Ui(r){return H(r,[d.CUSTOMER_PM,d.ADMIN])}function Zu(r){return H(r,[d.CONTRIBUTOR,d.SUPPLIER_PM,d.ADMIN])}function Mt(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function ed(r){return Mt(r)}function td(r){return Mt(r)}function rd(r){return Mt(r)}function Ot(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function nd(r){return Ot(r)}function sd(r){return Ot(r)}function od(r){return Ot(r)}function Mr(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function id(r){return Mr(r)}function ad(r){return Mr(r)}function Fi(r){return r===d.ADMIN}function Gi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function ld(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Kn(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Vi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function kt(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function cd(r){return kt(r)}function ud(r){return kt(r)}function dd(r){return kt(r)}function Yi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Ki(r){return H(r,[d.CUSTOMER_PM,d.ADMIN])}function fd(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function Xi(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function hd(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Qi(r){return r===d.ADMIN}function pd(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function Ji(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function Zi(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function ea(r){return H(r,[d.SUPPLIER_PM,d.ADMIN])}function md(r){return Kn(r)}function gd(r){return H(r,[d.CUSTOMER_PM,d.SUPPLIER_PM,d.ADMIN])}function ta(r,e,t){return!e||!Array.isArray(e)?[]:Yn(r)?e:e.filter(n=>n.user_id===t)}function yd(r,e){return!r||!Array.isArray(r)?null:r.find(t=>t.user_id===e)||null}function ra(r,e,t){const n=ta(r,e,t);return n.length===0?null:n.find(o=>o.user_id===t)||n[0]}function bd(r,e,t){return ra(r,e,t)?.id||null}function na(r){const e={admin:{label:"Admin",color:"#7c3aed",bg:"#f3e8ff"},supplier_pm:{label:"Supplier PM",color:"#059669",bg:"#d1fae5"},customer_pm:{label:"Customer PM",color:"#d97706",bg:"#fef3c7"},contributor:{label:"Contributor",color:"#2563eb",bg:"#dbeafe"},viewer:{label:"Viewer",color:"#64748b",bg:"#f1f5f9"}};return e[r]||e.viewer}function sa(r){return na(r).label}const vd=[{value:"viewer",label:"Viewer",color:"#64748b",bg:"#f1f5f9"},{value:"contributor",label:"Contributor",color:"#2563eb",bg:"#dbeafe"},{value:"customer_pm",label:"Customer PM",color:"#d97706",bg:"#fef3c7"},{value:"supplier_pm",label:"Supplier PM",color:"#059669",bg:"#d1fae5"},{value:"admin",label:"Admin",color:"#7c3aed",bg:"#f3e8ff"}];function xd(r){return{role:r,roleLabel:sa(r),timesheets:{canAdd:Vn(r),canAddForOthers:Yn(r),canApprove:Ii(r)},expenses:{canAdd:zi(r),canAddForOthers:Ni(r),canValidateChargeable:Ti(r),canValidateNonChargeable:Ai(r)},milestones:{canCreate:Li(r),canEdit:qi(r),canDelete:Wi(r),canUseGantt:Bi(r)},deliverables:{canCreate:Hi(r),canEdit:$i(r),canReview:Ui(r)},kpis:{canManage:Mt(r)},qualityStandards:{canManage:Ot(r)},resources:{canManage:Mr(r),canDelete:Fi(r),canSeeCostPrice:Gi(r),canSeeMargins:Kn(r)},partners:{canView:Vi(r),canManage:kt(r)},certificates:{canSignAsSupplier:Yi(r),canSignAsCustomer:Ki(r)},admin:{canAccessSettings:Xi(r),canManageUsers:Qi(r),canViewWorkflowSummary:Ji(r)},invoicing:{canGenerateCustomerInvoice:Zi(r),canGenerateThirdPartyInvoice:ea(r)}}}const It={workflowSummary:{id:"workflowSummary",path:"/workflow-summary",icon:jo,label:"Workflow Summary",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.CONTRIBUTOR],readOnlyRoles:[]},dashboard:{id:"dashboard",path:"/dashboard",icon:So,label:"Dashboard",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.VIEWER],readOnlyRoles:[d.VIEWER]},reports:{id:"reports",path:"/reports",icon:On,label:"Reports",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM],readOnlyRoles:[]},gantt:{id:"gantt",path:"/gantt",icon:_o,label:"Gantt Chart",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.VIEWER],readOnlyRoles:[d.VIEWER,d.CUSTOMER_PM]},milestones:{id:"milestones",path:"/milestones",icon:wo,label:"Milestones",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.VIEWER],readOnlyRoles:[d.VIEWER]},deliverables:{id:"deliverables",path:"/deliverables",icon:hr,label:"Deliverables",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.CONTRIBUTOR,d.VIEWER],readOnlyRoles:[d.VIEWER]},kpis:{id:"kpis",path:"/kpis",icon:yt,label:"KPIs",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.VIEWER],readOnlyRoles:[d.VIEWER,d.CUSTOMER_PM]},qualityStandards:{id:"qualityStandards",path:"/quality-standards",icon:vt,label:"Quality Standards",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.VIEWER],readOnlyRoles:[d.VIEWER,d.CUSTOMER_PM]},resources:{id:"resources",path:"/resources",icon:xo,label:"Resources",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[]},timesheets:{id:"timesheets",path:"/timesheets",icon:at,label:"Timesheets",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.CONTRIBUTOR],readOnlyRoles:[]},expenses:{id:"expenses",path:"/expenses",icon:kn,label:"Expenses",allowedRoles:[d.ADMIN,d.SUPPLIER_PM,d.CUSTOMER_PM,d.CONTRIBUTOR],readOnlyRoles:[]},partners:{id:"partners",path:"/partners",icon:vo,label:"Partners",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[]},users:{id:"users",path:"/users",icon:bo,label:"Users",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[d.SUPPLIER_PM]},settings:{id:"settings",path:"/settings",icon:In,label:"Settings",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[]},auditLog:{id:"auditLog",path:"/audit-log",icon:yo,label:"Audit Log",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[]},deletedItems:{id:"deletedItems",path:"/deleted-items",icon:go,label:"Deleted Items",allowedRoles:[d.ADMIN,d.SUPPLIER_PM],readOnlyRoles:[]}},xt={[d.ADMIN]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","resources","timesheets","expenses","partners","users","settings","auditLog","deletedItems"],[d.SUPPLIER_PM]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","resources","timesheets","expenses","partners","users","settings","auditLog","deletedItems"],[d.CUSTOMER_PM]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","timesheets","expenses"],[d.CONTRIBUTOR]:["workflowSummary","timesheets","expenses","deliverables"],[d.VIEWER]:["dashboard","gantt","milestones","deliverables","kpis","qualityStandards"]};function oa(r){return(xt[r]||xt[d.VIEWER]).map(t=>It[t]?.path).filter(Boolean)}function Xn(r){return(xt[r]||xt[d.VIEWER]).map(t=>It[t]).filter(t=>t&&t.allowedRoles.includes(r))}function ln(r,e){const t=It[e];return t?t.readOnlyRoles?.includes(r)||!1:!0}function ia(r){return r!==d.VIEWER}function aa(r){return Object.values(It).find(e=>e.path===r)||null}function la(r){return aa(r)?.id||null}function ca(r,e){const t=Xn(r);if(!e||!Array.isArray(e)||e.length===0)return t;const n={};t.forEach(o=>{n[o.path]=o});const s=[];return e.forEach(o=>{n[o]&&(s.push(n[o]),delete n[o])}),Object.values(n).forEach(o=>{s.push(o)}),s}function ua(r,e){if(!e||e.length===0)return!0;const t=oa(r);return e.length!==t.length?!1:e.every((n,s)=>n===t[s])}const cn={[d.ADMIN]:{label:"Administrator",shortLabel:"Admin",color:"#7c3aed",bg:"#f3e8ff",description:"Full system access"},[d.SUPPLIER_PM]:{label:"Supplier PM",shortLabel:"Supplier PM",color:"#059669",bg:"#d1fae5",description:"Manage resources, partners, and invoices"},[d.CUSTOMER_PM]:{label:"Customer PM",shortLabel:"Customer PM",color:"#d97706",bg:"#fef3c7",description:"Approve timesheets and validate expenses"},[d.CONTRIBUTOR]:{label:"Contributor",shortLabel:"Contributor",color:"#2563eb",bg:"#dbeafe",description:"Submit timesheets and expenses"},[d.VIEWER]:{label:"Viewer",shortLabel:"Viewer",color:"#64748b",bg:"#f1f5f9",description:"Read-only access to reports"}};function da(r){return cn[r]||cn[d.VIEWER]}function fa({children:r}){const e=Qs(),t=Cr(),{showSuccess:n,showError:s}=Di(),{user:o,profile:a,role:l,signOut:c}=Dt(),[u,h]=f.useState(!0),[m,y]=f.useState(null),[P,M]=f.useState(null),[w,E]=f.useState(null),S=f.useRef(null),D=f.useMemo(()=>da(l),[l]),v=f.useMemo(()=>a&&(a.full_name||a.email||o?.email)||"User",[a,o]),g=f.useMemo(()=>{if(!a)return"U";if(a.full_name){const k=a.full_name.split(" ");return k.length>=2?k[0][0]+k[k.length-1][0]:a.full_name[0].toUpperCase()}return v[0].toUpperCase()},[a,v]);f.useEffect(()=>{a?.nav_order&&Array.isArray(a.nav_order)&&y(a.nav_order)},[a]);async function p(){await c(),t("/login")}const b=f.useMemo(()=>ia(l),[l]),_=f.useMemo(()=>m&&!ua(l,m),[l,m]),x=f.useMemo(()=>{const k=Xn(l);return m&&m.length>0?ca(l,m):k},[l,m]),R=f.useMemo(()=>{const k=la(e.pathname);return k?ln(l,k):!1},[l,e.pathname]);function z(k,G){b&&(S.current=k.target,M(G),setTimeout(()=>{S.current&&(S.current.style.opacity="0.5")},0))}function ee(k,G){b&&G!==P&&E(G)}function A(k){b&&k.preventDefault()}function K(){if(b){if(S.current&&(S.current.style.opacity="1"),P!==null&&w!==null&&P!==w){const k=[...x],G=k[P];k.splice(P,1),k.splice(w,0,G);const be=k.map(he=>he.path);y(be),oe(be)}M(null),E(null),S.current=null}}async function oe(k){if(o)try{const{error:G}=await j.from("profiles").update({nav_order:k}).eq("id",o.id);G&&s("Failed to save menu order")}catch{s("Failed to save menu order")}}async function Oe(){if(o)try{const{error:k}=await j.from("profiles").update({nav_order:null}).eq("id",o.id);if(k){s("Failed to reset menu order");return}y(null),n("Menu order reset to default")}catch{s("Failed to reset menu order")}}return i.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#f8fafc"},children:[i.jsxs("aside",{style:{width:u?"260px":"70px",backgroundColor:"white",borderRight:"1px solid #e2e8f0",transition:"width 0.3s ease",display:"flex",flexDirection:"column",position:"fixed",height:"100vh",zIndex:50},children:[i.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u&&i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,fontSize:"1.125rem",fontWeight:"700",color:"#0f172a"},children:"AMSF001"}),i.jsx("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Project Tracker"})]}),i.jsx("button",{onClick:()=>h(!u),style:{padding:"0.5rem",borderRadius:"6px",border:"none",backgroundColor:"#f1f5f9",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:u?i.jsx(Ze,{size:20}):i.jsx(Po,{size:20})})]}),i.jsx("nav",{style:{flex:1,padding:"0.5rem",overflowY:"auto"},children:x.map((k,G)=>{const be=k.icon,he=e.pathname===k.path||k.path!=="/dashboard"&&e.pathname.startsWith(k.path),ke=P===G,Ie=w===G,Ne=ln(l,k.id);return i.jsx("div",{draggable:b,onDragStart:I=>z(I,G),onDragEnter:I=>ee(I,G),onDragOver:A,onDragEnd:K,style:{position:"relative",marginBottom:"0.25rem",borderTop:Ie&&P>G?"2px solid #10b981":"2px solid transparent",borderBottom:Ie&&P<G?"2px solid #10b981":"2px solid transparent",transition:"border-color 0.15s ease"},children:i.jsxs(Le,{to:k.path,style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:u?"0.75rem 1rem":"0.75rem",borderRadius:"8px",textDecoration:"none",color:he?"#10b981":"#64748b",backgroundColor:he?"#f0fdf4":ke?"#f1f5f9":"transparent",fontWeight:he?"600":"500",justifyContent:u?"flex-start":"center",transition:"all 0.15s ease",cursor:b?"grab":"pointer"},children:[u&&b&&i.jsx(Ro,{size:14,style:{color:"#cbd5e1",marginRight:"-0.25rem",flexShrink:0}}),i.jsx(be,{size:20}),u&&i.jsx("span",{style:{flex:1},children:k.label}),u&&Ne&&i.jsx("span",{style:{fontSize:"0.6rem",padding:"0.125rem 0.375rem",backgroundColor:"#f1f5f9",color:"#64748b",borderRadius:"4px",fontWeight:"500"},children:"VIEW"})]})},k.path)})}),u&&b&&_&&i.jsx("div",{style:{padding:"0.5rem 1rem",borderTop:"1px solid #e2e8f0"},children:i.jsxs("button",{onClick:Oe,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.5rem",backgroundColor:"#f8fafc",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"6px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"500",transition:"all 0.15s ease"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="#f1f5f9",k.currentTarget.style.color="#475569"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor="#f8fafc",k.currentTarget.style.color="#64748b"},children:[i.jsx(zn,{size:14}),"Reset Menu Order"]})}),i.jsx("div",{style:{padding:"1rem",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:i.jsxs("button",{onClick:p,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:u?"flex-start":"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"#fef2f2",color:"#ef4444",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"500"},children:[i.jsx(Eo,{size:20}),u&&i.jsx("span",{children:"Logout"})]})})]}),i.jsxs("main",{style:{flex:1,marginLeft:u?"260px":"70px",transition:"margin-left 0.3s ease",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[i.jsxs("header",{style:{padding:"0.75rem 1.5rem",backgroundColor:"white",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"1rem",position:"sticky",top:0,zIndex:40},children:[i.jsxs(Le,{to:"/account",style:{display:"flex",alignItems:"center",gap:"0.75rem",paddingRight:"1rem",borderRight:"1px solid #e2e8f0",textDecoration:"none",cursor:"pointer",borderRadius:"8px",padding:"0.5rem 1rem 0.5rem 0.75rem",marginRight:"0",transition:"background-color 0.15s ease"},onMouseEnter:k=>k.currentTarget.style.backgroundColor="#f8fafc",onMouseLeave:k=>k.currentTarget.style.backgroundColor="transparent",children:[i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontWeight:"600",fontSize:"0.875rem",color:"#1e293b"},children:v}),i.jsx("span",{style:{display:"inline-block",padding:"0.125rem 0.5rem",backgroundColor:D.bg,color:D.color,borderRadius:"4px",fontSize:"0.65rem",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.025em"},children:D.shortLabel})]}),i.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:D.color,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"0.8rem"},children:g})]}),i.jsx(ki,{})]}),R&&i.jsxs("div",{style:{padding:"0.5rem 1.5rem",backgroundColor:"#f1f5f9",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"#64748b"},children:[i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),i.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),i.jsx("span",{children:"You have read-only access to this page"})]}),i.jsx("div",{style:{flex:1},children:r})]})]})}function ha(){const r=Cr(),[e]=Js(),[t,n]=f.useState(!1),[s,o]=f.useState(""),[a,l]=f.useState(""),[c,u]=f.useState(null),[h,m]=f.useState(null),[y,P]=f.useState(!1),[M,w]=f.useState(!1),[E,S]=f.useState(!1),[D,v]=f.useState(!1);f.useEffect(()=>{e.get("expired")==="true"&&(v(!0),window.history.replaceState({},document.title,"/login")),j.auth.getSession().then(({data:{session:R}})=>{R&&r("/dashboard",{replace:!0})});const{data:{subscription:x}}=j.auth.onAuthStateChange((R,z)=>{R==="SIGNED_IN"&&z&&r("/dashboard",{replace:!0})});return()=>x.unsubscribe()},[r,e]);const g=async x=>{x.preventDefault(),n(!0),u(null),m(null),v(!1);try{if(y){const{error:R}=await j.auth.signUp({email:s,password:a,options:{data:{full_name:s.split("@")[0]}}});if(R)throw R;m("Check your email for confirmation link!")}else{const{error:R}=await j.auth.signInWithPassword({email:s,password:a});if(R)throw R}}catch(R){u(R.message)}finally{n(!1)}},p=async x=>{if(x.preventDefault(),!s){u("Please enter your email address");return}n(!0),u(null),m(null);try{const{error:R}=await j.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password`});if(R)throw R;m("Password reset email sent! Check your inbox.")}catch(R){u(R.message)}finally{n(!1)}},b=async x=>{if(x.preventDefault(),!s){u("Please enter your email address");return}n(!0),u(null),m(null);try{const{error:R}=await j.auth.resend({type:"signup",email:s});if(R)throw R;m("Verification email resent! Check your inbox.")}catch(R){u(R.message)}finally{n(!1)}},_=()=>{w(!1),S(!1),u(null),m(null),v(!1)};return M?i.jsx("div",{className:"auth-container",children:i.jsxs("div",{className:"auth-box",children:[i.jsxs("div",{className:"auth-logo",children:[i.jsx(Co,{size:40,style:{color:"var(--primary)",marginBottom:"0.5rem"}}),i.jsx("h1",{className:"auth-title",children:"Reset Password"}),i.jsx("p",{className:"auth-subtitle",children:"Enter your email to receive a reset link"})]}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:x=>o(x.target.value),required:!0})]}),c&&i.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[i.jsx(Jt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&i.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[i.jsx(Zt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Sending...":"Send Reset Link"})]}),i.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:i.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:"← Back to Sign In"})})]})}):E?i.jsx("div",{className:"auth-container",children:i.jsxs("div",{className:"auth-box",children:[i.jsxs("div",{className:"auth-logo",children:[i.jsx(fr,{size:40,style:{color:"var(--primary)",marginBottom:"0.5rem"}}),i.jsx("h1",{className:"auth-title",children:"Resend Verification"}),i.jsx("p",{className:"auth-subtitle",children:"Enter your email to resend the verification link"})]}),i.jsxs("form",{onSubmit:b,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:x=>o(x.target.value),required:!0})]}),c&&i.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[i.jsx(Jt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&i.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[i.jsx(Zt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Sending...":"Resend Verification Email"})]}),i.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:i.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:"← Back to Sign In"})})]})}):i.jsx("div",{className:"auth-container",children:i.jsxs("div",{className:"auth-box",children:[i.jsxs("div",{className:"auth-logo",children:[i.jsx("h1",{className:"auth-title",children:"AMSF001 Tracker"}),i.jsx("p",{className:"auth-subtitle",children:"Network Architecture Services Project"})]}),D&&i.jsxs("div",{style:{padding:"0.75rem",background:"#fef3c7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#92400e",border:"1px solid #fcd34d"},children:[i.jsx(at,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:"Your session has expired. Please sign in again."})]}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:x=>o(x.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",className:"form-input",type:"password",placeholder:"••••••••",value:a,onChange:x=>l(x.target.value),required:!0})]}),c&&i.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[i.jsx(Jt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&i.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[i.jsx(Zt,{size:20}),i.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Loading...":y?"Sign Up":"Sign In"})]}),!y&&i.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:i.jsx("button",{onClick:()=>{w(!0),u(null),m(null),v(!1)},style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",fontSize:"0.85rem",textDecoration:"underline"},children:"Forgot your password?"})}),i.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:i.jsx("button",{onClick:()=>{P(!y),u(null),m(null),v(!1)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:y?"Already have an account? Sign In":"Don't have an account? Sign Up"})}),i.jsxs("div",{style:{marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[i.jsx("p",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.5rem"},children:"Haven't received your verification email?"}),i.jsxs("button",{onClick:()=>{S(!0),u(null),m(null),v(!1)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.85rem",display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx(fr,{size:14})," Resend Verification Email"]})]})]})})}var Qn={exports:{}},lt={},yr={exports:{}};(function(r,e){(function(t,n){n(e)})(Zs,function(t){function n(C){return function(T,W,U,J,ie,ue,Z){return C(T,W,Z)}}function s(C){return function(T,W,U,J){if(!T||!W||typeof T!="object"||typeof W!="object")return C(T,W,U,J);var ie=J.get(T),ue=J.get(W);if(ie&&ue)return ie===W&&ue===T;J.set(T,W),J.set(W,T);var Z=C(T,W,U,J);return J.delete(T),J.delete(W),Z}}function o(C,O){var T={};for(var W in C)T[W]=C[W];for(var W in O)T[W]=O[W];return T}function a(C){return C.constructor===Object||C.constructor==null}function l(C){return typeof C.then=="function"}function c(C,O){return C===O||C!==C&&O!==O}var u="[object Arguments]",h="[object Boolean]",m="[object Date]",y="[object RegExp]",P="[object Map]",M="[object Number]",w="[object Object]",E="[object Set]",S="[object String]",D=Object.prototype.toString;function v(C){var O=C.areArraysEqual,T=C.areDatesEqual,W=C.areMapsEqual,U=C.areObjectsEqual,J=C.areRegExpsEqual,ie=C.areSetsEqual,ue=C.createIsNestedEqual,Z=ue(ve);function ve(Y,X,ge){if(Y===X)return!0;if(!Y||!X||typeof Y!="object"||typeof X!="object")return Y!==Y&&X!==X;if(a(Y)&&a(X))return U(Y,X,Z,ge);var tt=Array.isArray(Y),dt=Array.isArray(X);if(tt||dt)return tt===dt&&O(Y,X,Z,ge);var Se=D.call(Y);return Se!==D.call(X)?!1:Se===m?T(Y,X,Z,ge):Se===y?J(Y,X,Z,ge):Se===P?W(Y,X,Z,ge):Se===E?ie(Y,X,Z,ge):Se===w||Se===u?l(Y)||l(X)?!1:U(Y,X,Z,ge):Se===h||Se===M||Se===S?c(Y.valueOf(),X.valueOf()):!1}return ve}function g(C,O,T,W){var U=C.length;if(O.length!==U)return!1;for(;U-- >0;)if(!T(C[U],O[U],U,U,C,O,W))return!1;return!0}var p=s(g);function b(C,O){return c(C.valueOf(),O.valueOf())}function _(C,O,T,W){var U=C.size===O.size;if(!U)return!1;if(!C.size)return!0;var J={},ie=0;return C.forEach(function(ue,Z){if(U){var ve=!1,Y=0;O.forEach(function(X,ge){!ve&&!J[Y]&&(ve=T(Z,ge,ie,Y,C,O,W)&&T(ue,X,Z,ge,C,O,W))&&(J[Y]=!0),Y++}),ie++,U=ve}}),U}var x=s(_),R="_owner",z=Object.prototype.hasOwnProperty;function ee(C,O,T,W){var U=Object.keys(C),J=U.length;if(Object.keys(O).length!==J)return!1;for(var ie;J-- >0;){if(ie=U[J],ie===R){var ue=!!C.$$typeof,Z=!!O.$$typeof;if((ue||Z)&&ue!==Z)return!1}if(!z.call(O,ie)||!T(C[ie],O[ie],ie,ie,C,O,W))return!1}return!0}var A=s(ee);function K(C,O){return C.source===O.source&&C.flags===O.flags}function oe(C,O,T,W){var U=C.size===O.size;if(!U)return!1;if(!C.size)return!0;var J={};return C.forEach(function(ie,ue){if(U){var Z=!1,ve=0;O.forEach(function(Y,X){!Z&&!J[ve]&&(Z=T(ie,Y,ue,X,C,O,W))&&(J[ve]=!0),ve++}),U=Z}}),U}var Oe=s(oe),k=Object.freeze({areArraysEqual:g,areDatesEqual:b,areMapsEqual:_,areObjectsEqual:ee,areRegExpsEqual:K,areSetsEqual:oe,createIsNestedEqual:n}),G=Object.freeze({areArraysEqual:p,areDatesEqual:b,areMapsEqual:x,areObjectsEqual:A,areRegExpsEqual:K,areSetsEqual:Oe,createIsNestedEqual:n}),be=v(k);function he(C,O){return be(C,O,void 0)}var ke=v(o(k,{createIsNestedEqual:function(){return c}}));function Ie(C,O){return ke(C,O,void 0)}var Ne=v(G);function I(C,O){return Ne(C,O,new WeakMap)}var ae=v(o(G,{createIsNestedEqual:function(){return c}}));function le(C,O){return ae(C,O,new WeakMap)}function V(C){return v(o(k,C(k)))}function te(C){var O=v(o(G,C(G)));return function(T,W,U){return U===void 0&&(U=new WeakMap),O(T,W,U)}}t.circularDeepEqual=I,t.circularShallowEqual=le,t.createCustomCircularEqual=te,t.createCustomEqual=V,t.deepEqual=he,t.sameValueZeroEqual=c,t.shallowEqual=Ie,Object.defineProperty(t,"__esModule",{value:!0})})})(yr,yr.exports);var Or=yr.exports,$={},pa=function(e,t,n){return e===t?!0:e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)};Object.defineProperty($,"__esModule",{value:!0});$.bottom=kr;$.childrenEqual=ya;$.cloneLayout=Jn;$.cloneLayoutItem=Ue;$.collides=zt;$.compact=es;$.compactItem=ts;$.compactType=Oa;$.correctBounds=rs;$.fastPositionEqual=ba;$.fastRGLPropsEqual=void 0;$.getAllCollisions=ns;$.getFirstCollision=He;$.getLayoutItem=Ir;$.getStatics=zr;$.modifyLayout=Zn;$.moveElement=it;$.moveElementAwayFromCollision=vr;$.noop=void 0;$.perc=xa;$.resizeItemInDirection=Ra;$.setTopLeft=Ca;$.setTransform=Ea;$.sortLayoutItems=Wr;$.sortLayoutItemsByColRow=ls;$.sortLayoutItemsByRowCol=as;$.synchronizeLayoutWithChildren=Da;$.validateLayout=Ma;$.withLayoutItem=ga;var un=Or,ot=ma(f);function ma(r){return r&&r.__esModule?r:{default:r}}function kr(r){let e=0,t;for(let n=0,s=r.length;n<s;n++)t=r[n].y+r[n].h,t>e&&(e=t);return e}function Jn(r){const e=Array(r.length);for(let t=0,n=r.length;t<n;t++)e[t]=Ue(r[t]);return e}function Zn(r,e){const t=Array(r.length);for(let n=0,s=r.length;n<s;n++)e.i===r[n].i?t[n]=e:t[n]=r[n];return t}function ga(r,e,t){let n=Ir(r,e);return n?(n=t(Ue(n)),r=Zn(r,n),[r,n]):[r,null]}function Ue(r){return{w:r.w,h:r.h,x:r.x,y:r.y,i:r.i,minW:r.minW,maxW:r.maxW,minH:r.minH,maxH:r.maxH,moved:!!r.moved,static:!!r.static,isDraggable:r.isDraggable,isResizable:r.isResizable,resizeHandles:r.resizeHandles,isBounded:r.isBounded}}function ya(r,e){return(0,un.deepEqual)(ot.default.Children.map(r,t=>t?.key),ot.default.Children.map(e,t=>t?.key))&&(0,un.deepEqual)(ot.default.Children.map(r,t=>t?.props["data-grid"]),ot.default.Children.map(e,t=>t?.props["data-grid"]))}$.fastRGLPropsEqual=pa;function ba(r,e){return r.left===e.left&&r.top===e.top&&r.width===e.width&&r.height===e.height}function zt(r,e){return!(r.i===e.i||r.x+r.w<=e.x||r.x>=e.x+e.w||r.y+r.h<=e.y||r.y>=e.y+e.h)}function es(r,e,t,n){const s=zr(r),o=Wr(r,e),a=Array(r.length);for(let l=0,c=o.length;l<c;l++){let u=Ue(o[l]);u.static||(u=ts(s,u,e,t,o,n),s.push(u)),a[r.indexOf(o[l])]=u,u.moved=!1}return a}const va={x:"w",y:"h"};function br(r,e,t,n){const s=va[n];e[n]+=1;const o=r.map(a=>a.i).indexOf(e.i);for(let a=o+1;a<r.length;a++){const l=r[a];if(!l.static){if(l.y>e.y+e.h)break;zt(e,l)&&br(r,l,t+e[s],n)}}e[n]=t}function ts(r,e,t,n,s,o){const a=t==="vertical",l=t==="horizontal";if(a)for(e.y=Math.min(kr(r),e.y);e.y>0&&!He(r,e);)e.y--;else if(l)for(;e.x>0&&!He(r,e);)e.x--;let c;for(;(c=He(r,e))&&!(t===null&&o);)if(l?br(s,e,c.x+c.w,"x"):br(s,e,c.y+c.h,"y"),l&&e.x+e.w>n)for(e.x=n-e.w,e.y++;e.x>0&&!He(r,e);)e.x--;return e.y=Math.max(e.y,0),e.x=Math.max(e.x,0),e}function rs(r,e){const t=zr(r);for(let n=0,s=r.length;n<s;n++){const o=r[n];if(o.x+o.w>e.cols&&(o.x=e.cols-o.w),o.x<0&&(o.x=0,o.w=e.cols),!o.static)t.push(o);else for(;He(t,o);)o.y++}return r}function Ir(r,e){for(let t=0,n=r.length;t<n;t++)if(r[t].i===e)return r[t]}function He(r,e){for(let t=0,n=r.length;t<n;t++)if(zt(r[t],e))return r[t]}function ns(r,e){return r.filter(t=>zt(t,e))}function zr(r){return r.filter(e=>e.static)}function it(r,e,t,n,s,o,a,l,c){if(e.static&&e.isDraggable!==!0||e.y===n&&e.x===t)return r;`${e.i}${String(t)}${String(n)}${e.x}${e.y}`;const u=e.x,h=e.y;typeof t=="number"&&(e.x=t),typeof n=="number"&&(e.y=n),e.moved=!0;let m=Wr(r,a);(a==="vertical"&&typeof n=="number"?h>=n:a==="horizontal"&&typeof t=="number"?u>=t:!1)&&(m=m.reverse());const P=ns(m,e),M=P.length>0;if(M&&c)return Jn(r);if(M&&o)return`${e.i}`,e.x=u,e.y=h,e.moved=!1,r;for(let w=0,E=P.length;w<E;w++){const S=P[w];`${e.i}${e.x}${e.y}${S.i}${S.x}${S.y}`,!S.moved&&(S.static?r=vr(r,S,e,s,a):r=vr(r,e,S,s,a))}return r}function vr(r,e,t,n,s,o){const a=s==="horizontal",l=s==="vertical",c=e.static;if(n){n=!1;const m={x:a?Math.max(e.x-t.w,0):t.x,y:l?Math.max(e.y-t.h,0):t.y,w:t.w,h:t.h,i:"-1"},y=He(r,m),P=y&&y.y+y.h>e.y,M=y&&e.x+e.w>y.x;if(y){if(P&&l)return it(r,t,void 0,e.y+1,n,c,s);if(P&&s==null)return e.y=t.y,t.y=t.y+t.h,r;if(M&&a)return it(r,e,t.x,void 0,n,c,s)}else return`${t.i}${m.x}${m.y}`,it(r,t,a?m.x:void 0,l?m.y:void 0,n,c,s)}const u=a?t.x+1:void 0,h=l?t.y+1:void 0;return u==null&&h==null?r:it(r,t,a?t.x+1:void 0,l?t.y+1:void 0,n,c,s)}function xa(r){return r*100+"%"}const ss=(r,e,t,n)=>r+t>n?e:t,os=(r,e,t)=>r<0?e:t,is=r=>Math.max(0,r),Nr=r=>Math.max(0,r),Tr=(r,e,t)=>{let{left:n,height:s,width:o}=e;const a=r.top-(s-r.height);return{left:n,width:o,height:os(a,r.height,s),top:Nr(a)}},Ar=(r,e,t)=>{let{top:n,left:s,height:o,width:a}=e;return{top:n,height:o,width:ss(r.left,r.width,a,t),left:is(s)}},Lr=(r,e,t)=>{let{top:n,height:s,width:o}=e;const a=r.left-(o-r.width);return{height:s,width:a<0?r.width:ss(r.left,r.width,o,t),top:Nr(n),left:is(a)}},qr=(r,e,t)=>{let{top:n,left:s,height:o,width:a}=e;return{width:a,left:s,height:os(n,r.height,o),top:Nr(n)}},wa=function(){return Tr(arguments.length<=0?void 0:arguments[0],Ar(...arguments))},_a=function(){return Tr(arguments.length<=0?void 0:arguments[0],Lr(...arguments))},Sa=function(){return qr(arguments.length<=0?void 0:arguments[0],Ar(...arguments))},ja=function(){return qr(arguments.length<=0?void 0:arguments[0],Lr(...arguments))},Pa={n:Tr,ne:wa,e:Ar,se:Sa,s:qr,sw:ja,w:Lr,nw:_a};function Ra(r,e,t,n){const s=Pa[r];return s?s(e,{...e,...t},n):t}function Ea(r){let{top:e,left:t,width:n,height:s}=r;const o=`translate(${t}px,${e}px)`;return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:`${n}px`,height:`${s}px`,position:"absolute"}}function Ca(r){let{top:e,left:t,width:n,height:s}=r;return{top:`${e}px`,left:`${t}px`,width:`${n}px`,height:`${s}px`,position:"absolute"}}function Wr(r,e){return e==="horizontal"?ls(r):e==="vertical"?as(r):r}function as(r){return r.slice(0).sort(function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1})}function ls(r){return r.slice(0).sort(function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1})}function Da(r,e,t,n,s){r=r||[];const o=[];ot.default.Children.forEach(e,l=>{if(l?.key==null)return;const c=Ir(r,String(l.key)),u=l.props["data-grid"];c&&u==null?o.push(Ue(c)):u?o.push(Ue({...u,i:l.key})):o.push(Ue({w:1,h:1,x:0,y:kr(o),i:String(l.key)}))});const a=rs(o,{cols:t});return s?a:es(a,n,t)}function Ma(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout";const t=["x","y","w","h"];if(!Array.isArray(r))throw new Error(e+" must be an array!");for(let n=0,s=r.length;n<s;n++){const o=r[n];for(let a=0;a<t.length;a++){const l=t[a],c=o[l];if(typeof c!="number"||Number.isNaN(c))throw new Error(`ReactGridLayout: ${e}[${n}].${l} must be a number! Received: ${c} (${typeof c})`)}if(typeof o.i<"u"&&typeof o.i!="string")throw new Error(`ReactGridLayout: ${e}[${n}].i must be a string! Received: ${o.i} (${typeof o.i})`)}}function Oa(r){const{verticalCompact:e,compactType:t}=r||{};return e===!1?null:t}const ka=()=>{};$.noop=ka;var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.calcGridColWidth=Nt;Ee.calcGridItemPosition=Ia;Ee.calcGridItemWHPx=xr;Ee.calcWH=Na;Ee.calcXY=za;Ee.clamp=$e;function Nt(r){const{margin:e,containerPadding:t,containerWidth:n,cols:s}=r;return(n-e[0]*(s-1)-t[0]*2)/s}function xr(r,e,t){return Number.isFinite(r)?Math.round(e*r+Math.max(0,r-1)*t):r}function Ia(r,e,t,n,s,o){const{margin:a,containerPadding:l,rowHeight:c}=r,u=Nt(r),h={};return o&&o.resizing?(h.width=Math.round(o.resizing.width),h.height=Math.round(o.resizing.height)):(h.width=xr(n,u,a[0]),h.height=xr(s,c,a[1])),o&&o.dragging?(h.top=Math.round(o.dragging.top),h.left=Math.round(o.dragging.left)):o&&o.resizing&&typeof o.resizing.top=="number"&&typeof o.resizing.left=="number"?(h.top=Math.round(o.resizing.top),h.left=Math.round(o.resizing.left)):(h.top=Math.round((c+a[1])*t+l[1]),h.left=Math.round((u+a[0])*e+l[0])),h}function za(r,e,t,n,s){const{margin:o,containerPadding:a,cols:l,rowHeight:c,maxRows:u}=r,h=Nt(r);let m=Math.round((t-a[0])/(h+o[0])),y=Math.round((e-a[1])/(c+o[1]));return m=$e(m,0,l-n),y=$e(y,0,u-s),{x:m,y}}function Na(r,e,t,n,s,o){const{margin:a,maxRows:l,cols:c,rowHeight:u}=r,h=Nt(r);let m=Math.round((e+a[0])/(h+a[0])),y=Math.round((t+a[1])/(u+a[1])),P=$e(m,0,c-n),M=$e(y,0,l-s);return["sw","w","nw"].indexOf(o)!==-1&&(P=$e(m,0,c)),["nw","n","ne"].indexOf(o)!==-1&&(M=$e(y,0,l)),{w:P,h:M}}function $e(r,e,t){return Math.max(Math.min(r,t),e)}var Tt={},At={exports:{}},cs={},se={},Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.dontSetMe=Wa;Ce.findInArray=Ta;Ce.int=qa;Ce.isFunction=Aa;Ce.isNum=La;function Ta(r,e){for(let t=0,n=r.length;t<n;t++)if(e.apply(e,[r[t],t,r]))return r[t]}function Aa(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Function]"}function La(r){return typeof r=="number"&&!isNaN(r)}function qa(r){return parseInt(r,10)}function Wa(r,e,t){if(r[e])return new Error(`Invalid prop ${e} passed to ${t} - do not set this, set it on the child.`)}var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.browserPrefixToKey=ds;Fe.browserPrefixToStyle=Ba;Fe.default=void 0;Fe.getPrefix=us;const tr=["Moz","Webkit","O","ms"];function us(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const e=window.document?.documentElement?.style;if(!e||r in e)return"";for(let t=0;t<tr.length;t++)if(ds(r,tr[t])in e)return tr[t];return""}function ds(r,e){return e?`${e}${Ha(r)}`:r}function Ba(r,e){return e?`-${e.toLowerCase()}-${r}`:r}function Ha(r){let e="",t=!0;for(let n=0;n<r.length;n++)t?(e+=r[n].toUpperCase(),t=!1):r[n]==="-"?t=!0:e+=r[n];return e}Fe.default=us();Object.defineProperty(se,"__esModule",{value:!0});se.addClassName=ps;se.addEvent=Ua;se.addUserSelectStyles=tl;se.createCSSTransform=Qa;se.createSVGTransform=Ja;se.getTouch=Za;se.getTouchIdentifier=el;se.getTranslation=Br;se.innerHeight=Ya;se.innerWidth=Ka;se.matchesSelector=hs;se.matchesSelectorAndParentsTo=$a;se.offsetXYFromParent=Xa;se.outerHeight=Ga;se.outerWidth=Va;se.removeClassName=ms;se.removeEvent=Fa;se.scheduleRemoveUserSelectStyles=rl;var _e=Ce,dn=fs(Fe);function fs(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(fs=function(s,o){if(!o&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=o?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const u in s)u!=="default"&&{}.hasOwnProperty.call(s,u)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,u))&&(l.get||l.set)?a(c,u,l):c[u]=s[u]);return c})(r,e)}let ht="";function hs(r,e){return ht||(ht=(0,_e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,_e.isFunction)(r[t])})),(0,_e.isFunction)(r[ht])?r[ht](e):!1}function $a(r,e,t){let n=r;do{if(hs(n,e))return!0;if(n===t)return!1;n=n.parentNode}while(n);return!1}function Ua(r,e,t,n){if(!r)return;const s={capture:!0,...n};r.addEventListener?r.addEventListener(e,t,s):r.attachEvent?r.attachEvent("on"+e,t):r["on"+e]=t}function Fa(r,e,t,n){if(!r)return;const s={capture:!0,...n};r.removeEventListener?r.removeEventListener(e,t,s):r.detachEvent?r.detachEvent("on"+e,t):r["on"+e]=null}function Ga(r){let e=r.clientHeight;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e+=(0,_e.int)(t.borderTopWidth),e+=(0,_e.int)(t.borderBottomWidth),e}function Va(r){let e=r.clientWidth;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e+=(0,_e.int)(t.borderLeftWidth),e+=(0,_e.int)(t.borderRightWidth),e}function Ya(r){let e=r.clientHeight;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e-=(0,_e.int)(t.paddingTop),e-=(0,_e.int)(t.paddingBottom),e}function Ka(r){let e=r.clientWidth;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e-=(0,_e.int)(t.paddingLeft),e-=(0,_e.int)(t.paddingRight),e}function Xa(r,e,t){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),o=(r.clientX+e.scrollLeft-s.left)/t,a=(r.clientY+e.scrollTop-s.top)/t;return{x:o,y:a}}function Qa(r,e){const t=Br(r,e,"px");return{[(0,dn.browserPrefixToKey)("transform",dn.default)]:t}}function Ja(r,e){return Br(r,e,"")}function Br(r,e,t){let{x:n,y:s}=r,o=`translate(${n}${t},${s}${t})`;if(e){const a=`${typeof e.x=="string"?e.x:e.x+t}`,l=`${typeof e.y=="string"?e.y:e.y+t}`;o=`translate(${a}, ${l})`+o}return o}function Za(r,e){return r.targetTouches&&(0,_e.findInArray)(r.targetTouches,t=>e===t.identifier)||r.changedTouches&&(0,_e.findInArray)(r.changedTouches,t=>e===t.identifier)}function el(r){if(r.targetTouches&&r.targetTouches[0])return r.targetTouches[0].identifier;if(r.changedTouches&&r.changedTouches[0])return r.changedTouches[0].identifier}function tl(r){if(!r)return;let e=r.getElementById("react-draggable-style-el");e||(e=r.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,r.getElementsByTagName("head")[0].appendChild(e)),r.body&&ps(r.body,"react-draggable-transparent-selection")}function rl(r){window.requestAnimationFrame?window.requestAnimationFrame(()=>{fn(r)}):fn(r)}function fn(r){if(r)try{if(r.body&&ms(r.body,"react-draggable-transparent-selection"),r.selection)r.selection.empty();else{const e=(r.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function ps(r,e){r.classList?r.classList.add(e):r.className.match(new RegExp(`(?:^|\\s)${e}(?!\\S)`))||(r.className+=` ${e}`)}function ms(r,e){r.classList?r.classList.remove(e):r.className=r.className.replace(new RegExp(`(?:^|\\s)${e}(?!\\S)`,"g"),"")}var De={};Object.defineProperty(De,"__esModule",{value:!0});De.canDragX=ol;De.canDragY=il;De.createCoreData=ll;De.createDraggableData=cl;De.getBoundPosition=nl;De.getControlPosition=al;De.snapToGrid=sl;var we=Ce,Qe=se;function nl(r,e,t){if(!r.props.bounds)return[e,t];let{bounds:n}=r.props;n=typeof n=="string"?n:ul(n);const s=Hr(r);if(typeof n=="string"){const{ownerDocument:o}=s,a=o.defaultView;let l;if(n==="parent"?l=s.parentNode:l=s.getRootNode().querySelector(n),!(l instanceof a.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');const c=l,u=a.getComputedStyle(s),h=a.getComputedStyle(c);n={left:-s.offsetLeft+(0,we.int)(h.paddingLeft)+(0,we.int)(u.marginLeft),top:-s.offsetTop+(0,we.int)(h.paddingTop)+(0,we.int)(u.marginTop),right:(0,Qe.innerWidth)(c)-(0,Qe.outerWidth)(s)-s.offsetLeft+(0,we.int)(h.paddingRight)-(0,we.int)(u.marginRight),bottom:(0,Qe.innerHeight)(c)-(0,Qe.outerHeight)(s)-s.offsetTop+(0,we.int)(h.paddingBottom)-(0,we.int)(u.marginBottom)}}return(0,we.isNum)(n.right)&&(e=Math.min(e,n.right)),(0,we.isNum)(n.bottom)&&(t=Math.min(t,n.bottom)),(0,we.isNum)(n.left)&&(e=Math.max(e,n.left)),(0,we.isNum)(n.top)&&(t=Math.max(t,n.top)),[e,t]}function sl(r,e,t){const n=Math.round(e/r[0])*r[0],s=Math.round(t/r[1])*r[1];return[n,s]}function ol(r){return r.props.axis==="both"||r.props.axis==="x"}function il(r){return r.props.axis==="both"||r.props.axis==="y"}function al(r,e,t){const n=typeof e=="number"?(0,Qe.getTouch)(r,e):null;if(typeof e=="number"&&!n)return null;const s=Hr(t),o=t.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,Qe.offsetXYFromParent)(n||r,o,t.props.scale)}function ll(r,e,t){const n=!(0,we.isNum)(r.lastX),s=Hr(r);return n?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:t,x:e,y:t}:{node:s,deltaX:e-r.lastX,deltaY:t-r.lastY,lastX:r.lastX,lastY:r.lastY,x:e,y:t}}function cl(r,e){const t=r.props.scale;return{node:e.node,x:r.state.x+e.deltaX/t,y:r.state.y+e.deltaY/t,deltaX:e.deltaX/t,deltaY:e.deltaY/t,lastX:r.state.x,lastY:r.state.y}}function ul(r){return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}function Hr(r){const e=r.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var Lt={},qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.default=dl;function dl(){}Object.defineProperty(Lt,"__esModule",{value:!0});Lt.default=void 0;var rr=gs(f),pe=$r(qe),fl=$r(Rt),de=se,Te=De,nr=Ce,rt=$r(qt);function $r(r){return r&&r.__esModule?r:{default:r}}function gs(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(gs=function(s,o){if(!o&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=o?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const u in s)u!=="default"&&{}.hasOwnProperty.call(s,u)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,u))&&(l.get||l.set)?a(c,u,l):c[u]=s[u]);return c})(r,e)}function me(r,e,t){return(e=hl(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function hl(r){var e=pl(r,"string");return typeof e=="symbol"?e:e+""}function pl(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Pe={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Ae=Pe.mouse,Wt=class extends rr.Component{constructor(){super(...arguments),me(this,"dragging",!1),me(this,"lastX",NaN),me(this,"lastY",NaN),me(this,"touchIdentifier",null),me(this,"mounted",!1),me(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=t;if(this.props.disabled||!(e.target instanceof n.defaultView.Node)||this.props.handle&&!(0,de.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,de.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;e.type==="touchstart"&&!this.props.allowMobileScroll&&e.preventDefault();const s=(0,de.getTouchIdentifier)(e);this.touchIdentifier=s;const o=(0,Te.getControlPosition)(e,s,this);if(o==null)return;const{x:a,y:l}=o,c=(0,Te.createCoreData)(this,a,l);(0,rt.default)("DraggableCore: handleDragStart: %j",c),(0,rt.default)("calling",this.props.onStart),!(this.props.onStart(e,c)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,de.addUserSelectStyles)(n),this.dragging=!0,this.lastX=a,this.lastY=l,(0,de.addEvent)(n,Ae.move,this.handleDrag),(0,de.addEvent)(n,Ae.stop,this.handleDragStop))}),me(this,"handleDrag",e=>{const t=(0,Te.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:n,y:s}=t;if(Array.isArray(this.props.grid)){let l=n-this.lastX,c=s-this.lastY;if([l,c]=(0,Te.snapToGrid)(this.props.grid,l,c),!l&&!c)return;n=this.lastX+l,s=this.lastY+c}const o=(0,Te.createCoreData)(this,n,s);if((0,rt.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(e,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const c=document.createEvent("MouseEvents");c.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(c)}return}this.lastX=n,this.lastY=s}),me(this,"handleDragStop",e=>{if(!this.dragging)return;const t=(0,Te.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:n,y:s}=t;if(Array.isArray(this.props.grid)){let c=n-this.lastX||0,u=s-this.lastY||0;[c,u]=(0,Te.snapToGrid)(this.props.grid,c,u),n=this.lastX+c,s=this.lastY+u}const o=(0,Te.createCoreData)(this,n,s);if(this.props.onStop(e,o)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,de.scheduleRemoveUserSelectStyles)(l.ownerDocument),(0,rt.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,rt.default)("DraggableCore: Removing handlers"),(0,de.removeEvent)(l.ownerDocument,Ae.move,this.handleDrag),(0,de.removeEvent)(l.ownerDocument,Ae.stop,this.handleDragStop))}),me(this,"onMouseDown",e=>(Ae=Pe.mouse,this.handleDragStart(e))),me(this,"onMouseUp",e=>(Ae=Pe.mouse,this.handleDragStop(e))),me(this,"onTouchStart",e=>(Ae=Pe.touch,this.handleDragStart(e))),me(this,"onTouchEnd",e=>(Ae=Pe.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,de.addEvent)(e,Pe.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,de.removeEvent)(t,Pe.mouse.move,this.handleDrag),(0,de.removeEvent)(t,Pe.touch.move,this.handleDrag),(0,de.removeEvent)(t,Pe.mouse.stop,this.handleDragStop),(0,de.removeEvent)(t,Pe.touch.stop,this.handleDragStop),(0,de.removeEvent)(e,Pe.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,de.scheduleRemoveUserSelectStyles)(t)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:fl.default.findDOMNode(this)}render(){return rr.cloneElement(rr.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Lt.default=Wt;me(Wt,"displayName","DraggableCore");me(Wt,"propTypes",{allowAnyClick:pe.default.bool,allowMobileScroll:pe.default.bool,children:pe.default.node.isRequired,disabled:pe.default.bool,enableUserSelectHack:pe.default.bool,offsetParent:function(r,e){if(r[e]&&r[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:pe.default.arrayOf(pe.default.number),handle:pe.default.string,cancel:pe.default.string,nodeRef:pe.default.object,onStart:pe.default.func,onDrag:pe.default.func,onStop:pe.default.func,onMouseDown:pe.default.func,scale:pe.default.number,className:nr.dontSetMe,style:nr.dontSetMe,transform:nr.dontSetMe});me(Wt,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DraggableCore",{enumerable:!0,get:function(){return c.default}}),r.default=void 0;var e=m(f),t=h(qe),n=h(Rt),s=Et,o=se,a=De,l=Ce,c=h(Lt),u=h(qt);function h(S){return S&&S.__esModule?S:{default:S}}function m(S,D){if(typeof WeakMap=="function")var v=new WeakMap,g=new WeakMap;return(m=function(p,b){if(!b&&p&&p.__esModule)return p;var _,x,R={__proto__:null,default:p};if(p===null||typeof p!="object"&&typeof p!="function")return R;if(_=b?g:v){if(_.has(p))return _.get(p);_.set(p,R)}for(const z in p)z!=="default"&&{}.hasOwnProperty.call(p,z)&&((x=(_=Object.defineProperty)&&Object.getOwnPropertyDescriptor(p,z))&&(x.get||x.set)?_(R,z,x):R[z]=p[z]);return R})(S,D)}function y(){return y=Object.assign?Object.assign.bind():function(S){for(var D=1;D<arguments.length;D++){var v=arguments[D];for(var g in v)({}).hasOwnProperty.call(v,g)&&(S[g]=v[g])}return S},y.apply(null,arguments)}function P(S,D,v){return(D=M(D))in S?Object.defineProperty(S,D,{value:v,enumerable:!0,configurable:!0,writable:!0}):S[D]=v,S}function M(S){var D=w(S,"string");return typeof D=="symbol"?D:D+""}function w(S,D){if(typeof S!="object"||!S)return S;var v=S[Symbol.toPrimitive];if(v!==void 0){var g=v.call(S,D);if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(S)}class E extends e.Component{static getDerivedStateFromProps(D,v){let{position:g}=D,{prevPropsPosition:p}=v;return g&&(!p||g.x!==p.x||g.y!==p.y)?((0,u.default)("Draggable: getDerivedStateFromProps %j",{position:g,prevPropsPosition:p}),{x:g.x,y:g.y,prevPropsPosition:{...g}}):null}constructor(D){super(D),P(this,"onDragStart",(v,g)=>{if((0,u.default)("Draggable: onDragStart: %j",g),this.props.onStart(v,(0,a.createDraggableData)(this,g))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),P(this,"onDrag",(v,g)=>{if(!this.state.dragging)return!1;(0,u.default)("Draggable: onDrag: %j",g);const p=(0,a.createDraggableData)(this,g),b={x:p.x,y:p.y,slackX:0,slackY:0};if(this.props.bounds){const{x,y:R}=b;b.x+=this.state.slackX,b.y+=this.state.slackY;const[z,ee]=(0,a.getBoundPosition)(this,b.x,b.y);b.x=z,b.y=ee,b.slackX=this.state.slackX+(x-b.x),b.slackY=this.state.slackY+(R-b.y),p.x=b.x,p.y=b.y,p.deltaX=b.x-this.state.x,p.deltaY=b.y-this.state.y}if(this.props.onDrag(v,p)===!1)return!1;this.setState(b)}),P(this,"onDragStop",(v,g)=>{if(!this.state.dragging||this.props.onStop(v,(0,a.createDraggableData)(this,g))===!1)return!1;(0,u.default)("Draggable: onDragStop: %j",g);const b={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x,y:R}=this.props.position;b.x=x,b.y=R}this.setState(b)}),this.state={dragging:!1,dragged:!1,x:D.position?D.position.x:D.defaultPosition.x,y:D.position?D.position.y:D.defaultPosition.y,prevPropsPosition:{...D.position},slackX:0,slackY:0,isElementSVG:!1},D.position&&(D.onDrag||D.onStop)}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??n.default.findDOMNode(this)}render(){const{axis:D,bounds:v,children:g,defaultPosition:p,defaultClassName:b,defaultClassNameDragging:_,defaultClassNameDragged:x,position:R,positionOffset:z,scale:ee,...A}=this.props;let K={},oe=null;const k=!!!R||this.state.dragging,G=R||p,be={x:(0,a.canDragX)(this)&&k?this.state.x:G.x,y:(0,a.canDragY)(this)&&k?this.state.y:G.y};this.state.isElementSVG?oe=(0,o.createSVGTransform)(be,z):K=(0,o.createCSSTransform)(be,z);const he=(0,s.clsx)(g.props.className||"",b,{[_]:this.state.dragging,[x]:this.state.dragged});return e.createElement(c.default,y({},A,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(g),{className:he,style:{...g.props.style,...K},transform:oe}))}}r.default=E,P(E,"displayName","Draggable"),P(E,"propTypes",{...c.default.propTypes,axis:t.default.oneOf(["both","x","y","none"]),bounds:t.default.oneOfType([t.default.shape({left:t.default.number,right:t.default.number,top:t.default.number,bottom:t.default.number}),t.default.string,t.default.oneOf([!1])]),defaultClassName:t.default.string,defaultClassNameDragging:t.default.string,defaultClassNameDragged:t.default.string,defaultPosition:t.default.shape({x:t.default.number,y:t.default.number}),positionOffset:t.default.shape({x:t.default.oneOfType([t.default.number,t.default.string]),y:t.default.oneOfType([t.default.number,t.default.string])}),position:t.default.shape({x:t.default.number,y:t.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),P(E,"defaultProps",{...c.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(cs);const{default:ys,DraggableCore:ml}=cs;At.exports=ys;At.exports.default=ys;At.exports.DraggableCore=ml;var bs=At.exports,Bt={exports:{}},ct={},Ur={};Ur.__esModule=!0;Ur.cloneElement=wl;var gl=yl(f);function yl(r){return r&&r.__esModule?r:{default:r}}function hn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function pn(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hn(Object(t),!0).forEach(function(n){bl(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):hn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function bl(r,e,t){return e=vl(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function vl(r){var e=xl(r,"string");return typeof e=="symbol"?e:String(e)}function xl(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function wl(r,e){return e.style&&r.props.style&&(e.style=pn(pn({},r.props.style),e.style)),e.className&&r.props.className&&(e.className=r.props.className+" "+e.className),gl.default.cloneElement(r,e)}var ut={};ut.__esModule=!0;ut.resizableProps=void 0;var L=_l(qe);function _l(r){return r&&r.__esModule?r:{default:r}}var Sl={axis:L.default.oneOf(["both","x","y","none"]),className:L.default.string,children:L.default.element.isRequired,draggableOpts:L.default.shape({allowAnyClick:L.default.bool,cancel:L.default.string,children:L.default.node,disabled:L.default.bool,enableUserSelectHack:L.default.bool,offsetParent:L.default.node,grid:L.default.arrayOf(L.default.number),handle:L.default.string,nodeRef:L.default.object,onStart:L.default.func,onDrag:L.default.func,onStop:L.default.func,onMouseDown:L.default.func,scale:L.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t[0];if(s.axis==="both"||s.axis==="y"){var o;return(o=L.default.number).isRequired.apply(o,t)}return L.default.number.apply(L.default,t)},handle:L.default.oneOfType([L.default.node,L.default.func]),handleSize:L.default.arrayOf(L.default.number),lockAspectRatio:L.default.bool,maxConstraints:L.default.arrayOf(L.default.number),minConstraints:L.default.arrayOf(L.default.number),onResizeStop:L.default.func,onResizeStart:L.default.func,onResize:L.default.func,resizeHandles:L.default.arrayOf(L.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:L.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t[0];if(s.axis==="both"||s.axis==="x"){var o;return(o=L.default.number).isRequired.apply(o,t)}return L.default.number.apply(L.default,t)}};ut.resizableProps=Sl;ct.__esModule=!0;ct.default=void 0;var nt=Cl(f),jl=bs,Pl=Ur,Rl=ut,El=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function vs(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(vs=function(s){return s?t:e})(r)}function Cl(r,e){if(r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=vs(e);if(t&&t.has(r))return t.get(r);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function wr(){return wr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},wr.apply(this,arguments)}function Dl(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function mn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function sr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mn(Object(t),!0).forEach(function(n){Ml(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):mn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Ml(r,e,t){return e=Ol(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ol(r){var e=kl(r,"string");return typeof e=="symbol"?e:String(e)}function kl(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Il(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,_r(r,e)}function _r(r,e){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},_r(r,e)}var Fr=function(r){Il(e,r);function e(){for(var n,s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var t=e.prototype;return t.componentWillUnmount=function(){this.resetData()},t.resetData=function(){this.lastHandleRect=this.slack=null},t.runConstraints=function(s,o){var a=this.props,l=a.minConstraints,c=a.maxConstraints,u=a.lockAspectRatio;if(!l&&!c&&!u)return[s,o];if(u){var h=this.props.width/this.props.height,m=s-this.props.width,y=o-this.props.height;Math.abs(m)>Math.abs(y*h)?o=s/h:s=o*h}var P=s,M=o,w=this.slack||[0,0],E=w[0],S=w[1];return s+=E,o+=S,l&&(s=Math.max(l[0],s),o=Math.max(l[1],o)),c&&(s=Math.min(c[0],s),o=Math.min(c[1],o)),this.slack=[E+(P-s),S+(M-o)],[s,o]},t.resizeHandler=function(s,o){var a=this;return function(l,c){var u=c.node,h=c.deltaX,m=c.deltaY;s==="onResizeStart"&&a.resetData();var y=(a.props.axis==="both"||a.props.axis==="x")&&o!=="n"&&o!=="s",P=(a.props.axis==="both"||a.props.axis==="y")&&o!=="e"&&o!=="w";if(!(!y&&!P)){var M=o[0],w=o[o.length-1],E=u.getBoundingClientRect();if(a.lastHandleRect!=null){if(w==="w"){var S=E.left-a.lastHandleRect.left;h+=S}if(M==="n"){var D=E.top-a.lastHandleRect.top;m+=D}}a.lastHandleRect=E,w==="w"&&(h=-h),M==="n"&&(m=-m);var v=a.props.width+(y?h/a.props.transformScale:0),g=a.props.height+(P?m/a.props.transformScale:0),p=a.runConstraints(v,g);v=p[0],g=p[1];var b=v!==a.props.width||g!==a.props.height,_=typeof a.props[s]=="function"?a.props[s]:null,x=s==="onResize"&&!b;_&&!x&&(l.persist==null||l.persist(),_(l,{node:u,size:{width:v,height:g},handle:o})),s==="onResizeStop"&&a.resetData()}}},t.renderResizeHandle=function(s,o){var a=this.props.handle;if(!a)return nt.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+s,ref:o});if(typeof a=="function")return a(s,o);var l=typeof a.type=="string",c=sr({ref:o},l?{}:{handleAxis:s});return nt.cloneElement(a,c)},t.render=function(){var s=this,o=this.props,a=o.children,l=o.className,c=o.draggableOpts;o.width,o.height,o.handle,o.handleSize,o.lockAspectRatio,o.axis,o.minConstraints,o.maxConstraints,o.onResize,o.onResizeStop,o.onResizeStart;var u=o.resizeHandles;o.transformScale;var h=Dl(o,El);return(0,Pl.cloneElement)(a,sr(sr({},h),{},{className:(l?l+" ":"")+"react-resizable",children:[].concat(a.props.children,u.map(function(m){var y,P=(y=s.handleRefs[m])!=null?y:s.handleRefs[m]=nt.createRef();return nt.createElement(jl.DraggableCore,wr({},c,{nodeRef:P,key:"resizableHandle-"+m,onStop:s.resizeHandler("onResizeStop",m),onStart:s.resizeHandler("onResizeStart",m),onDrag:s.resizeHandler("onResize",m)}),s.renderResizeHandle(m,P))}))}))},e}(nt.Component);ct.default=Fr;Fr.propTypes=Rl.resizableProps;Fr.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1};var Ht={};Ht.__esModule=!0;Ht.default=void 0;var or=Ll(f),zl=xs(qe),Nl=xs(ct),Tl=ut,Al=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function xs(r){return r&&r.__esModule?r:{default:r}}function ws(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(ws=function(s){return s?t:e})(r)}function Ll(r,e){if(r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=ws(e);if(t&&t.has(r))return t.get(r);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function Sr(){return Sr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Sr.apply(this,arguments)}function gn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function wt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gn(Object(t),!0).forEach(function(n){ql(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):gn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ql(r,e,t){return e=Wl(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Wl(r){var e=Bl(r,"string");return typeof e=="symbol"?e:String(e)}function Bl(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Hl(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function $l(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,jr(r,e)}function jr(r,e){return jr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},jr(r,e)}var _s=function(r){$l(e,r);function e(){for(var n,s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(l,c){var u=c.size;n.props.onResize?(l.persist==null||l.persist(),n.setState(u,function(){return n.props.onResize&&n.props.onResize(l,c)})):n.setState(u)},n}e.getDerivedStateFromProps=function(s,o){return o.propsWidth!==s.width||o.propsHeight!==s.height?{width:s.width,height:s.height,propsWidth:s.width,propsHeight:s.height}:null};var t=e.prototype;return t.render=function(){var s=this.props,o=s.handle,a=s.handleSize;s.onResize;var l=s.onResizeStart,c=s.onResizeStop,u=s.draggableOpts,h=s.minConstraints,m=s.maxConstraints,y=s.lockAspectRatio,P=s.axis;s.width,s.height;var M=s.resizeHandles,w=s.style,E=s.transformScale,S=Hl(s,Al);return or.createElement(Nl.default,{axis:P,draggableOpts:u,handle:o,handleSize:a,height:this.state.height,lockAspectRatio:y,maxConstraints:m,minConstraints:h,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:M,transformScale:E,width:this.state.width},or.createElement("div",Sr({},S,{style:wt(wt({},w),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},e}(or.Component);Ht.default=_s;_s.propTypes=wt(wt({},Tl.resizableProps),{},{children:zl.default.element});Bt.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};Bt.exports.Resizable=ct.default;Bt.exports.ResizableBox=Ht.default;var Ul=Bt.exports,ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.resizeHandleType=ze.resizeHandleAxesType=ze.default=void 0;var q=Ss(qe),Fl=Ss(f);function Ss(r){return r&&r.__esModule?r:{default:r}}const Gl=ze.resizeHandleAxesType=q.default.arrayOf(q.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),Vl=ze.resizeHandleType=q.default.oneOfType([q.default.node,q.default.func]);ze.default={className:q.default.string,style:q.default.object,width:q.default.number,autoSize:q.default.bool,cols:q.default.number,draggableCancel:q.default.string,draggableHandle:q.default.string,verticalCompact:function(r){r.verticalCompact},compactType:q.default.oneOf(["vertical","horizontal"]),layout:function(r){var e=r.layout;e!==void 0&&$.validateLayout(e,"layout")},margin:q.default.arrayOf(q.default.number),containerPadding:q.default.arrayOf(q.default.number),rowHeight:q.default.number,maxRows:q.default.number,isBounded:q.default.bool,isDraggable:q.default.bool,isResizable:q.default.bool,allowOverlap:q.default.bool,preventCollision:q.default.bool,useCSSTransforms:q.default.bool,transformScale:q.default.number,isDroppable:q.default.bool,resizeHandles:Gl,resizeHandle:Vl,onLayoutChange:q.default.func,onDragStart:q.default.func,onDrag:q.default.func,onDragStop:q.default.func,onResizeStart:q.default.func,onResize:q.default.func,onResizeStop:q.default.func,onDrop:q.default.func,droppingItem:q.default.shape({i:q.default.string.isRequired,w:q.default.number.isRequired,h:q.default.number.isRequired}),children:function(r,e){const t=r[e],n={};Fl.default.Children.forEach(t,function(s){if(s?.key!=null){if(n[s.key])throw new Error('Duplicate child key "'+s.key+'" found! This will cause problems in ReactGridLayout.');n[s.key]=!0}})},innerRef:q.default.any};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.default=void 0;var Ye=Gr(f),yn=Rt,F=Gr(qe),Yl=bs,Kl=Ul,Ke=$,ce=Ee,bn=ze,Xl=Gr(Et);function Gr(r){return r&&r.__esModule?r:{default:r}}function Re(r,e,t){return(e=Ql(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ql(r){var e=Jl(r,"string");return typeof e=="symbol"?e:e+""}function Jl(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Vr extends Ye.default.Component{constructor(){super(...arguments),Re(this,"state",{resizing:null,dragging:null,className:""}),Re(this,"elementRef",Ye.default.createRef()),Re(this,"onDragStart",(e,t)=>{let{node:n}=t;const{onDragStart:s,transformScale:o}=this.props;if(!s)return;const a={top:0,left:0},{offsetParent:l}=n;if(!l)return;const c=l.getBoundingClientRect(),u=n.getBoundingClientRect(),h=u.left/o,m=c.left/o,y=u.top/o,P=c.top/o;a.left=h-m+l.scrollLeft,a.top=y-P+l.scrollTop,this.setState({dragging:a});const{x:M,y:w}=(0,ce.calcXY)(this.getPositionParams(),a.top,a.left,this.props.w,this.props.h);return s.call(this,this.props.i,M,w,{e,node:n,newPosition:a})}),Re(this,"onDrag",(e,t,n)=>{let{node:s,deltaX:o,deltaY:a}=t;const{onDrag:l}=this.props;if(!l)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let c=this.state.dragging.top+a,u=this.state.dragging.left+o;const{isBounded:h,i:m,w:y,h:P,containerWidth:M}=this.props,w=this.getPositionParams();if(h){const{offsetParent:v}=s;if(v){const{margin:g,rowHeight:p}=this.props,b=v.clientHeight-(0,ce.calcGridItemWHPx)(P,p,g[1]);c=(0,ce.clamp)(c,0,b);const _=(0,ce.calcGridColWidth)(w),x=M-(0,ce.calcGridItemWHPx)(y,_,g[0]);u=(0,ce.clamp)(u,0,x)}}const E={top:c,left:u};n?this.setState({dragging:E}):(0,yn.flushSync)(()=>{this.setState({dragging:E})});const{x:S,y:D}=(0,ce.calcXY)(w,c,u,y,P);return l.call(this,m,S,D,{e,node:s,newPosition:E})}),Re(this,"onDragStop",(e,t)=>{let{node:n}=t;const{onDragStop:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:o,h:a,i:l}=this.props,{left:c,top:u}=this.state.dragging,h={top:u,left:c};this.setState({dragging:null});const{x:m,y}=(0,ce.calcXY)(this.getPositionParams(),u,c,o,a);return s.call(this,l,m,y,{e,node:n,newPosition:h})}),Re(this,"onResizeStop",(e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStop")),Re(this,"onResizeStart",(e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStart")),Re(this,"onResize",(e,t,n)=>this.onResizeHandler(e,t,n,"onResize"))}shouldComponentUpdate(e,t){if(this.props.children!==e.children||this.props.droppingPosition!==e.droppingPosition)return!0;const n=(0,ce.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),s=(0,ce.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,Ke.fastPositionEqual)(n,s)||this.props.useCSSTransforms!==e.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(e){this.moveDroppingItem(e)}moveDroppingItem(e){const{droppingPosition:t}=this.props;if(!t)return;const n=this.elementRef.current;if(!n)return;const s=e.droppingPosition||{left:0,top:0},{dragging:o}=this.state,a=o&&t.left!==s.left||t.top!==s.top;if(!o)this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top});else if(a){const l=t.left-o.left,c=t.top-o.top;this.onDrag(t.e,{node:n,deltaX:l,deltaY:c},!0)}}getPositionParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}createStyle(e){const{usePercentages:t,containerWidth:n,useCSSTransforms:s}=this.props;let o;return s?o=(0,Ke.setTransform)(e):(o=(0,Ke.setTopLeft)(e),t&&(o.left=(0,Ke.perc)(e.left/n),o.width=(0,Ke.perc)(e.width/n))),o}mixinDraggable(e,t){return Ye.default.createElement(Yl.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}curryResizeHandler(e,t){return(n,s)=>t(n,s,e)}mixinResizable(e,t,n){const{cols:s,minW:o,minH:a,maxW:l,maxH:c,transformScale:u,resizeHandles:h,resizeHandle:m}=this.props,y=this.getPositionParams(),P=(0,ce.calcGridItemPosition)(y,0,0,s,0).width,M=(0,ce.calcGridItemPosition)(y,0,0,o,a),w=(0,ce.calcGridItemPosition)(y,0,0,l,c),E=[M.width,M.height],S=[Math.min(w.width,P),Math.min(w.height,1/0)];return Ye.default.createElement(Kl.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:E,maxConstraints:S,onResizeStop:this.curryResizeHandler(t,this.onResizeStop),onResizeStart:this.curryResizeHandler(t,this.onResizeStart),onResize:this.curryResizeHandler(t,this.onResize),transformScale:u,resizeHandles:h,handle:m},e)}onResizeHandler(e,t,n,s){let{node:o,size:a,handle:l}=t;const c=this.props[s];if(!c)return;const{x:u,y:h,i:m,maxH:y,minH:P,containerWidth:M}=this.props,{minW:w,maxW:E}=this.props;let S=a;o&&(S=(0,Ke.resizeItemInDirection)(l,n,a,M),(0,yn.flushSync)(()=>{this.setState({resizing:s==="onResizeStop"?null:S})}));let{w:D,h:v}=(0,ce.calcWH)(this.getPositionParams(),S.width,S.height,u,h,l);D=(0,ce.clamp)(D,Math.max(w,1),E),v=(0,ce.clamp)(v,P,y),c.call(this,m,D,v,{e,node:o,size:S,handle:l})}render(){const{x:e,y:t,w:n,h:s,isDraggable:o,isResizable:a,droppingPosition:l,useCSSTransforms:c}=this.props,u=(0,ce.calcGridItemPosition)(this.getPositionParams(),e,t,n,s,this.state),h=Ye.default.Children.only(this.props.children);let m=Ye.default.cloneElement(h,{ref:this.elementRef,className:(0,Xl.default)("react-grid-item",h.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":o,"react-draggable-dragging":!!this.state.dragging,dropping:!!l,cssTransforms:c}),style:{...this.props.style,...h.props.style,...this.createStyle(u)}});return m=this.mixinResizable(m,u,a),m=this.mixinDraggable(m,o),m}}Tt.default=Vr;Re(Vr,"propTypes",{children:F.default.element,cols:F.default.number.isRequired,containerWidth:F.default.number.isRequired,rowHeight:F.default.number.isRequired,margin:F.default.array.isRequired,maxRows:F.default.number.isRequired,containerPadding:F.default.array.isRequired,x:F.default.number.isRequired,y:F.default.number.isRequired,w:F.default.number.isRequired,h:F.default.number.isRequired,minW:function(r,e){const t=r[e];if(typeof t!="number")return new Error("minWidth not Number");if(t>r.w||t>r.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(r,e){const t=r[e];if(typeof t!="number")return new Error("maxWidth not Number");if(t<r.w||t<r.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(r,e){const t=r[e];if(typeof t!="number")return new Error("minHeight not Number");if(t>r.h||t>r.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(r,e){const t=r[e];if(typeof t!="number")return new Error("maxHeight not Number");if(t<r.h||t<r.minH)return new Error("maxHeight smaller than item height/minHeight")},i:F.default.string.isRequired,resizeHandles:bn.resizeHandleAxesType,resizeHandle:bn.resizeHandleType,onDragStop:F.default.func,onDragStart:F.default.func,onDrag:F.default.func,onResizeStop:F.default.func,onResizeStart:F.default.func,onResize:F.default.func,isDraggable:F.default.bool.isRequired,isResizable:F.default.bool.isRequired,isBounded:F.default.bool.isRequired,static:F.default.bool,useCSSTransforms:F.default.bool.isRequired,transformScale:F.default.number,className:F.default.string,handle:F.default.string,cancel:F.default.string,droppingPosition:F.default.shape({e:F.default.object.isRequired,left:F.default.number.isRequired,top:F.default.number.isRequired})});Re(Vr,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1});Object.defineProperty(lt,"__esModule",{value:!0});lt.default=void 0;var We=js(f),ir=Or,Zl=Yr(Et),N=$,ec=Ee,vn=Yr(Tt),tc=Yr(ze);function Yr(r){return r&&r.__esModule?r:{default:r}}function js(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(js=function(s,o){if(!o&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=o?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const u in s)u!=="default"&&{}.hasOwnProperty.call(s,u)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,u))&&(l.get||l.set)?a(c,u,l):c[u]=s[u]);return c})(r,e)}function fe(r,e,t){return(e=rc(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function rc(r){var e=nc(r,"string");return typeof e=="symbol"?e:e+""}function nc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const xn="react-grid-layout";let Ps=!1;try{Ps=/firefox/i.test(navigator.userAgent)}catch{}class $t extends We.Component{constructor(){super(...arguments),fe(this,"state",{activeDrag:null,layout:(0,N.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,N.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),fe(this,"dragEnterCounter",0),fe(this,"onDragStart",(e,t,n,s)=>{let{e:o,node:a}=s;const{layout:l}=this.state,c=(0,N.getLayoutItem)(l,e);if(!c)return;const u={w:c.w,h:c.h,x:c.x,y:c.y,placeholder:!0,i:e};return this.setState({oldDragItem:(0,N.cloneLayoutItem)(c),oldLayout:l,activeDrag:u}),this.props.onDragStart(l,c,c,null,o,a)}),fe(this,"onDrag",(e,t,n,s)=>{let{e:o,node:a}=s;const{oldDragItem:l}=this.state;let{layout:c}=this.state;const{cols:u,allowOverlap:h,preventCollision:m}=this.props,y=(0,N.getLayoutItem)(c,e);if(!y)return;const P={w:y.w,h:y.h,x:y.x,y:y.y,placeholder:!0,i:e};c=(0,N.moveElement)(c,y,t,n,!0,m,(0,N.compactType)(this.props),u,h),this.props.onDrag(c,l,y,P,o,a),this.setState({layout:h?c:(0,N.compact)(c,(0,N.compactType)(this.props),u),activeDrag:P})}),fe(this,"onDragStop",(e,t,n,s)=>{let{e:o,node:a}=s;if(!this.state.activeDrag)return;const{oldDragItem:l}=this.state;let{layout:c}=this.state;const{cols:u,preventCollision:h,allowOverlap:m}=this.props,y=(0,N.getLayoutItem)(c,e);if(!y)return;c=(0,N.moveElement)(c,y,t,n,!0,h,(0,N.compactType)(this.props),u,m);const M=m?c:(0,N.compact)(c,(0,N.compactType)(this.props),u);this.props.onDragStop(M,l,y,null,o,a);const{oldLayout:w}=this.state;this.setState({activeDrag:null,layout:M,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(M,w)}),fe(this,"onResizeStart",(e,t,n,s)=>{let{e:o,node:a}=s;const{layout:l}=this.state,c=(0,N.getLayoutItem)(l,e);c&&(this.setState({oldResizeItem:(0,N.cloneLayoutItem)(c),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(l,c,c,null,o,a))}),fe(this,"onResize",(e,t,n,s)=>{let{e:o,node:a,size:l,handle:c}=s;const{oldResizeItem:u}=this.state,{layout:h}=this.state,{cols:m,preventCollision:y,allowOverlap:P}=this.props;let M=!1,w,E,S;const[D,v]=(0,N.withLayoutItem)(h,e,p=>{let b;return E=p.x,S=p.y,["sw","w","nw","n","ne"].indexOf(c)!==-1&&(["sw","nw","w"].indexOf(c)!==-1&&(E=p.x+(p.w-t),t=p.x!==E&&E<0?p.w:t,E=E<0?0:E),["ne","n","nw"].indexOf(c)!==-1&&(S=p.y+(p.h-n),n=p.y!==S&&S<0?p.h:n,S=S<0?0:S),M=!0),y&&!P&&(b=(0,N.getAllCollisions)(h,{...p,w:t,h:n,x:E,y:S}).filter(x=>x.i!==p.i).length>0,b&&(S=p.y,n=p.h,E=p.x,t=p.w,M=!1)),p.w=t,p.h=n,p});if(!v)return;w=D,M&&(w=(0,N.moveElement)(D,v,E,S,!0,this.props.preventCollision,(0,N.compactType)(this.props),m,P));const g={w:v.w,h:v.h,x:v.x,y:v.y,static:!0,i:e};this.props.onResize(w,u,v,g,o,a),this.setState({layout:P?w:(0,N.compact)(w,(0,N.compactType)(this.props),m),activeDrag:g})}),fe(this,"onResizeStop",(e,t,n,s)=>{let{e:o,node:a}=s;const{layout:l,oldResizeItem:c}=this.state,{cols:u,allowOverlap:h}=this.props,m=(0,N.getLayoutItem)(l,e),y=h?l:(0,N.compact)(l,(0,N.compactType)(this.props),u);this.props.onResizeStop(y,c,m,null,o,a);const{oldLayout:P}=this.state;this.setState({activeDrag:null,layout:y,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(y,P)}),fe(this,"onDragOver",e=>{if(e.preventDefault(),e.stopPropagation(),Ps&&!e.nativeEvent.target?.classList.contains(xn))return!1;const{droppingItem:t,onDropDragOver:n,margin:s,cols:o,rowHeight:a,maxRows:l,width:c,containerPadding:u,transformScale:h}=this.props,m=n?.(e);if(m===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const y={...t,...m},{layout:P}=this.state,M=e.currentTarget.getBoundingClientRect(),w=e.clientX-M.left,E=e.clientY-M.top,S={left:w/h,top:E/h,e};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:D,top:v}=this.state.droppingPosition;(D!=w||v!=E)&&this.setState({droppingPosition:S})}}else{const D={cols:o,margin:s,maxRows:l,rowHeight:a,containerWidth:c,containerPadding:u||s},v=(0,ec.calcXY)(D,E,w,y.w,y.h);this.setState({droppingDOMNode:We.createElement("div",{key:y.i}),droppingPosition:S,layout:[...P,{...y,x:v.x,y:v.y,static:!1,isDraggable:!0}]})}}),fe(this,"removeDroppingPlaceholder",()=>{const{droppingItem:e,cols:t}=this.props,{layout:n}=this.state,s=(0,N.compact)(n.filter(o=>o.i!==e.i),(0,N.compactType)(this.props),t,this.props.allowOverlap);this.setState({layout:s,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),fe(this,"onDragLeave",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),fe(this,"onDragEnter",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter++}),fe(this,"onDrop",e=>{e.preventDefault(),e.stopPropagation();const{droppingItem:t}=this.props,{layout:n}=this.state,s=n.find(o=>o.i===t.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,s,e)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(e,t){let n;return t.activeDrag?null:(!(0,ir.deepEqual)(e.layout,t.propsLayout)||e.compactType!==t.compactType?n=e.layout:(0,N.childrenEqual)(e.children,t.children)||(n=t.layout),n?{layout:(0,N.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,N.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}shouldComponentUpdate(e,t){return this.props.children!==e.children||!(0,N.fastRGLPropsEqual)(this.props,e,ir.deepEqual)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}componentDidUpdate(e,t){if(!this.state.activeDrag){const n=this.state.layout,s=t.layout;this.onLayoutMaybeChanged(n,s)}}containerHeight(){if(!this.props.autoSize)return;const e=(0,N.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+t*2+"px"}onLayoutMaybeChanged(e,t){t||(t=this.state.layout),(0,ir.deepEqual)(t,e)||this.props.onLayoutChange(e)}placeholder(){const{activeDrag:e}=this.state;if(!e)return null;const{width:t,cols:n,margin:s,containerPadding:o,rowHeight:a,maxRows:l,useCSSTransforms:c,transformScale:u}=this.props;return We.createElement(vn.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:t,cols:n,margin:s,containerPadding:o||s,maxRows:l,rowHeight:a,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:c,transformScale:u},We.createElement("div",null))}processGridItem(e,t){if(!e||!e.key)return;const n=(0,N.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;const{width:s,cols:o,margin:a,containerPadding:l,rowHeight:c,maxRows:u,isDraggable:h,isResizable:m,isBounded:y,useCSSTransforms:P,transformScale:M,draggableCancel:w,draggableHandle:E,resizeHandles:S,resizeHandle:D}=this.props,{mounted:v,droppingPosition:g}=this.state,p=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&h,b=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&m,_=n.resizeHandles||S,x=p&&y&&n.isBounded!==!1;return We.createElement(vn.default,{containerWidth:s,cols:o,margin:a,containerPadding:l||a,maxRows:u,rowHeight:c,cancel:w,handle:E,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:p,isResizable:b,isBounded:x,useCSSTransforms:P&&v,usePercentages:!v,transformScale:M,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?g:void 0,resizeHandles:_,resizeHandle:D},e)}render(){const{className:e,style:t,isDroppable:n,innerRef:s}=this.props,o=(0,Zl.default)(xn,e),a={height:this.containerHeight(),...t};return We.createElement("div",{ref:s,className:o,style:a,onDrop:n?this.onDrop:N.noop,onDragLeave:n?this.onDragLeave:N.noop,onDragEnter:n?this.onDragEnter:N.noop,onDragOver:n?this.onDragOver:N.noop},We.Children.map(this.props.children,l=>this.processGridItem(l)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}lt.default=$t;fe($t,"displayName","ReactGridLayout");fe($t,"propTypes",tc.default);fe($t,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:N.noop,onDragStart:N.noop,onDrag:N.noop,onDragStop:N.noop,onResizeStart:N.noop,onResize:N.noop,onResizeStop:N.noop,onDrop:N.noop,onDropDragOver:N.noop});var Ut={},Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.findOrGenerateResponsiveLayout=ic;Ge.getBreakpointFromWidth=sc;Ge.getColsFromBreakpoint=oc;Ge.sortBreakpoints=Kr;var pt=$;function sc(r,e){const t=Kr(r);let n=t[0];for(let s=1,o=t.length;s<o;s++){const a=t[s];e>r[a]&&(n=a)}return n}function oc(r,e){if(!e[r])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+r+" is missing!");return e[r]}function ic(r,e,t,n,s,o){if(r[t])return(0,pt.cloneLayout)(r[t]);let a=r[n];const l=Kr(e),c=l.slice(l.indexOf(t));for(let u=0,h=c.length;u<h;u++){const m=c[u];if(r[m]){a=r[m];break}}return a=(0,pt.cloneLayout)(a||[]),(0,pt.compact)((0,pt.correctBounds)(a,{cols:s}),o,s)}function Kr(r){return Object.keys(r).sort(function(t,n){return r[t]-r[n]})}Object.defineProperty(Ut,"__esModule",{value:!0});Ut.default=void 0;var wn=Es(f),ye=Rs(qe),ar=Or,Je=$,Be=Ge,ac=Rs(lt);function Rs(r){return r&&r.__esModule?r:{default:r}}function Es(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(Es=function(s,o){if(!o&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=o?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const u in s)u!=="default"&&{}.hasOwnProperty.call(s,u)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,u))&&(l.get||l.set)?a(c,u,l):c[u]=s[u]);return c})(r,e)}function Pr(){return Pr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Pr.apply(null,arguments)}function _t(r,e,t){return(e=lc(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function lc(r){var e=cc(r,"string");return typeof e=="symbol"?e:e+""}function cc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const _n=r=>Object.prototype.toString.call(r);function mt(r,e){return r==null?null:Array.isArray(r)?r:r[e]}class Xr extends wn.Component{constructor(){super(...arguments),_t(this,"state",this.generateInitialState()),_t(this,"onLayoutChange",e=>{this.props.onLayoutChange(e,{...this.props.layouts,[this.state.breakpoint]:e})})}generateInitialState(){const{width:e,breakpoints:t,layouts:n,cols:s}=this.props,o=(0,Be.getBreakpointFromWidth)(t,e),a=(0,Be.getColsFromBreakpoint)(o,s),l=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Be.findOrGenerateResponsiveLayout)(n,t,o,o,a,l),breakpoint:o,cols:a}}static getDerivedStateFromProps(e,t){if(!(0,ar.deepEqual)(e.layouts,t.layouts)){const{breakpoint:n,cols:s}=t;return{layout:(0,Be.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,s,e.compactType),layouts:e.layouts}}return null}componentDidUpdate(e){(this.props.width!=e.width||this.props.breakpoint!==e.breakpoint||!(0,ar.deepEqual)(this.props.breakpoints,e.breakpoints)||!(0,ar.deepEqual)(this.props.cols,e.cols))&&this.onWidthChange(e)}onWidthChange(e){const{breakpoints:t,cols:n,layouts:s,compactType:o}=this.props,a=this.props.breakpoint||(0,Be.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),l=this.state.breakpoint,c=(0,Be.getColsFromBreakpoint)(a,n),u={...s};if(l!==a||e.breakpoints!==t||e.cols!==n){l in u||(u[l]=(0,Je.cloneLayout)(this.state.layout));let y=(0,Be.findOrGenerateResponsiveLayout)(u,t,a,l,c,o);y=(0,Je.synchronizeLayoutWithChildren)(y,this.props.children,c,o,this.props.allowOverlap),u[a]=y,this.props.onBreakpointChange(a,c),this.props.onLayoutChange(y,u),this.setState({breakpoint:a,layout:y,cols:c})}const h=mt(this.props.margin,a),m=mt(this.props.containerPadding,a);this.props.onWidthChange(this.props.width,h,c,m)}render(){const{breakpoint:e,breakpoints:t,cols:n,layouts:s,margin:o,containerPadding:a,onBreakpointChange:l,onLayoutChange:c,onWidthChange:u,...h}=this.props;return wn.createElement(ac.default,Pr({},h,{margin:mt(o,this.state.breakpoint),containerPadding:mt(a,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}Ut.default=Xr;_t(Xr,"propTypes",{breakpoint:ye.default.string,breakpoints:ye.default.object,allowOverlap:ye.default.bool,cols:ye.default.object,margin:ye.default.oneOfType([ye.default.array,ye.default.object]),containerPadding:ye.default.oneOfType([ye.default.array,ye.default.object]),layouts(r,e){if(_n(r[e])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+_n(r[e]));Object.keys(r[e]).forEach(t=>{if(!(t in r.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,Je.validateLayout)(r.layouts[t],"layouts."+t)})},width:ye.default.number.isRequired,onBreakpointChange:ye.default.func,onLayoutChange:ye.default.func,onWidthChange:ye.default.func});_t(Xr,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:Je.noop,onLayoutChange:Je.noop,onWidthChange:Je.noop});var Qr={},Cs=function(){if(typeof Map<"u")return Map;function r(e,t){var n=-1;return e.some(function(s,o){return s[0]===t?(n=o,!0):!1}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var n=r(this.__entries__,t),s=this.__entries__[n];return s&&s[1]},e.prototype.set=function(t,n){var s=r(this.__entries__,t);~s?this.__entries__[s][1]=n:this.__entries__.push([t,n])},e.prototype.delete=function(t){var n=this.__entries__,s=r(n,t);~s&&n.splice(s,1)},e.prototype.has=function(t){return!!~r(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,n){n===void 0&&(n=null);for(var s=0,o=this.__entries__;s<o.length;s++){var a=o[s];t.call(n,a[1],a[0])}},e}()}(),Rr=typeof window<"u"&&typeof document<"u"&&window.document===document,St=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),uc=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(St):function(r){return setTimeout(function(){return r(Date.now())},1e3/60)}}(),dc=2;function fc(r,e){var t=!1,n=!1,s=0;function o(){t&&(t=!1,r()),n&&l()}function a(){uc(o)}function l(){var c=Date.now();if(t){if(c-s<dc)return;n=!0}else t=!0,n=!1,setTimeout(a,e);s=c}return l}var hc=20,pc=["top","right","bottom","left","width","height","size","weight"],mc=typeof MutationObserver<"u",gc=function(){function r(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=fc(this.refresh.bind(this),hc)}return r.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},r.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},r.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},r.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},r.prototype.connect_=function(){!Rr||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),mc?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},r.prototype.disconnect_=function(){!Rr||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},r.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=t===void 0?"":t,s=pc.some(function(o){return!!~n.indexOf(o)});s&&this.refresh()},r.getInstance=function(){return this.instance_||(this.instance_=new r),this.instance_},r.instance_=null,r}(),Ds=function(r,e){for(var t=0,n=Object.keys(e);t<n.length;t++){var s=n[t];Object.defineProperty(r,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return r},et=function(r){var e=r&&r.ownerDocument&&r.ownerDocument.defaultView;return e||St},Ms=Ft(0,0,0,0);function jt(r){return parseFloat(r)||0}function Sn(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(n,s){var o=r["border-"+s+"-width"];return n+jt(o)},0)}function yc(r){for(var e=["top","right","bottom","left"],t={},n=0,s=e;n<s.length;n++){var o=s[n],a=r["padding-"+o];t[o]=jt(a)}return t}function bc(r){var e=r.getBBox();return Ft(0,0,e.width,e.height)}function vc(r){var e=r.clientWidth,t=r.clientHeight;if(!e&&!t)return Ms;var n=et(r).getComputedStyle(r),s=yc(n),o=s.left+s.right,a=s.top+s.bottom,l=jt(n.width),c=jt(n.height);if(n.boxSizing==="border-box"&&(Math.round(l+o)!==e&&(l-=Sn(n,"left","right")+o),Math.round(c+a)!==t&&(c-=Sn(n,"top","bottom")+a)),!wc(r)){var u=Math.round(l+o)-e,h=Math.round(c+a)-t;Math.abs(u)!==1&&(l-=u),Math.abs(h)!==1&&(c-=h)}return Ft(s.left,s.top,l,c)}var xc=function(){return typeof SVGGraphicsElement<"u"?function(r){return r instanceof et(r).SVGGraphicsElement}:function(r){return r instanceof et(r).SVGElement&&typeof r.getBBox=="function"}}();function wc(r){return r===et(r).document.documentElement}function _c(r){return Rr?xc(r)?bc(r):vc(r):Ms}function Sc(r){var e=r.x,t=r.y,n=r.width,s=r.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return Ds(a,{x:e,y:t,width:n,height:s,top:t,right:e+n,bottom:s+t,left:e}),a}function Ft(r,e,t,n){return{x:r,y:e,width:t,height:n}}var jc=function(){function r(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Ft(0,0,0,0),this.target=e}return r.prototype.isActive=function(){var e=_c(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},r.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},r}(),Pc=function(){function r(e,t){var n=Sc(t);Ds(this,{target:e,contentRect:n})}return r}(),Rc=function(){function r(e,t,n){if(this.activeObservations_=[],this.observations_=new Cs,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return r.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof et(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new jc(e)),this.controller_.addObserver(this),this.controller_.refresh())}},r.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof et(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},r.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},r.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},r.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(n){return new Pc(n.target,n.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},r.prototype.clearActive=function(){this.activeObservations_.splice(0)},r.prototype.hasActive=function(){return this.activeObservations_.length>0},r}(),Os=typeof WeakMap<"u"?new WeakMap:new Cs,ks=function(){function r(e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=gc.getInstance(),n=new Rc(e,t,this);Os.set(this,n)}return r}();["observe","unobserve","disconnect"].forEach(function(r){ks.prototype[r]=function(){var e;return(e=Os.get(this))[r].apply(e,arguments)}});var Ec=function(){return typeof St.ResizeObserver<"u"?St.ResizeObserver:ks}();const Cc=Object.freeze(Object.defineProperty({__proto__:null,default:Ec},Symbol.toStringTag,{value:"Module"})),Dc=eo(Cc);Object.defineProperty(Qr,"__esModule",{value:!0});Qr.default=Tc;var gt=Is(f),Mc=Jr(qe),Oc=Jr(Dc),kc=Jr(Et);function Jr(r){return r&&r.__esModule?r:{default:r}}function Is(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(Is=function(s,o){if(!o&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=o?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const u in s)u!=="default"&&{}.hasOwnProperty.call(s,u)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,u))&&(l.get||l.set)?a(c,u,l):c[u]=s[u]);return c})(r,e)}function Er(){return Er=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Er.apply(null,arguments)}function Xe(r,e,t){return(e=Ic(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ic(r){var e=zc(r,"string");return typeof e=="symbol"?e:e+""}function zc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Nc="react-grid-layout";function Tc(r){var e;return e=class extends gt.Component{constructor(){super(...arguments),Xe(this,"state",{width:1280}),Xe(this,"elementRef",gt.createRef()),Xe(this,"mounted",!1),Xe(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new Oc.default(s=>{if(this.elementRef.current instanceof HTMLElement){const a=s[0].contentRect.width;this.setState({width:a})}});const n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;const n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){const{measureBeforeMount:n,...s}=this.props;return n&&!this.mounted?gt.createElement("div",{className:(0,kc.default)(this.props.className,Nc),style:this.props.style,ref:this.elementRef}):gt.createElement(r,Er({innerRef:this.elementRef},s,this.state))}},Xe(e,"defaultProps",{measureBeforeMount:!1}),Xe(e,"propTypes",{measureBeforeMount:Mc.default.bool}),e}(function(r){r.exports=lt.default,r.exports.utils=$,r.exports.calculateUtils=Ee,r.exports.Responsive=Ut.default,r.exports.Responsive.utils=Ge,r.exports.WidthProvider=Qr.default})(Qn);var jn=Qn.exports;const Ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Lc(r){return r==null?"":typeof r!="string"?String(r):r.replace(/[&<>"'`=\/]/g,e=>Ac[e])}function Zr(r,e={}){const{maxLength:t=1e4,trim:n=!0,normalizeWhitespace:s=!0}=e;if(r==null)return"";typeof r!="string"&&(r=String(r));let o=r;return o=o.replace(/\0/g,""),o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""),n&&(o=o.trim()),s&&(o=o.replace(/[ \t]+/g," ")),o.length>t&&(o=o.substring(0,t)),o}function Pt(r,e=255){return r==null?"":(typeof r!="string"&&(r=String(r)),Zr(r,{maxLength:e}).replace(/[\r\n]/g," ").replace(/\s+/g," ").trim())}function zs(r,e=1e4){return r==null?"":(typeof r!="string"&&(r=String(r)),Zr(r,{maxLength:e,normalizeWhitespace:!1}).replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`).trim())}function Ns(r){return r?Pt(r,254).toLowerCase():""}function Gt(r,e={}){const{min:t=-1/0,max:n=1/0,decimals:s=2}=e;if(r==null||r==="")return null;let o=String(r).replace(/[^0-9.\-]/g,""),a=parseFloat(o);return isNaN(a)?null:(a=Math.max(t,Math.min(n,a)),a=Math.round(a*Math.pow(10,s))/Math.pow(10,s),a)}function qc(r){const e=Gt(r,{min:0,decimals:2});return e!==null?Math.round(e*100)/100:null}function Wc(r){const e=Gt(r,{min:0,max:24,decimals:1});return e===null?null:Math.round(e*2)/2}function Bc(r){return Gt(r,{min:0,max:100,decimals:1})}function Hc(r){if(!r)return null;const e=String(r).trim();return/^(javascript|data|vbscript):/i.test(e)?null:/^(https?:\/\/|\/|#)/i.test(e)?e:`https://${e}`}function $c(r,e={}){if(!r||typeof r!="object")return r;const t={...r};for(const[n,s]of Object.entries(e)){if(t[n]===void 0)continue;const{type:o="text",maxLength:a}=s;switch(o){case"singleLine":t[n]=Pt(t[n],a);break;case"multiLine":t[n]=zs(t[n],a);break;case"email":t[n]=Ns(t[n]);break;case"number":t[n]=Gt(t[n],s);break;case"currency":t[n]=qc(t[n]);break;case"hours":t[n]=Wc(t[n]);break;case"percentage":t[n]=Bc(t[n]);break;case"url":t[n]=Hc(t[n]);break;case"html":t[n]=Lc(t[n]);break;default:t[n]=Zr(t[n],{maxLength:a})}}return t}const Uc={timesheet:{description:{type:"multiLine",maxLength:2e3},hours_worked:{type:"hours"}},expense:{reason:{type:"multiLine",maxLength:2e3},amount:{type:"currency"}},resource:{name:{type:"singleLine",maxLength:100},email:{type:"email"},role:{type:"singleLine",maxLength:100},notes:{type:"multiLine",maxLength:5e3}},partner:{name:{type:"singleLine",maxLength:200},contact_name:{type:"singleLine",maxLength:100},contact_email:{type:"email"},notes:{type:"multiLine",maxLength:5e3}},milestone:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3}},deliverable:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3}},kpi:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3},target_value:{type:"number",decimals:2},actual_value:{type:"number",decimals:2}},qualityStandard:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3},target_value:{type:"percentage"}}};function Pn(r,e){const t=Uc[r];return t?$c(e,t):e}class Me{constructor(e,t={}){this.tableName=e,this.supportsSoftDelete=t.supportsSoftDelete!==!1,this.sanitizeConfig=t.sanitizeConfig||null}getSoftDeleteFilter(){return this.supportsSoftDelete?"is_deleted.is.null,is_deleted.eq.false":null}async getAll(e,t={}){try{let n=j.from(this.tableName).select(t.select||"*").eq("project_id",e);this.supportsSoftDelete&&!t.includeDeleted&&(n=n.or(this.getSoftDeleteFilter())),t.filters&&Array.isArray(t.filters)&&t.filters.forEach(a=>{const{column:l,operator:c,value:u}=a;switch(c){case"eq":n=n.eq(l,u);break;case"neq":n=n.neq(l,u);break;case"gt":n=n.gt(l,u);break;case"gte":n=n.gte(l,u);break;case"lt":n=n.lt(l,u);break;case"lte":n=n.lte(l,u);break;case"like":n=n.like(l,u);break;case"ilike":n=n.ilike(l,u);break;case"in":n=n.in(l,u);break;case"is":n=n.is(l,u);break;default:n=n.eq(l,u)}}),t.orderBy&&(n=n.order(t.orderBy.column,{ascending:t.orderBy.ascending??!0}));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getDeleted(e){if(!this.supportsSoftDelete)return[];try{const{data:t,error:n}=await j.from(this.tableName).select("*").eq("project_id",e).eq("is_deleted",!0).order("deleted_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){throw t}}async getById(e,t={}){try{let n=j.from(this.tableName).select(t.select||"*").eq("id",e);this.supportsSoftDelete&&!t.includeDeleted&&(n=n.or(this.getSoftDeleteFilter()));const{data:s,error:o}=await n.single();if(o){if(o.code==="PGRST116")return null;throw o}return s}catch(n){throw n}}async create(e){try{if(!e.project_id)throw new Error("project_id is required");let t=e;this.sanitizeConfig&&(t=Pn(this.sanitizeConfig,e)),this.supportsSoftDelete&&(delete t.is_deleted,delete t.deleted_at,delete t.deleted_by);const{data:n,error:s}=await j.from(this.tableName).insert(t).select().single();if(s)throw s;return n}catch(t){throw t}}async update(e,t){try{let n=t;this.sanitizeConfig&&(n=Pn(this.sanitizeConfig,t));const s={...n,updated_at:new Date().toISOString()};delete s.is_deleted,delete s.deleted_at,delete s.deleted_by;const{data:o,error:a}=await j.from(this.tableName).update(s).eq("id",e).select().single();if(a)throw a;return o}catch(n){throw n}}async delete(e,t=null){try{if(this.supportsSoftDelete){const{error:n}=await j.from(this.tableName).update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:t}).eq("id",e);if(n)throw n}else{const{error:n}=await j.from(this.tableName).delete().eq("id",e);if(n)throw n}return!0}catch(n){throw n}}async hardDelete(e){try{const{error:t}=await j.from(this.tableName).delete().eq("id",e);if(t)throw t;return!0}catch(t){throw t}}async restore(e){if(!this.supportsSoftDelete)throw new Error("This entity does not support soft delete");try{const{data:t,error:n}=await j.from(this.tableName).update({is_deleted:!1,deleted_at:null,deleted_by:null}).eq("id",e).select().single();if(n)throw n;return t}catch(t){throw t}}async exists(e){try{let t=j.from(this.tableName).select("id",{count:"exact",head:!0}).eq("id",e);this.supportsSoftDelete&&(t=t.or(this.getSoftDeleteFilter()));const{count:n,error:s}=await t;if(s)throw s;return n>0}catch(t){throw t}}async count(e,t=[]){try{let n=j.from(this.tableName).select("id",{count:"exact",head:!0}).eq("project_id",e);this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.forEach(a=>{const{column:l,operator:c,value:u}=a;c==="eq"?n=n.eq(l,u):c==="in"&&(n=n.in(l,u))});const{count:s,error:o}=await n;if(o)throw o;return s||0}catch(n){throw n}}}class Fc extends Me{constructor(){super("partners")}async getAll(e){return super.getAll(e,{orderBy:{column:"name",ascending:!0}})}async getActive(e){return super.getAll(e,{filters:[{column:"is_active",operator:"eq",value:!0}],orderBy:{column:"name",ascending:!0}})}async getWithResources(e){try{const{data:t,error:n}=await j.from("partners").select(`
          *,
          resources (
            id,
            name,
            daily_rate,
            cost_price,
            is_active
          )
        `).eq("id",e).single();if(n){if(n.code==="PGRST116")return null;throw n}return t}catch(t){throw t}}async getSummary(e){try{const{data:t,error:n}=await j.from("partners").select(`
          id,
          name,
          contact_name,
          contact_email,
          payment_terms,
          is_active,
          created_at
        `).eq("project_id",e).order("name",{ascending:!0});if(n)throw n;return t||[]}catch(t){throw t}}async create(e){if(!e.name?.trim())throw new Error("Partner name is required");if(await this.findByName(e.project_id,e.name))throw new Error(`Partner "${e.name}" already exists`);return super.create({...e,name:e.name.trim(),is_active:e.is_active??!0,payment_terms:e.payment_terms||"Net 30"})}async findByName(e,t){try{const{data:n,error:s}=await j.from("partners").select("*").eq("project_id",e).ilike("name",t.trim()).single();if(s){if(s.code==="PGRST116")return null;throw s}return n}catch(n){if(n.code==="PGRST116")return null;throw n}}async toggleActive(e){const t=await this.getById(e);if(!t)throw new Error("Partner not found");return this.update(e,{is_active:!t.is_active})}async getForSelect(e,t=!0){return(t?await this.getActive(e):await this.getAll(e)).map(s=>({value:s.id,label:s.name}))}async getDependencyCounts(e){try{const{data:t,error:n}=await j.from("resources").select("id").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(n)throw n;const s=t?.map(u=>u.id)||[];let o=0,a=0;if(s.length>0){const{count:u,error:h}=await j.from("timesheets").select("*",{count:"exact",head:!0}).in("resource_id",s).or("is_deleted.is.null,is_deleted.eq.false");if(h)throw h;o=u||0;const{count:m,error:y}=await j.from("expenses").select("*",{count:"exact",head:!0}).in("resource_id",s).or("is_deleted.is.null,is_deleted.eq.false");if(y)throw y;a=m||0}const{count:l,error:c}=await j.from("partner_invoices").select("*",{count:"exact",head:!0}).eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(c)throw c;return{resourceCount:t?.length||0,timesheetCount:o,expenseCount:a,invoiceCount:l||0,canDelete:!t?.length&&!l}}catch(t){throw t}}}const Sd=new Fc;class Gc extends Me{constructor(){super("resources",{sanitizeConfig:"resource",supportsSoftDelete:!0})}sanitizeData(e){const t={...e};return t.name&&(t.name=Pt(t.name,100)),t.role&&(t.role=Pt(t.role,100)),t.email&&(t.email=Ns(t.email)),t.notes&&(t.notes=zs(t.notes,5e3)),t}async getAll(e,t={}){const{includePartner:n=!0,activeOnly:s=!1,showTestUsers:o=!0,includeDeleted:a=!1}=t;let l="*";n&&(l="*, partner:partners(id, name, is_active)");let c=j.from(this.tableName).select(l).eq("project_id",e).order("name");a||(c=c.or("is_deleted.is.null,is_deleted.eq.false")),s&&(c=c.eq("is_active",!0)),o||(c=c.or("is_test_content.is.null,is_test_content.eq.false"));const{data:u,error:h}=await c;if(h)throw h;return u||[]}async getAllFiltered(e,t=!0){return this.getAll(e,{showTestUsers:t,includePartner:!0})}async getById(e){const{data:t,error:n}=await j.from(this.tableName).select("*, partner:partners(id, name, contact_name, contact_email, is_active)").eq("id",e).or("is_deleted.is.null,is_deleted.eq.false").single();if(n)throw n;return t}async getByType(e,t){const{data:n,error:s}=await j.from(this.tableName).select("*, partner:partners(id, name)").eq("project_id",e).eq("resource_type",t).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(s)throw s;return n||[]}async getByPartner(e){const{data:t,error:n}=await j.from(this.tableName).select("*").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(n)throw n;return t||[]}async getWithTimesheetSummary(e){const t=await this.getById(e);if(!t)return null;const{data:n,error:s}=await j.from("timesheets").select("id, hours_worked, hours, status, was_rejected, date").eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false");let o=0,a=0,l=0;return n&&n.forEach(c=>{const u=parseFloat(c.hours_worked||c.hours||0);o+=u,c.status==="Approved"?a+=u:c.status==="Submitted"&&!c.was_rejected&&(l+=u)}),{...t,timesheetSummary:{totalEntries:n?.length||0,totalHours:o,approvedHours:a,pendingHours:l,daysWorked:o/8}}}async create(e){const t=this.sanitizeData(e);if(!t.name?.trim())throw new Error("Resource name is required");if(!t.project_id)throw new Error("Project ID is required");if(!t.email?.trim())throw new Error("Email is required");t.resource_type==="internal"&&(t.partner_id=null);const{data:n,error:s}=await j.from(this.tableName).insert([t]).select("*, partner:partners(id, name)").single();if(s)throw s;return n}async update(e,t){const n=this.sanitizeData(t);n.resource_type==="internal"&&(n.partner_id=null),n.updated_at=new Date().toISOString();const{data:s,error:o}=await j.from(this.tableName).update(n).eq("id",e).select("*, partner:partners(id, name)").single();if(o)throw o;return s}async delete(e,t=null){const{data:n,error:s}=await j.from(this.tableName).update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:t}).eq("id",e).select().single();if(s)throw s;return n}async restore(e){const{data:t,error:n}=await j.from(this.tableName).update({is_deleted:!1,deleted_at:null,deleted_by:null}).eq("id",e).select().single();if(n)throw n;return t}async linkToPartner(e,t){const n={partner_id:t,resource_type:t?"third_party":"internal",updated_at:new Date().toISOString()};return this.update(e,n)}async toggleActive(e){const t=await this.getById(e);if(!t)throw new Error("Resource not found");return this.update(e,{is_active:!t.is_active})}async getForSelect(e){const{data:t,error:n}=await j.from(this.tableName).select("id, name, resource_type, role").eq("project_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(n)throw n;return t||[]}calculateMargin(e,t){if(!e||e===0||!t)return{percent:null,amount:null,status:"unknown"};const n=(e-t)/e*100,s=e-t;let o="critical";return n>=25?o="good":n>=10&&(o="low"),{percent:n,amount:s,status:o}}async getUtilization(e){const t=await this.getWithTimesheetSummary(e);if(!t)return null;const n=t.days_allocated||0,s=t.timesheetSummary.daysWorked,o=Math.max(0,n-s),a=n>0?s/n*100:0;return{resourceId:e,resourceName:t.name,daysAllocated:n,daysUsed:s,remaining:o,utilizationPercent:a,totalValue:(t.daily_rate||0)*n,valueUsed:(t.daily_rate||0)*s}}async getSummary(e){const t=await this.getAll(e,{includePartner:!1});return{total:t.length,internal:t.filter(n=>n.resource_type==="internal").length,thirdParty:t.filter(n=>n.resource_type==="third_party").length,active:t.filter(n=>n.is_active).length,totalBudget:t.reduce((n,s)=>n+(s.daily_rate||0)*(s.days_allocated||0),0)}}async getProfileByEmail(e){try{const{data:t,error:n}=await this.supabase.from("profiles").select("id, email, full_name, role").eq("email",e).single();if(n){if(n.code==="PGRST116")return null;throw n}return t}catch(t){throw t}}async getAllWithTestFilter(e,t=[]){try{const n=await this.getAll(e,{orderBy:{column:"name",ascending:!0}});return t&&t.length>0?n.filter(s=>!s.user_id||!t.includes(s.user_id)):n}catch(n){throw n}}async getDependencyCounts(e){try{const[t,n]=await Promise.all([this.supabase.from("timesheets").select("id",{count:"exact",head:!0}).eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false"),this.supabase.from("expenses").select("id",{count:"exact",head:!0}).eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false")]);return{timesheetCount:t.count||0,expenseCount:n.count||0,canDelete:(t.count||0)===0&&(n.count||0)===0}}catch(t){throw t}}}const jd=new Gc;class Vc extends Me{constructor(){super("timesheets",{supportsSoftDelete:!0,sanitizeConfig:"timesheet"})}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||`
      *,
      resources(id, name, email, daily_rate, cost_price),
      milestones(id, milestone_ref, name)
    `,orderBy:t.orderBy||{column:"date",ascending:!1}})}async getAllFiltered(e,t=!1){try{let n=j.from(this.tableName).select(`
          *,
          resources(id, name, email, daily_rate, cost_price),
          milestones(id, milestone_ref, name)
        `).eq("project_id",e).order("date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getByResource(e,t={}){try{let n=j.from(this.tableName).select("*, milestones(id, milestone_ref, name)").eq("resource_id",e).order("date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.start&&(n=n.gte("date",t.start)),t.end&&(n=n.lte("date",t.end)),t.status&&(n=n.eq("status",t.status));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getByPartner(e,t={}){try{const{data:n}=await j.from("resources").select("id, name, cost_price").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(!n||n.length===0)return[];const s=n.map(c=>c.id);let o=j.from(this.tableName).select("*, resources(id, name, cost_price), milestones(id, milestone_ref, name)").in("resource_id",s).order("date",{ascending:!1});this.supportsSoftDelete&&(o=o.or(this.getSoftDeleteFilter())),t.start&&(o=o.gte("date",t.start)),t.end&&(o=o.lte("date",t.end)),t.status&&(o=o.eq("status",t.status));const{data:a,error:l}=await o;if(l)throw l;return a||[]}catch(n){throw n}}async getApprovedForInvoice(e,t){if(!t.start||!t.end)throw new Error("Date range (start and end) is required for invoice queries");return this.getByPartner(e,{...t,status:"Approved"})}async getSummary(e,t={}){try{const n=await this.getAll(e,t),s={totalHours:0,totalDays:0,approvedHours:0,pendingHours:0,draftHours:0,rejectedHours:0,totalCost:0,approvedCost:0,byStatus:{Draft:{count:0,hours:0},Submitted:{count:0,hours:0},Approved:{count:0,hours:0},Rejected:{count:0,hours:0}},byMilestone:{},count:n.length};return n.forEach(o=>{const a=parseFloat(o.hours_worked||o.hours||0),l=o.resources?.cost_price||0,c=a/8*l;switch(s.totalHours+=a,s.totalCost+=c,s.byStatus[o.status]&&(s.byStatus[o.status].count++,s.byStatus[o.status].hours+=a),o.status){case"Approved":s.approvedHours+=a,s.approvedCost+=c;break;case"Submitted":o.was_rejected||(s.pendingHours+=a);break;case"Draft":s.draftHours+=a;break;case"Rejected":s.rejectedHours+=a;break}if(o.milestone_id){const u=o.milestones?.milestone_ref||"Unknown";s.byMilestone[o.milestone_id]||(s.byMilestone[o.milestone_id]={ref:u,name:o.milestones?.name||"Unknown",hours:0,cost:0}),s.byMilestone[o.milestone_id].hours+=a,s.byMilestone[o.milestone_id].cost+=c}}),s.totalDays=s.totalHours/8,s}catch(n){throw n}}async create(e){if(!e.resource_id)throw new Error("resource_id is required");if(!e.date)throw new Error("date is required");const t=parseFloat(e.hours_worked||e.hours||0);if(!t||t<=0)throw new Error("hours must be greater than 0");const n={...e,hours_worked:t,hours:t,date:e.date||e.work_date,work_date:e.work_date||e.date,description:e.description||e.comments||"",comments:e.comments||e.description||"",status:e.status||"Draft"};return super.create(n)}async submit(e){return this.update(e,{status:"Submitted"})}async approve(e){return this.update(e,{status:"Approved"})}async reject(e,t=null){const n={status:"Rejected",was_rejected:!0};return t&&(n.rejection_reason=t),this.update(e,n)}calculateCost(e,t){return e/8*t}calculateBillable(e,t){return e/8*t}}const Yc=new Vc;class Kc extends Me{constructor(){super("expenses",{supportsSoftDelete:!0,sanitizeConfig:"expense"})}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||"*, expense_files(*)",orderBy:t.orderBy||{column:"expense_date",ascending:!1}})}async getAllFiltered(e,t=!1){try{let n=j.from(this.tableName).select("*, expense_files(*)").eq("project_id",e).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getByResource(e,t={}){try{let n=j.from(this.tableName).select("*, expense_files(*)").eq("resource_id",e).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.start&&(n=n.gte("expense_date",t.start)),t.end&&(n=n.lte("expense_date",t.end));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getByPartner(e,t={}){try{const{data:n}=await j.from("resources").select("id").eq("partner_id",e);if(!n||n.length===0)return[];const s=n.map(c=>c.id);let o=j.from(this.tableName).select("*, expense_files(*)").in("resource_id",s).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(o=o.or(this.getSoftDeleteFilter())),t.start&&(o=o.gte("expense_date",t.start)),t.end&&(o=o.lte("expense_date",t.end)),t.procurementMethod&&(o=o.eq("procurement_method",t.procurementMethod));const{data:a,error:l}=await o;if(l)throw l;return a||[]}catch(n){throw n}}async getPartnerProcuredForInvoice(e,t){if(!t.start||!t.end)throw new Error("Date range (start and end) is required for invoice queries");return this.getByPartner(e,{...t,procurementMethod:"partner"})}async getSummary(e,t={}){try{const n=await this.getAll(e,t),s={total:0,chargeable:0,nonChargeable:0,supplierProcured:0,partnerProcured:0,byCategory:{Travel:0,Accommodation:0,Sustenance:0},byStatus:{Draft:0,Submitted:0,Approved:0,Rejected:0,Paid:0},count:n.length};return n.forEach(o=>{const a=parseFloat(o.amount||0);s.total+=a,o.chargeable_to_customer!==!1?s.chargeable+=a:s.nonChargeable+=a,o.procurement_method==="partner"?s.partnerProcured+=a:s.supplierProcured+=a,s.byCategory[o.category]!==void 0&&(s.byCategory[o.category]+=a),s.byStatus[o.status]!==void 0&&(s.byStatus[o.status]+=a)}),s}catch(n){throw n}}async create(e){if(!e.resource_id)throw new Error("resource_id is required");if(!e.category)throw new Error("category is required");if(!e.amount||e.amount<=0)throw new Error("amount must be greater than 0");const t={...e,status:e.status||"Draft",chargeable_to_customer:e.chargeable_to_customer??!0,procurement_method:e.procurement_method||"supplier"};return super.create(t)}async createMany(e){if(!e||e.length===0)return[];try{const t=e.map(o=>{if(!o.resource_id)throw new Error("resource_id is required for all expenses");if(!o.category)throw new Error("category is required for all expenses");if(!o.amount||o.amount<=0)throw new Error("amount must be greater than 0 for all expenses");return{...o,status:o.status||"Draft",chargeable_to_customer:o.chargeable_to_customer??!0,procurement_method:o.procurement_method||"supplier"}}),{data:n,error:s}=await j.from(this.tableName).insert(t).select();if(s)throw s;return n||[]}catch(t){throw t}}async submit(e){return this.update(e,{status:"Submitted"})}async approve(e){return this.update(e,{status:"Approved"})}async reject(e,t=null){const n={status:"Rejected"};return t&&(n.rejection_reason=t),this.update(e,n)}async markPaid(e){return this.update(e,{status:"Paid"})}async uploadReceipt(e,t,n){try{const s=`${e}/${Date.now()}-${t.name}`,{error:o}=await j.storage.from("receipts").upload(s,t);if(o)throw o;const{data:a,error:l}=await j.from("expense_files").insert({expense_id:e,file_name:t.name,file_path:s,file_size:t.size,file_type:t.type,uploaded_by:n}).select().single();if(l)throw l;return a}catch(s){throw s}}async downloadReceipt(e){try{const{data:t,error:n}=await j.storage.from("receipts").download(e);if(n)throw n;return t}catch(t){throw t}}}const Pd=new Kc;class Xc extends Me{constructor(){super("partner_invoices")}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||"*, partners(name)",orderBy:t.orderBy||{column:"invoice_date",ascending:!1}})}async getByPartner(e,t={}){try{let n=j.from(this.tableName).select("*").eq("partner_id",e).order("invoice_date",{ascending:!1});t.status&&(n=n.eq("status",t.status));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async getWithLines(e){try{const{data:t,error:n}=await j.from(this.tableName).select("*, partners(name, contact_name, contact_email, payment_terms)").eq("id",e).single();if(n)throw n;if(!t)return null;const{data:s,error:o}=await j.from("partner_invoice_lines").select("*").eq("invoice_id",e).order("line_type",{ascending:!0}).order("resource_name",{ascending:!0}).order("line_date",{ascending:!0});if(o)throw o;const a={timesheets:(s||[]).filter(l=>l.line_type==="timesheet"),supplierExpenses:(s||[]).filter(l=>l.line_type==="supplier_expense"),partnerExpenses:(s||[]).filter(l=>l.line_type==="expense")};return{...t,lines:s||[],groupedLines:a}}catch(t){throw t}}async generateInvoiceNumber(e){try{const n=`INV-${new Date().getFullYear()}-`,{data:s,error:o}=await j.from(this.tableName).select("invoice_number").eq("project_id",e).like("invoice_number",`${n}%`).order("invoice_number",{ascending:!1}).limit(1);if(o)throw o;let a=1;if(s&&s.length>0){const l=s[0].invoice_number,c=parseInt(l.replace(n,""),10);isNaN(c)||(a=c+1)}return`${n}${String(a).padStart(3,"0")}`}catch(t){throw t}}async generateInvoice(e){const{projectId:t,partnerId:n,periodStart:s,periodEnd:o,createdBy:a,notes:l,includeSubmitted:c=!0}=e;try{const{data:u,error:h}=await j.from("resources").select("id, name, cost_price").eq("partner_id",n);if(h)throw h;if(!u||u.length===0)throw new Error("No resources linked to this partner");const m=u.map(I=>I.id),y={};u.forEach(I=>{y[I.id]=I});const P=c?["Approved","Submitted"]:["Approved"],{data:M,error:w}=await j.from("timesheets").select("id, date, hours_worked, hours, status, resource_id").in("resource_id",m).gte("date",s).lte("date",o).in("status",P);if(w)throw w;const{data:E,error:S}=await j.from("expenses").select("id, expense_date, category, reason, amount, resource_id, resource_name, procurement_method, chargeable_to_customer, status").in("resource_id",m).gte("expense_date",s).lte("expense_date",o).in("status",["Approved","Submitted","Paid"]);if(S)throw S;const D=(E||[]).filter(I=>I.procurement_method==="partner"||!I.procurement_method),v=(E||[]).filter(I=>I.procurement_method==="supplier");let g=0,p=0;const b=[],_={};(M||[]).forEach(I=>{_[I.resource_id]||(_[I.resource_id]=[]),_[I.resource_id].push(I)}),Object.keys(_).forEach(I=>{const ae=y[I];_[I].forEach(V=>{const te=parseFloat(V.hours_worked||V.hours||0),C=ae?.cost_price||0,O=te/8,T=O*C;g+=T,p+=T,b.push({line_type:"timesheet",timesheet_id:V.id,expense_id:null,description:`${ae?.name||"Unknown"} - ${te}h (${O.toFixed(2)} days)`,quantity:te,unit_price:C,line_total:T,resource_name:ae?.name,line_date:V.date,hours:te,cost_price:C,source_status:V.status,chargeable_to_customer:!0,procurement_method:null,expense_category:null})})});let x=0,R=0,z=0;const ee=[];D.forEach(I=>{const ae=parseFloat(I.amount||0);x+=ae,I.chargeable_to_customer?R+=ae:z+=ae,ee.push({line_type:"expense",timesheet_id:null,expense_id:I.id,description:`${I.resource_name} - ${I.category}: ${I.reason}`,quantity:1,unit_price:ae,line_total:ae,resource_name:I.resource_name,line_date:I.expense_date,hours:null,cost_price:null,source_status:I.status,chargeable_to_customer:I.chargeable_to_customer,procurement_method:"partner",expense_category:I.category})});let A=0,K=0,oe=0;const Oe=[];v.forEach(I=>{const ae=parseFloat(I.amount||0);A+=ae,I.chargeable_to_customer?K+=ae:oe+=ae,Oe.push({line_type:"supplier_expense",timesheet_id:null,expense_id:I.id,description:`${I.resource_name} - ${I.category}: ${I.reason}`,quantity:1,unit_price:ae,line_total:ae,resource_name:I.resource_name,line_date:I.expense_date,hours:null,cost_price:null,source_status:I.status,chargeable_to_customer:I.chargeable_to_customer,procurement_method:"supplier",expense_category:I.category})});const k=g+x,G=p+R+K,be=z+oe,he=await this.generateInvoiceNumber(t),{data:ke,error:Ie}=await j.from(this.tableName).insert({project_id:t,partner_id:n,invoice_number:he,invoice_date:new Date().toISOString().split("T")[0],period_start:s,period_end:o,timesheet_total:g,expense_total:x,supplier_expense_total:A,invoice_total:k,chargeable_total:G,non_chargeable_total:be,status:"Draft",notes:l||null,created_by:a}).select().single();if(Ie)throw Ie;const Ne=[...b,...ee,...Oe].map(I=>({...I,invoice_id:ke.id}));if(Ne.length>0){const{error:I}=await j.from("partner_invoice_lines").insert(Ne);if(I)throw I}return this.getWithLines(ke.id)}catch(u){throw u}}async updateStatus(e,t){const n={status:t};return t==="Sent"?n.sent_at=new Date().toISOString():t==="Paid"&&(n.paid_at=new Date().toISOString()),this.update(e,n)}async markSent(e){return this.updateStatus(e,"Sent")}async markPaid(e){return this.updateStatus(e,"Paid")}async cancel(e){return this.updateStatus(e,"Cancelled")}async getPartnerStats(e){try{const{data:t,error:n}=await j.from(this.tableName).select("status, invoice_total").eq("partner_id",e);if(n)throw n;const s={total:0,draft:0,sent:0,paid:0,cancelled:0,count:t?.length||0};return(t||[]).forEach(o=>{const a=parseFloat(o.invoice_total||0);switch(s.total+=a,o.status){case"Draft":s.draft+=a;break;case"Sent":s.sent+=a;break;case"Paid":s.paid+=a;break;case"Cancelled":s.cancelled+=a;break}}),s}catch(t){throw t}}}const Rd=new Xc;class Qc extends Me{constructor(){super("milestones",{supportsSoftDelete:!0,sanitizeConfig:"milestone"})}async getAllWithStats(e){try{const t=await this.getAll(e,{orderBy:{column:"start_date",ascending:!0}}),{data:n}=await j.from("timesheets").select("milestone_id, hours_worked").eq("project_id",e).not("milestone_id","is",null).or("is_deleted.is.null,is_deleted.eq.false"),s={};return(n||[]).forEach(o=>{s[o.milestone_id]||(s[o.milestone_id]=0),s[o.milestone_id]+=parseFloat(o.hours_worked||0)}),t.map(o=>({...o,logged_hours:s[o.id]||0,logged_days:(s[o.id]||0)/8}))}catch(t){throw t}}async getWithDeliverables(e){try{const{data:t,error:n}=await j.from(this.tableName).select("*").eq("id",e).or(this.getSoftDeleteFilter()).single();if(n)throw n;const{data:s,error:o}=await j.from("deliverables").select("*").eq("milestone_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("due_date",{ascending:!0});if(o)throw o;return{...t,deliverables:s||[]}}catch(t){throw t}}async getByStatus(e,t){return this.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"start_date",ascending:!0}})}async getUpcoming(e,t=30){try{const n=new Date().toISOString().split("T")[0],s=new Date;s.setDate(s.getDate()+t);const o=s.toISOString().split("T")[0];let a=j.from(this.tableName).select("*").eq("project_id",e).gte("end_date",n).lte("end_date",o).neq("status","Completed").order("end_date",{ascending:!0});this.supportsSoftDelete&&(a=a.or(this.getSoftDeleteFilter()));const{data:l,error:c}=await a;if(c)throw c;return l||[]}catch(n){throw n}}async updateStatus(e,t){return this.update(e,{status:t})}async updateCompletion(e,t){const n={completion_percentage:t};return t>=100&&(n.status="Completed"),this.update(e,n)}async getSummary(e){try{const t=await this.getAll(e),n={total:t.length,completed:0,inProgress:0,notStarted:0,overdue:0,upcoming:0},s=new Date().toISOString().split("T")[0],o=new Date;o.setDate(o.getDate()+7);const a=o.toISOString().split("T")[0];return t.forEach(l=>{l.status==="Completed"?n.completed++:l.status==="In Progress"?(n.inProgress++,l.end_date<s&&n.overdue++):l.status==="Not Started"&&(n.notStarted++,l.start_date<=a&&n.upcoming++)}),n}catch(t){throw t}}async getCertificates(e){try{const{data:t,error:n}=await j.from("milestone_certificates").select("*").eq("project_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){throw t}}async createCertificate(e){try{const{data:t,error:n}=await j.from("milestone_certificates").insert([e]).select().single();if(n)throw n;return t}catch(t){throw t}}async updateCertificate(e,t){try{const{data:n,error:s}=await j.from("milestone_certificates").update(t).eq("id",e).select().single();if(s)throw s;return n}catch(n){throw n}}}const Jc=new Qc;class Zc extends Me{constructor(){super("deliverables",{supportsSoftDelete:!0,sanitizeConfig:"deliverable"})}async getAllWithMilestones(e){return this.getAll(e,{select:"*, milestones(name, milestone_ref)",orderBy:{column:"due_date",ascending:!0}})}async getByMilestone(e){try{let t=j.from(this.tableName).select("*").eq("milestone_id",e).order("due_date",{ascending:!0});this.supportsSoftDelete&&(t=t.or(this.getSoftDeleteFilter()));const{data:n,error:s}=await t;if(s)throw s;return n||[]}catch(t){throw t}}async getByStatus(e,t){return this.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"due_date",ascending:!0}})}async getOverdue(e){try{const t=new Date().toISOString().split("T")[0];let n=j.from(this.tableName).select("*, milestones(name)").eq("project_id",e).lt("due_date",t).not("status","in",'("Delivered","Cancelled")').order("due_date",{ascending:!0});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter()));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(t){throw t}}async getUpcoming(e,t=14){try{const n=new Date().toISOString().split("T")[0],s=new Date;s.setDate(s.getDate()+t);const o=s.toISOString().split("T")[0];let a=j.from(this.tableName).select("*, milestones(name)").eq("project_id",e).gte("due_date",n).lte("due_date",o).not("status","eq","Delivered").order("due_date",{ascending:!0});this.supportsSoftDelete&&(a=a.or(this.getSoftDeleteFilter()));const{data:l,error:c}=await a;if(c)throw c;return l||[]}catch(n){throw n}}async updateStatus(e,t,n){const s={status:t};return t==="Submitted"?(s.submitted_date=new Date().toISOString(),s.submitted_by=n):t==="Delivered"&&(s.delivered_date=new Date().toISOString(),s.delivered_by=n),this.update(e,s)}async submit(e,t){return this.updateStatus(e,"Submitted",t)}async markDelivered(e,t){return this.updateStatus(e,"Delivered",t)}async reject(e,t){return this.update(e,{status:"Rejected",rejection_reason:t})}async getSummary(e){try{const t=await this.getAll(e),n=new Date().toISOString().split("T")[0],s={total:t.length,delivered:0,inProgress:0,notStarted:0,overdue:0,dueThisWeek:0},o=new Date;o.setDate(o.getDate()+7);const a=o.toISOString().split("T")[0];return t.forEach(l=>{l.status==="Delivered"?s.delivered++:l.status==="In Progress"?(s.inProgress++,l.due_date<n?s.overdue++:l.due_date<=a&&s.dueThisWeek++):(l.status==="Not Started"||l.status==="Draft")&&(s.notStarted++,l.due_date<n&&s.overdue++)}),s}catch(t){throw t}}async getAllWithRelations(e,t=!1){try{let n=this.supabase.from("deliverables").select(`
          *,
          milestone:milestones(milestone_ref, name),
          assigned_user:profiles!deliverables_assigned_to_fkey(full_name),
          creator:profiles!deliverables_created_by_fkey(full_name)
        `).eq("project_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("deliverable_ref");t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:o}=await n;if(o)throw o;return s||[]}catch(n){throw n}}async syncKPILinks(e,t=[]){try{const{error:n}=await this.supabase.from("deliverable_kpis").delete().eq("deliverable_id",e);if(n)throw n;if(t.length>0){const s=t.map(a=>({deliverable_id:e,kpi_id:a})),{error:o}=await this.supabase.from("deliverable_kpis").insert(s);if(o)throw o}return!0}catch(n){throw n}}async syncQSLinks(e,t=[]){try{const{error:n}=await this.supabase.from("deliverable_quality_standards").delete().eq("deliverable_id",e);if(n)throw n;if(t.length>0){const s=t.map(a=>({deliverable_id:e,quality_standard_id:a})),{error:o}=await this.supabase.from("deliverable_quality_standards").insert(s);if(o)throw o}return!0}catch(n){throw n}}async upsertKPIAssessments(e,t,n){try{const s=t.map(a=>({deliverable_id:e,kpi_id:a.kpiId,criteria_met:a.criteriaMet,assessed_at:new Date().toISOString(),assessed_by:n})),{error:o}=await this.supabase.from("deliverable_kpi_assessments").upsert(s,{onConflict:"deliverable_id,kpi_id"});if(o)throw o;return!0}catch(s){throw s}}async upsertQSAssessments(e,t,n){try{const s=t.map(a=>({deliverable_id:e,quality_standard_id:a.qsId,criteria_met:a.criteriaMet,assessed_at:new Date().toISOString(),assessed_by:n})),{error:o}=await this.supabase.from("deliverable_qs_assessments").upsert(s,{onConflict:"deliverable_id,quality_standard_id"});if(o)throw o;return!0}catch(s){throw s}}}const eu=new Zc;class tu extends Me{constructor(){super("kpis")}async getAllWithStatus(e){try{return(await this.getAll(e,{orderBy:{column:"name",ascending:!0}})).map(n=>({...n,rag_status:this.calculateRAG(n)}))}catch(t){throw t}}calculateRAG(e){if(!e.target_value||e.actual_value===null||e.actual_value===void 0)return"Unknown";const t=parseFloat(e.actual_value),n=parseFloat(e.target_value),s=parseFloat(e.threshold_amber||10);return e.trend==="higher_better"?t>=n?"Green":t>=n*(1-s/100)?"Amber":"Red":t<=n?"Green":t<=n*(1+s/100)?"Amber":"Red"}async getByRAGStatus(e,t){try{return(await this.getAllWithStatus(e)).filter(s=>s.rag_status===t)}catch(n){throw n}}async getNeedingAttention(e){try{return(await this.getAllWithStatus(e)).filter(n=>n.rag_status==="Amber"||n.rag_status==="Red")}catch(t){throw t}}async updateActualValue(e,t){return this.update(e,{actual_value:t,last_updated:new Date().toISOString()})}async getHistory(e,t=12){try{const{data:n,error:s}=await j.from("kpi_history").select("*").eq("kpi_id",e).order("recorded_at",{ascending:!1}).limit(t);if(s)throw s;return n||[]}catch{return[]}}async getSummary(e){try{const t=await this.getAllWithStatus(e);return{total:t.length,green:t.filter(n=>n.rag_status==="Green").length,amber:t.filter(n=>n.rag_status==="Amber").length,red:t.filter(n=>n.rag_status==="Red").length,unknown:t.filter(n=>n.rag_status==="Unknown").length}}catch(t){throw t}}async getAssessments(e){try{const{data:t,error:n}=await j.from("deliverable_kpi_assessments").select("kpi_id, criteria_met").eq("project_id",e);if(n)throw n;return t||[]}catch(t){throw t}}}const ru=new tu;class nu extends Me{constructor(){super("quality_standards")}async getAllWithStatus(e){try{return(await this.getAll(e,{orderBy:{column:"name",ascending:!0}})).map(n=>({...n,compliance_status:this.calculateCompliance(n)}))}catch(t){throw t}}calculateCompliance(e){if(e.actual_value===null||e.actual_value===void 0)return"Not Measured";const t=parseFloat(e.actual_value),n=parseFloat(e.target_value||0);return t>=n?"Compliant":t>=n*.9?"Near Compliant":"Non-Compliant"}async getNonCompliant(e){try{return(await this.getAllWithStatus(e)).filter(n=>n.compliance_status==="Non-Compliant")}catch(t){throw t}}async updateMeasurement(e,t,n){return this.update(e,{actual_value:t,measurement_notes:n,last_measured:new Date().toISOString()})}async getSummary(e){try{const t=await this.getAllWithStatus(e);return{total:t.length,compliant:t.filter(n=>n.compliance_status==="Compliant").length,nearCompliant:t.filter(n=>n.compliance_status==="Near Compliant").length,nonCompliant:t.filter(n=>n.compliance_status==="Non-Compliant").length,notMeasured:t.filter(n=>n.compliance_status==="Not Measured").length}}catch(t){throw t}}}const su=new nu;class ou extends Me{constructor(){super("standards",{supportsSoftDelete:!1,sanitizeConfig:"standard"})}async getAll(e){return super.getAll(e,{orderBy:{column:"standard_ref",ascending:!0}})}async getByStatus(e,t){return super.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"standard_ref",ascending:!0}})}async getByCategory(e,t){return super.getAll(e,{filters:[{column:"category",operator:"eq",value:t}],orderBy:{column:"standard_ref",ascending:!0}})}async getSummary(e){try{const t=await this.getAll(e);return{total:t.length,completed:t.filter(n=>n.status==="Completed").length,inProgress:t.filter(n=>n.status==="In Progress").length,notStarted:t.filter(n=>!n.status||n.status==="Not Started").length}}catch(t){throw t}}}new ou;const iu={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!0,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!0,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:4,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:6,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:8,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!0,x:0,y:12,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!0,x:6,y:12,w:6,h:3,minW:4,minH:3,maxH:5}}},au={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!0,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!0,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:4,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:6,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:8,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!1,x:0,y:12,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!1,x:6,y:12,w:6,h:3,minW:4,minH:3,maxH:5}}},lu={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!1,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!1,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:2,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:4,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:6,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!0,x:0,y:10,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!0,x:6,y:10,w:6,h:3,minW:4,minH:3,maxH:5}}},Ts={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!1,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!1,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:2,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!1,x:0,y:4,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:4,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!1,x:0,y:8,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!1,x:6,y:8,w:6,h:3,minW:4,minH:3,maxH:5}}},lr={...Ts},As={"progress-hero":{id:"progress-hero",title:"Project Progress",description:"Overall project completion percentage",icon:"target",category:"overview"},"budget-summary":{id:"budget-summary",title:"Budget Overview",description:"Total budget and spend to date",icon:"dollar-sign",category:"financial"},"pmo-tracking":{id:"pmo-tracking",title:"PMO Cost Tracking",description:"PMO vs Non-PMO budget breakdown",icon:"briefcase",category:"financial"},"stats-grid":{id:"stats-grid",title:"Key Statistics",description:"Milestones, deliverables, resources, KPIs, and quality standards counts",icon:"bar-chart",category:"overview"},certificates:{id:"certificates",title:"Milestone Certificates",description:"Certificate signing status summary",icon:"file-check",category:"compliance"},"milestones-list":{id:"milestones-list",title:"Milestones",description:"Milestone status, progress, and spend by milestone",icon:"clock",category:"delivery"},"kpis-category":{id:"kpis-category",title:"KPIs by Category",description:"KPI performance grouped by category",icon:"trending-up",category:"performance"},"quality-standards":{id:"quality-standards",title:"Quality Standards",description:"Quality standard achievement summary",icon:"award",category:"compliance"}};function bt(r){if(!r)return lr;const e=r.toUpperCase();return e.includes("ADMIN")?iu:e.includes("SUPPLIER")&&e.includes("PM")?au:e.includes("CUSTOMER")&&e.includes("PM")?lu:e.includes("CONTRIBUTOR")?Ts:(e.includes("VIEWER"),lr)}const cr=bt;function cu(r){return Object.keys(As)}class uu{constructor(){this.tableName="dashboard_layouts"}async getLayout(e,t,n){try{const{data:s,error:o}=await j.from(this.tableName).select("layout_config").eq("user_id",e).eq("project_id",t).maybeSingle();if(o)throw o;return s?.layout_config?s.layout_config:cr(n)}catch{return cr(n)}}async saveLayout(e,t,n){try{const{data:s,error:o}=await j.from(this.tableName).upsert({user_id:e,project_id:t,layout_config:n,updated_at:new Date().toISOString()},{onConflict:"user_id,project_id"}).select().single();if(o)throw o;return s}catch(s){throw s}}async deleteLayout(e,t){try{const{error:n}=await j.from(this.tableName).delete().eq("user_id",e).eq("project_id",t);if(n)throw n}catch(n){throw n}}async resetToDefault(e,t,n){try{return await this.deleteLayout(e,t),cr(n)}catch(s){throw s}}}const ur=new uu;function du(r,e,t){const[n,s]=f.useState(null),[o,a]=f.useState(!0),[l,c]=f.useState(!1),[u,h]=f.useState(null),m=f.useCallback(async()=>{if(!r||!e){a(!1);return}try{a(!0);const p=await ur.getLayout(r,e);if(p)s(p);else{const b=bt(t);s(b)}}catch{const b=bt(t);s(b)}finally{a(!1)}},[r,e,t]),y=f.useCallback(async p=>{if(!(!r||!e||!p))try{c(!0),await ur.saveLayout(r,e,p),s(p),h(new Date)}catch(b){throw b}finally{c(!1)}},[r,e]),P=f.useCallback((p,b)=>{s(_=>_&&{..._,widgets:{..._.widgets,[p]:{..._.widgets[p],visible:b}}})},[]),M=f.useCallback(async p=>{const b={...n,widgets:{...n.widgets,...Object.entries(p).reduce((_,[x,R])=>(_[x]={...n.widgets[x],visible:R},_),{})}};await y(b)},[n,y]),w=f.useCallback(p=>{if(!n)return;const b={...n.widgets};p.forEach(x=>{b[x.i]&&(b[x.i]={...b[x.i],x:x.x,y:x.y,w:x.w,h:x.h})});const _={...n,widgets:b};s(_)},[n]),E=f.useCallback(async p=>{if(!n)return;const b={...n.widgets};p.forEach(x=>{b[x.i]&&(b[x.i]={...b[x.i],x:x.x,y:x.y,w:x.w,h:x.h})});const _={...n,widgets:b};await y(_)},[n,y]),S=f.useCallback(async()=>{if(!(!r||!e))try{c(!0),await ur.deleteLayout(r,e);const p=bt(t);s(p),h(new Date)}catch(p){throw p}finally{c(!1)}},[r,e,t]),D=f.useCallback(p=>!n||!n.widgets?!0:n.widgets[p]?.visible!==!1,[n]),v=f.useCallback(()=>!n||!n.widgets?[]:Object.entries(n.widgets).filter(([p,b])=>b.visible!==!1).map(([p,b])=>({i:p,x:b.x||0,y:b.y||0,w:b.w||12,h:b.h||2,minW:b.minW,minH:b.minH,maxH:b.maxH})),[n]),g=f.useCallback(p=>!n||!n.widgets?null:n.widgets[p],[n]);return f.useEffect(()=>{m()},[m]),{layout:n,loading:o,saving:l,lastSaved:u,updateVisibility:P,bulkUpdateVisibility:M,updateLayoutPositions:w,saveLayoutPositions:E,resetToDefault:S,isWidgetVisible:D,getGridLayout:v,getWidgetConfig:g}}function fu({isOpen:r,onClose:e,layout:t,role:n,onUpdateVisibility:s,onReset:o,saving:a,lastSaved:l}){const[c,u]=f.useState({}),[h,m]=f.useState(!1),y=cu(),P=g=>c.hasOwnProperty(g)?c[g]:t?.widgets?.[g]?.visible!==!1,M=g=>{u(p=>({...p,[g]:!P(g)}))},w=async()=>{if(Object.keys(c).length===0){e();return}try{await s(c),u({}),e()}catch{}},E=()=>{u({}),e()},S=async()=>{try{await o(),u({}),m(!1)}catch{}};if(!r)return null;const D=y.filter(g=>P(g)).length,v=Object.keys(c).length>0;return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"dashboard-customize-backdrop",onClick:E,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999,opacity:r?1:0,transition:"opacity 0.3s ease"}}),i.jsxs("div",{className:"dashboard-customize-panel",style:{position:"fixed",top:0,right:r?0:"-400px",bottom:0,width:"400px",maxWidth:"90vw",backgroundColor:"white",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.15)",zIndex:1e3,display:"flex",flexDirection:"column",transition:"right 0.3s ease"},children:[i.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"600"},children:"Customize Dashboard"}),i.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.875rem",color:"#64748b"},children:[D," of ",y.length," widgets visible"]})]}),i.jsx("button",{onClick:E,style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",color:"#64748b",borderRadius:"4px"},onMouseEnter:g=>g.target.style.backgroundColor="#f1f5f9",onMouseLeave:g=>g.target.style.backgroundColor="transparent",children:i.jsx(Ze,{size:20})})]}),i.jsx("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:i.jsxs("div",{style:{marginBottom:"1rem"},children:[i.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Available Widgets"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:y.map(g=>{const p=As[g],b=P(g),_=c.hasOwnProperty(g);return i.jsx("div",{onClick:()=>M(g),style:{padding:"1rem",border:"1px solid #e2e8f0",borderRadius:"8px",cursor:"pointer",backgroundColor:b?"#f0f9ff":"white",borderColor:b?"#3b82f6":"#e2e8f0",transition:"all 0.2s ease",position:"relative"},onMouseEnter:x=>{b||(x.target.style.backgroundColor="#f8fafc")},onMouseLeave:x=>{b||(x.target.style.backgroundColor="white")},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:b?"#3b82f6":"#e2e8f0",display:"flex",alignItems:"center",justifyContent:"center",color:b?"white":"#64748b",flexShrink:0},children:b?i.jsx(Do,{size:20}):i.jsx(Mo,{size:20})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontWeight:"500",fontSize:"0.9375rem",marginBottom:"0.125rem",color:b?"#1e293b":"#64748b"},children:p.title}),i.jsx("div",{style:{fontSize:"0.8125rem",color:"#64748b"},children:p.description})]}),_&&i.jsx("div",{style:{position:"absolute",top:"0.5rem",right:"0.5rem",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b"}})]})},g)})})]})}),i.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l&&!v&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.8125rem",color:"#10b981"},children:[i.jsx(Mn,{size:16}),"Saved ",new Date(l).toLocaleTimeString()]}),i.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:h?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>m(!1),style:{flex:1,padding:"0.625rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{onClick:S,disabled:a,style:{flex:1,padding:"0.625rem",border:"none",borderRadius:"6px",backgroundColor:"#ef4444",color:"white",fontSize:"0.875rem",fontWeight:"500",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Resetting...":"Confirm Reset"})]}):i.jsxs("button",{onClick:()=>m(!0),style:{flex:1,padding:"0.625rem 1rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},onMouseEnter:g=>{g.target.style.backgroundColor="#f8fafc",g.target.style.borderColor="#cbd5e1"},onMouseLeave:g=>{g.target.style.backgroundColor="white",g.target.style.borderColor="#e2e8f0"},children:[i.jsx(zn,{size:16}),"Reset to Default"]})}),i.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[i.jsx("button",{onClick:E,style:{flex:1,padding:"0.625rem 1rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},onMouseEnter:g=>{g.target.style.backgroundColor="#f8fafc"},onMouseLeave:g=>{g.target.style.backgroundColor="white"},children:"Cancel"}),i.jsx("button",{onClick:w,disabled:a||!v,style:{flex:1,padding:"0.625rem 1rem",border:"none",borderRadius:"6px",backgroundColor:v?"#3b82f6":"#94a3b8",color:"white",fontSize:"0.875rem",fontWeight:"500",cursor:a||!v?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:a?"Saving...":i.jsxs(i.Fragment,{children:[i.jsx(Oo,{size:16}),"Apply Changes"]})})]})]})]})]})}const hu=jn.WidthProvider(jn.Responsive);function Rn(r){if(!r)return!1;const e=r.toLowerCase();return e.includes("pmo")||e.includes("project manager")}function pu(){const{showTestUsers:r,testUserIds:e}=mi(),{projectId:t,projectName:n,projectRef:s}=Hn(),{user:o,role:a}=Dt(),{layout:l,loading:c,saving:u,lastSaved:h,bulkUpdateVisibility:m,saveLayoutPositions:y,resetToDefault:P,getGridLayout:M}=du(o?.id,t,a),[w,E]=f.useState(!1),[S,D]=f.useState(!0),[v,g]=f.useState({totalMilestones:0,completedMilestones:0,totalDeliverables:0,deliveredCount:0,totalResources:0,totalKPIs:0,achievedKPIs:0,totalQS:0,achievedQS:0,totalBudget:0,spendToDate:0}),[p,b]=f.useState({signed:0,pending:0,awaitingGeneration:0}),[_,x]=f.useState({pmoBudget:0,pmoSpend:0,nonPmoBudget:0,nonPmoSpend:0,pmoResources:[],nonPmoResources:[]}),[R,z]=f.useState([]),[ee,A]=f.useState({}),[K,oe]=f.useState({}),[Oe,k]=f.useState([]),[G,be]=f.useState(0),he=f.useRef(null),ke=f.useCallback(async()=>{if(t){D(!0);try{const le=await Jc.getAll(t,{orderBy:{column:"milestone_ref",ascending:!0}});z(le);const V=await eu.getSummary(t),te=await ru.getAll(t,{orderBy:{column:"kpi_ref",ascending:!0}}),C=await su.getAll(t,{orderBy:{column:"qs_ref",ascending:!0}});k(C);const{data:O}=await j.from("resources").select("*"),T=await Yc.getAllFiltered(t,r);let W=0,U=0;const J=[],ie=[];O&&O.forEach(B=>{const xe=(B.daily_rate||0)*(B.days_allocated||0);Rn(B.role)?(W+=xe,J.push({name:B.name,role:B.role,budget:xe})):(U+=xe,ie.push({name:B.name,role:B.role,budget:xe}))});const ue={};let Z=0,ve=0,Y=0;T&&O&&T.forEach(B=>{if(!(B.status==="Approved"||B.status==="Submitted"&&!B.was_rejected))return;const Ys=parseFloat(B.hours_worked||B.hours||0),Yt=B.resources||O.find(Ve=>Ve.id===B.resource_id);if(Yt){const Ve=Ys/8*(Yt.daily_rate||0);B.milestone_id&&(ue[B.milestone_id]=(ue[B.milestone_id]||0)+Ve),Z+=Ve,Rn(Yt.role)?ve+=Ve:Y+=Ve}}),A(ue),x({pmoBudget:W,pmoSpend:ve,nonPmoBudget:U,nonPmoSpend:Y,pmoResources:J,nonPmoResources:ie});const X={};te.forEach(B=>{const xe=B.category||"Other";X[xe]||(X[xe]=[]),X[xe].push(B)}),oe(X);const ge=le.length,tt=le.filter(B=>B.status==="Completed").length,dt=V.total,Se=V.delivered,Ls=O?.length||0,qs=te.length,Ws=te.filter(B=>(B.current_value||0)>=(B.target||90)).length,Bs=C.length,Hs=C.filter(B=>(B.current_value||0)>=(B.target||100)).length,{data:Vt}=await j.from("milestone_certificates").select("*").eq("project_id",t),$s=Vt?.filter(B=>B.status==="Signed").length||0,Us=Vt?.filter(B=>B.status==="Pending Customer Signature"||B.status==="Pending Supplier Signature").length||0,Fs=Math.max(0,tt-(Vt?.length||0));b({signed:$s,pending:Us,awaitingGeneration:Fs});const Gs=le.reduce((B,xe)=>B+(xe.budget||0),0),Vs=ge>0?Math.round(le.reduce((B,xe)=>B+(xe.progress||0),0)/ge):0;be(Vs),g({totalMilestones:ge,completedMilestones:tt,totalDeliverables:dt,deliveredCount:Se,totalResources:Ls,totalKPIs:qs,achievedKPIs:Ws,totalQS:Bs,achievedQS:Hs,totalBudget:Gs,spendToDate:Z})}catch{}finally{D(!1)}}},[t,r]);f.useEffect(()=>{ke()},[ke]);function Ie(le){switch(le){case"Time Performance":return"#3b82f6";case"Quality of Collaboration":return"#8b5cf6";case"Delivery Performance":return"#10b981";default:return"#64748b"}}const Ne=f.useCallback(le=>{he.current&&clearTimeout(he.current),he.current=setTimeout(()=>{y(le)},1e3)},[y]),I=le=>{switch(le){case"progress-hero":return i.jsx("div",{className:"card",style:{height:"100%",background:"linear-gradient(135deg, #1e3a5f 0%, #2563eb 100%)",color:"white",display:"flex",alignItems:"center"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[i.jsxs("div",{children:[i.jsxs("h2",{style:{fontSize:"2.5rem",fontWeight:"700",margin:0},children:[G,"%"]}),i.jsx("p",{style:{opacity:.9,margin:0},children:"Overall Progress"})]}),i.jsx("div",{style:{width:"120px",height:"120px",position:"relative"},children:i.jsxs("svg",{viewBox:"0 0 100 100",style:{transform:"rotate(-90deg)"},children:[i.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"10"}),i.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"white",strokeWidth:"10",strokeDasharray:`${G*2.51} 251`,strokeLinecap:"round"})]})})]})});case"budget-summary":return i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",height:"100%"},children:[i.jsx("div",{className:"card",style:{borderLeft:"4px solid #3b82f6",height:"100%"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b",marginBottom:"0.25rem"},children:"Total Budget"}),i.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#3b82f6"},children:["£",v.totalBudget.toLocaleString()]})]}),i.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#dbeafe",borderRadius:"8px"},children:i.jsx(zo,{size:24,style:{color:"#3b82f6"}})})]})}),i.jsx("div",{className:"card",style:{borderLeft:"4px solid #10b981",height:"100%"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b",marginBottom:"0.25rem"},children:"Spend to Date"}),i.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#10b981"},children:["£",Math.round(v.spendToDate).toLocaleString()]}),i.jsxs("div",{style:{fontSize:"0.85rem",color:"#64748b"},children:[v.totalBudget>0?Math.round(v.spendToDate/v.totalBudget*100):0,"% of budget"]})]}),i.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#dcfce7",borderRadius:"8px"},children:i.jsx(yt,{size:24,style:{color:"#10b981"}})})]})})]});case"pmo-tracking":return i.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[i.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx(Io,{size:20})," PMO Cost Tracking"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.75rem",marginBottom:"1rem"},children:[i.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#fef3c7",borderRadius:"8px",borderLeft:"4px solid #f59e0b"},children:[i.jsx("div",{style:{fontSize:"0.75rem",color:"#92400e",marginBottom:"0.25rem"},children:"PMO Budget"}),i.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#d97706"},children:["£",Math.round(_.pmoBudget/1e3),"k"]})]}),i.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#ffedd5",borderRadius:"8px",borderLeft:"4px solid #ea580c"},children:[i.jsx("div",{style:{fontSize:"0.75rem",color:"#9a3412",marginBottom:"0.25rem"},children:"PMO Spend"}),i.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#ea580c"},children:["£",Math.round(_.pmoSpend/1e3),"k"]})]}),i.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#dbeafe",borderRadius:"8px",borderLeft:"4px solid #3b82f6"},children:[i.jsx("div",{style:{fontSize:"0.75rem",color:"#1e40af",marginBottom:"0.25rem"},children:"Non-PMO Budget"}),i.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#2563eb"},children:["£",Math.round(_.nonPmoBudget/1e3),"k"]})]}),i.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#dcfce7",borderRadius:"8px",borderLeft:"4px solid #16a34a"},children:[i.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"Non-PMO Spend"}),i.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#16a34a"},children:["£",Math.round(_.nonPmoSpend/1e3),"k"]})]})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[i.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500"},children:"Spend Distribution"}),i.jsxs("span",{style:{fontSize:"0.85rem",color:"#64748b"},children:["PMO: ",v.spendToDate>0?Math.round(_.pmoSpend/v.spendToDate*100):0,"% | Non-PMO: ",v.spendToDate>0?Math.round(_.nonPmoSpend/v.spendToDate*100):0,"%"]})]}),i.jsxs("div",{style:{display:"flex",height:"24px",borderRadius:"4px",overflow:"hidden",backgroundColor:"#e2e8f0"},children:[i.jsx("div",{style:{width:`${v.spendToDate>0?_.pmoSpend/v.spendToDate*100:0}%`,backgroundColor:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.75rem",fontWeight:"600",minWidth:_.pmoSpend>0?"40px":"0"},children:_.pmoSpend>0&&"PMO"}),i.jsx("div",{style:{width:`${v.spendToDate>0?_.nonPmoSpend/v.spendToDate*100:0}%`,backgroundColor:"#3b82f6",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.75rem",fontWeight:"600",minWidth:_.nonPmoSpend>0?"60px":"0"},children:_.nonPmoSpend>0&&"Non-PMO"})]})]})]});case"stats-grid":return i.jsxs("div",{style:{height:"100%",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem"},children:[i.jsx(ft,{icon:at,label:"Milestones",value:`${v.completedMilestones} / ${v.totalMilestones}`,subtext:`${v.totalMilestones>0?Math.round(v.completedMilestones/v.totalMilestones*100):0}% Complete`,color:"#3b82f6"}),i.jsx(ft,{icon:hr,label:"Deliverables",value:`${v.deliveredCount} / ${v.totalDeliverables}`,subtext:`${v.totalDeliverables>0?Math.round(v.deliveredCount/v.totalDeliverables*100):0}% Delivered`,color:"#10b981"}),i.jsx(ft,{icon:yt,label:"KPIs",value:`${v.achievedKPIs} / ${v.totalKPIs}`,subtext:`${v.totalKPIs>0?Math.round(v.achievedKPIs/v.totalKPIs*100):0}% Achieved`,color:"#3b82f6"}),i.jsx(ft,{icon:vt,label:"Quality Standards",value:`${v.achievedQS} / ${v.totalQS}`,subtext:`${v.totalQS>0?Math.round(v.achievedQS/v.totalQS*100):0}% Achieved`,color:"#8b5cf6"})]});case"certificates":return i.jsx("div",{className:"card",style:{height:"100%",backgroundColor:"#fefce8",borderLeft:"4px solid #eab308"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"1rem"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[i.jsx(ko,{size:28,style:{color:"#ca8a04"}}),i.jsx("div",{children:i.jsx("h4",{style:{margin:0,color:"#854d0e"},children:"Milestone Certificates"})})]}),i.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#16a34a"},children:p.signed}),i.jsx("div",{style:{fontSize:"0.8rem",color:"#166534"},children:"Signed"})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#d97706"},children:p.pending}),i.jsx("div",{style:{fontSize:"0.8rem",color:"#92400e"},children:"Pending"})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:p.awaitingGeneration>0?"#dc2626":"#64748b"},children:p.awaitingGeneration}),i.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:"Awaiting"})]})]}),i.jsx(Le,{to:"/milestones",style:{padding:"0.5rem 1rem",backgroundColor:"#ca8a04",color:"white",textDecoration:"none",borderRadius:"6px",fontWeight:"500"},children:"View →"})]})});case"milestones-list":return i.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"0.5rem"},children:"Billable vs Spend by Milestone"}),i.jsxs("div",{style:{display:"flex",gap:"0.25rem",marginBottom:"1rem"},children:[i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",marginRight:"1rem"},children:[i.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:"#3b82f6",borderRadius:"2px"}}),"Billable"]}),i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem"},children:[i.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:"#10b981",borderRadius:"2px"}}),"Spend"]})]}),i.jsx("div",{style:{display:"flex",gap:"0.5rem",height:"calc(100% - 80px)",alignItems:"flex-end"},children:R.map(V=>{const te=Math.max(...R.map(W=>W.budget||0)),C=ee[V.id]||0,O=te>0?(V.budget||0)/te*100:0,T=te>0?C/te*100:0;return i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("div",{style:{display:"flex",gap:"2px",alignItems:"flex-end",height:"100%",width:"100%",justifyContent:"center"},children:[i.jsx("div",{style:{width:"45%",height:`${O}%`,backgroundColor:"#3b82f6",borderRadius:"4px 4px 0 0",minHeight:V.budget>0?"20px":"0",position:"relative"},title:`Billable: £${(V.budget||0).toLocaleString()}`,children:O>15&&i.jsxs("span",{style:{position:"absolute",top:"4px",left:"50%",transform:"translateX(-50%)",fontSize:"0.65rem",fontWeight:"600",color:"white"},children:["£",Math.round((V.budget||0)/1e3),"k"]})}),i.jsx("div",{style:{width:"45%",height:`${T}%`,backgroundColor:"#10b981",borderRadius:"4px 4px 0 0",minHeight:C>0?"20px":"0",position:"relative"},title:`Spend: £${Math.round(C).toLocaleString()}`,children:T>15&&i.jsxs("span",{style:{position:"absolute",top:"4px",left:"50%",transform:"translateX(-50%)",fontSize:"0.65rem",fontWeight:"600",color:"white"},children:["£",Math.round(C/1e3),"k"]})})]}),i.jsx("span",{style:{fontSize:"0.7rem",fontWeight:"600",color:"#64748b"},children:V.milestone_ref})]},V.id)})})]});case"kpis-category":return i.jsxs("div",{className:"card",style:{height:"100%"},children:[i.jsx("h3",{style:{marginBottom:"1rem"},children:"KPI Performance"}),i.jsx("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end",height:"calc(100% - 50px)"},children:Object.entries(K).map(([V,te])=>{const C=te.length,O=te.filter(W=>(W.current_value||0)>=(W.target||90)).length,T=C>0?O/C*100:0;return i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem",height:"100%"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[i.jsx("div",{style:{height:`${100-T}%`,backgroundColor:"#e2e8f0",borderRadius:T>0?"4px 4px 0 0":"4px"}}),i.jsxs("div",{style:{height:`${T}%`,backgroundColor:Ie(V),borderRadius:T<100?"0 0 4px 4px":"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"700"},children:[O,"/",C]})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:"600",fontSize:"0.75rem"},children:V.split(" ")[0]}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:[Math.round(T),"%"]})]})]},V)})})]});case"quality-standards":return i.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"1rem"},children:"Quality Standards"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Oe.map(V=>{const te=V.current_value||0,C=te>=(V.target||100);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[i.jsx("span",{style:{fontFamily:"monospace",fontWeight:"600",minWidth:"45px",color:"#8b5cf6"},children:V.qs_ref}),i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{height:"8px",backgroundColor:"#e2e8f0",borderRadius:"4px",overflow:"hidden"},children:i.jsx("div",{style:{width:`${te}%`,height:"100%",backgroundColor:C?"#10b981":"#8b5cf6"}})})}),i.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:"600",minWidth:"45px",color:C?"#10b981":"#64748b"},children:[te,"%"]})]},V.id)})})]});default:return null}};if(S||c)return i.jsx(Dr,{message:"Loading dashboard...",size:"large",fullPage:!0});const ae=M();return i.jsxs("div",{className:"page-container",children:[i.jsx(ji,{icon:en,title:`${s||"Project"} Dashboard`,subtitle:n||"Project Tracker",children:i.jsxs("button",{onClick:()=>E(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem"},children:[i.jsx(In,{size:18}),"Customize"]})}),i.jsx(hu,{className:"layout",layouts:{lg:ae},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:100,onLayoutChange:Ne,draggableHandle:".drag-handle",margin:[16,16],containerPadding:[0,0],children:ae.map(le=>i.jsxs("div",{style:{position:"relative"},children:[i.jsx("div",{className:"drag-handle",style:{position:"absolute",top:"8px",right:"8px",width:"24px",height:"24px",cursor:"move",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},title:"Drag to move",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[i.jsx("circle",{cx:"4",cy:"4",r:"1.5",fill:"#64748b"}),i.jsx("circle",{cx:"12",cy:"4",r:"1.5",fill:"#64748b"}),i.jsx("circle",{cx:"4",cy:"8",r:"1.5",fill:"#64748b"}),i.jsx("circle",{cx:"12",cy:"8",r:"1.5",fill:"#64748b"}),i.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"#64748b"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"#64748b"})]})}),I(le.i)]},le.i))}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginTop:"2rem"},children:[i.jsxs(Le,{to:"/milestones",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[i.jsx(at,{size:32,style:{color:"#3b82f6",marginBottom:"0.5rem"}}),i.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Milestones"})]}),i.jsxs(Le,{to:"/deliverables",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[i.jsx(hr,{size:32,style:{color:"#10b981",marginBottom:"0.5rem"}}),i.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Deliverables"})]}),i.jsxs(Le,{to:"/kpis",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[i.jsx(yt,{size:32,style:{color:"#3b82f6",marginBottom:"0.5rem"}}),i.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"KPIs"})]}),i.jsxs(Le,{to:"/quality-standards",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[i.jsx(vt,{size:32,style:{color:"#8b5cf6",marginBottom:"0.5rem"}}),i.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Quality"})]}),i.jsxs(Le,{to:"/reports",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[i.jsx(en,{size:32,style:{color:"#f59e0b",marginBottom:"0.5rem"}}),i.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Reports"})]})]}),i.jsx(fu,{isOpen:w,onClose:()=>E(!1),layout:l,role:a,onUpdateVisibility:m,onReset:P,saving:u,lastSaved:h})]})}const mu=f.lazy(()=>ne(()=>import("./ResetPassword-DyZjW1KT.js"),__vite__mapDeps([0,1,2,3,4]))),gu=f.lazy(()=>ne(()=>import("./Milestones-HCnu7lkZ.js"),__vite__mapDeps([5,1,6,7,2,3,4]))),yu=f.lazy(()=>ne(()=>import("./MilestoneDetail-D2w-Q2BE.js"),__vite__mapDeps([8,1,2,3,4]))),bu=f.lazy(()=>ne(()=>import("./Gantt-Dl-gBpXo.js"),__vite__mapDeps([9,1,6,2,3,4]))),vu=f.lazy(()=>ne(()=>import("./Deliverables-DvbNGen6.js"),__vite__mapDeps([10,1,6,2,3,4]))),xu=f.lazy(()=>ne(()=>import("./Resources-CDmOVNmp.js"),__vite__mapDeps([11,1,6,7,2,3,4]))),wu=f.lazy(()=>ne(()=>import("./ResourceDetail-BUnrAezW.js"),__vite__mapDeps([12,1,6,2,3,4]))),_u=f.lazy(()=>ne(()=>import("./Partners-sBmHA7gT.js"),__vite__mapDeps([13,1,6,7,2,3,4]))),Su=f.lazy(()=>ne(()=>import("./PartnerDetail-3j4oiCuu.js"),__vite__mapDeps([14,1,6,2,3,4]))),ju=f.lazy(()=>ne(()=>import("./Timesheets-DnBgBFCX.js"),__vite__mapDeps([15,1,6,7,2,3,4]))),Pu=f.lazy(()=>ne(()=>import("./Expenses-t3b4yu2L.js"),__vite__mapDeps([16,1,6,7,2,3,4,17]))),Ru=f.lazy(()=>ne(()=>import("./KPIs-CpKEac_s.js"),__vite__mapDeps([18,1,6,7,2,3,4]))),Eu=f.lazy(()=>ne(()=>import("./KPIDetail-BSE7gtcV.js"),__vite__mapDeps([19,1,6,2,3,4]))),Cu=f.lazy(()=>ne(()=>import("./QualityStandards-xCQRewkx.js"),__vite__mapDeps([20,1,6,7,2,3,4]))),Du=f.lazy(()=>ne(()=>import("./QualityStandardDetail-j3D0u4E3.js"),__vite__mapDeps([21,1,2,3,4]))),Mu=f.lazy(()=>ne(()=>import("./Reports-CD0O9MHS.js"),__vite__mapDeps([22,2,1,3,4]))),Ou=f.lazy(()=>ne(()=>import("./Users-CsI26eqj.js"),__vite__mapDeps([23,1,2,3,4]))),ku=f.lazy(()=>ne(()=>import("./Settings-B3R6ihIm.js"),__vite__mapDeps([24,1,6,2,3,4]))),Iu=f.lazy(()=>ne(()=>import("./AccountSettings-LTpLHwAN.js"),__vite__mapDeps([25,1,2,3,4]))),zu=f.lazy(()=>ne(()=>import("./WorkflowSummary-BefKYOPp.js"),__vite__mapDeps([26,1,2,3,4]))),Nu=f.lazy(()=>ne(()=>import("./AuditLog-zHLqzqva.js"),__vite__mapDeps([27,1,2,3,4]))),Tu=f.lazy(()=>ne(()=>import("./DeletedItems-BuI3UNPJ.js"),__vite__mapDeps([28,1,7,2,3,4])));function Au(){return i.jsx("div",{className:"page-container",children:i.jsx(st,{type:"page"})})}function re({children:r}){const{user:e,isLoading:t}=Dt();return t?i.jsx(Dr,{message:"Loading...",size:"large",fullPage:!0}):e?i.jsx(fa,{children:i.jsx(f.Suspense,{fallback:i.jsx(Au,{}),children:r||i.jsx(no,{})})}):i.jsx(dr,{to:"/login",replace:!0})}function Lu(){return i.jsx(to,{children:i.jsx(xi,{children:i.jsx(Ci,{children:i.jsx(fi,{children:i.jsx(hi,{children:i.jsx(pi,{children:i.jsx(yi,{children:i.jsxs(bi,{children:[i.jsxs(ro,{children:[i.jsx(Q,{path:"/login",element:i.jsx(ha,{})}),i.jsx(Q,{path:"/reset-password",element:i.jsx(f.Suspense,{fallback:i.jsx(Dr,{fullPage:!0}),children:i.jsx(mu,{})})}),i.jsx(Q,{path:"/",element:i.jsx(dr,{to:"/dashboard",replace:!0})}),i.jsx(Q,{path:"/dashboard",element:i.jsx(re,{children:i.jsx(pu,{})})}),i.jsx(Q,{path:"/milestones",element:i.jsx(re,{children:i.jsx(gu,{})})}),i.jsx(Q,{path:"/milestones/:id",element:i.jsx(re,{children:i.jsx(yu,{})})}),i.jsx(Q,{path:"/gantt",element:i.jsx(re,{children:i.jsx(bu,{})})}),i.jsx(Q,{path:"/deliverables",element:i.jsx(re,{children:i.jsx(vu,{})})}),i.jsx(Q,{path:"/resources",element:i.jsx(re,{children:i.jsx(xu,{})})}),i.jsx(Q,{path:"/resources/:id",element:i.jsx(re,{children:i.jsx(wu,{})})}),i.jsx(Q,{path:"/partners",element:i.jsx(re,{children:i.jsx(_u,{})})}),i.jsx(Q,{path:"/partners/:id",element:i.jsx(re,{children:i.jsx(Su,{})})}),i.jsx(Q,{path:"/timesheets",element:i.jsx(re,{children:i.jsx(ju,{})})}),i.jsx(Q,{path:"/expenses",element:i.jsx(re,{children:i.jsx(Pu,{})})}),i.jsx(Q,{path:"/kpis",element:i.jsx(re,{children:i.jsx(Ru,{})})}),i.jsx(Q,{path:"/kpis/:id",element:i.jsx(re,{children:i.jsx(Eu,{})})}),i.jsx(Q,{path:"/quality-standards",element:i.jsx(re,{children:i.jsx(Cu,{})})}),i.jsx(Q,{path:"/quality-standards/:id",element:i.jsx(re,{children:i.jsx(Du,{})})}),i.jsx(Q,{path:"/reports",element:i.jsx(re,{children:i.jsx(Mu,{})})}),i.jsx(Q,{path:"/users",element:i.jsx(re,{children:i.jsx(Ou,{})})}),i.jsx(Q,{path:"/settings",element:i.jsx(re,{children:i.jsx(ku,{})})}),i.jsx(Q,{path:"/account",element:i.jsx(re,{children:i.jsx(Iu,{})})}),i.jsx(Q,{path:"/workflow-summary",element:i.jsx(re,{children:i.jsx(zu,{})})}),i.jsx(Q,{path:"/audit-log",element:i.jsx(re,{children:i.jsx(Nu,{})})}),i.jsx(Q,{path:"/deleted-items",element:i.jsx(re,{children:i.jsx(Tu,{})})}),i.jsx(Q,{path:"*",element:i.jsx(dr,{to:"/dashboard",replace:!0})})]}),i.jsx(Mi,{}),i.jsx(Jo,{}),i.jsx(ai,{})]})})})})})})})})}pr.createRoot(document.getElementById("root")).render(i.jsx(En.StrictMode,{children:i.jsx(Lu,{})}));export{Hi as $,Yi as A,dd as B,ud as C,cd as D,kt as E,Vi as F,Kn as G,ld as H,Gi as I,ad as J,id as K,Dr as L,Mr as M,od as N,sd as O,ji as P,nd as Q,Ot as R,ft as S,rd as T,td as U,ed as V,Mt as W,Zu as X,Ui as Y,Qu as Z,$i as _,Hn as a,Bi as a0,qi as a1,Li as a2,Ai as a3,Ti as a4,Ni as a5,zi as a6,Ii as a7,Yn as a8,Vn as a9,H as aa,vd as ab,d as ac,sa as ad,na as ae,xd as af,bd as ag,ra as ah,yd as ai,ta as aj,Ju as ak,Xu as al,Ku as am,Yu as an,Vu as ao,Gu as ap,Fu as aq,Qi as ar,Fi as as,Wi as at,Di as b,mi as c,eu as d,Pd as e,Uu as f,gd as g,md as h,Rd as i,i as j,ru as k,ea as l,Jc as m,Zi as n,Ji as o,Sd as p,su as q,jd as r,j as s,Yc as t,Dt as u,pd as v,hd as w,Xi as x,fd as y,Ki as z};
