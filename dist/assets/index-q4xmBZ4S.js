const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ResetPassword-sER4OhAx.js","assets/vendor-react-CaXNtsgv.js","assets/vendor-icons-cI_2Oee6.js","assets/vendor-supabase-qY1sfceY.js","assets/vendor-charts-_mIYJ_kN.js","assets/Milestones-Dx8XqXVv.js","assets/usePermissions-BfaGV8Gf.js","assets/ConfirmDialog-D2bhJG2y.js","assets/MilestoneDetail-DFkllmIr.js","assets/Gantt-CgQk36pX.js","assets/Deliverables-B6tPf3qz.js","assets/Resources-Qi60qZv7.js","assets/ResourceDetail-B09ec6t8.js","assets/Partners-lTf0gHFd.js","assets/PartnerDetail-B_vz0sJ2.js","assets/Timesheets-Du8wrTIo.js","assets/Expenses-DGKLL0Lk.js","assets/Expenses-OWLTi329.css","assets/KPIs-WRg1iOlO.js","assets/KPIDetail-fV7lHiXc.js","assets/QualityStandards-DLFFfN0N.js","assets/QualityStandardDetail-Cj70D-5R.js","assets/Reports-Ssob1pSn.js","assets/Users-B8C8iZnE.js","assets/Settings-CFkgeHke.js","assets/AccountSettings-DQsrv8ue.js","assets/WorkflowSummary-D6SNMKMF.js","assets/AuditLog-_turm5C7.js","assets/DeletedItems-CP1n6Q7e.js"])))=>i.map(i=>d[i]);
var Ks=Object.defineProperty;var Qs=(r,e,t)=>e in r?Ks(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Qt=(r,e,t)=>Qs(r,typeof e!="symbol"?e+"":e,t);import{r as u,a as kt,R as kn,u as kr,b as Js,L as qe,c as Zs,d as eo,g as to,B as ro,e as no,f as te,N as mr,O as so}from"./vendor-react-CaXNtsgv.js";import{c as oo}from"./vendor-supabase-qY1sfceY.js";import{A as zn,R as St,L as Mn,I as io,X as Tn,C as ao,a as Ve,M as lo,S as co,B as Jt,D as uo,T as fo,U as ho,b as po,c as zr,d as mo,e as go,f as yo,g as Zt,h as bo,i as jt,F as In,j as Nn,k as ut,l as vo,H as xo,m as Ln,n as wo,o as _o,p as So,q as wt,P as gr,r as jo,G as Ro,s as Co,t as Eo,u as Po,v as Do,w as An,x as Oo,K as ko,y as er,z as tr,E as zo,J as Mo,N as To,O as sn,Q as Io,V as No,W as Lo}from"./vendor-icons-cI_2Oee6.js";import{p as We,c as zt}from"./vendor-charts-_mIYJ_kN.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var qn={exports:{}},Mt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao=u,qo=Symbol.for("react.element"),Wo=Symbol.for("react.fragment"),$o=Object.prototype.hasOwnProperty,Bo=Ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ho={key:!0,ref:!0,__self:!0,__source:!0};function Wn(r,e,t){var n,s={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)$o.call(e,n)&&!Ho.hasOwnProperty(n)&&(s[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:qo,type:r,key:i,ref:a,props:s,_owner:Bo.current}}Mt.Fragment=Wo;Mt.jsx=Wn;Mt.jsxs=Wn;qn.exports=Mt;var o=qn.exports,yr={},on=kt;yr.createRoot=on.createRoot,yr.hydrateRoot=on.hydrateRoot;const Uo="modulepreload",Fo=function(r){return"/"+r},an={},le=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");s=Promise.allSettled(t.map(c=>{if(c=Fo(c),c in an)return;an[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Uo,d||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((g,S)=>{m.addEventListener("load",g),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};var ln={},Go="@vercel/analytics",Vo="1.6.0",Yo=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function $n(){return typeof window<"u"}function Bn(){try{const r="production"}catch{}return"production"}function Xo(r="auto"){if(r==="auto"){window.vam=Bn();return}window.vam=r}function Ko(){return($n()?window.vam:Bn())||"production"}function br(){return Ko()==="development"}function Qo(r){return r.scriptSrc?r.scriptSrc:br()?"https://va.vercel-scripts.com/v1/script.debug.js":r.basePath?`${r.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function Jo(r={debug:!0}){var e;if(!$n())return;Xo(r.mode),Yo(),r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend));const t=Qo(r);if(document.head.querySelector(`script[src*="${t}"]`))return;const n=document.createElement("script");n.src=t,n.defer=!0,n.dataset.sdkn=Go+(r.framework?`/${r.framework}`:""),n.dataset.sdkv=Vo,r.disableAutoTrack&&(n.dataset.disableAutoTrack="1"),r.endpoint?n.dataset.endpoint=r.endpoint:r.basePath&&(n.dataset.endpoint=`${r.basePath}/insights`),r.dsn&&(n.dataset.dsn=r.dsn),n.onerror=()=>{const s=br()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information."},br()&&r.debug===!1&&(n.dataset.debug="false"),document.head.appendChild(n)}function Zo({route:r,path:e}){var t;(t=window.va)==null||t.call(window,"pageview",{route:r,path:e})}function ei(){if(!(typeof process>"u"||typeof ln>"u"))return ln.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function ti(r){return u.useEffect(()=>{var e;r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend))},[r.beforeSend]),u.useEffect(()=>{Jo({framework:r.framework||"react",basePath:r.basePath??ei(),...r.route!==void 0&&{disableAutoTrack:!0},...r})},[]),u.useEffect(()=>{r.route&&r.path&&Zo({route:r.route,path:r.path})},[r.route,r.path]),null}var cn={},ri="@vercel/speed-insights",ni="1.2.0",si=()=>{window.si||(window.si=function(...e){(window.siq=window.siq||[]).push(e)})};function oi(){return typeof window<"u"}function ii(){try{const r="production"}catch{}return"production"}function Hn(){return ii()==="development"}function ai(r){return r.scriptSrc?r.scriptSrc:Hn()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":r.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":r.basePath?`${r.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function li(r={}){var e;if(!oi()||r.route===null)return null;si();const t=ai(r);if(document.head.querySelector(`script[src*="${t}"]`))return null;r.beforeSend&&((e=window.si)==null||e.call(window,"beforeSend",r.beforeSend));const n=document.createElement("script");return n.src=t,n.defer=!0,n.dataset.sdkn=ri+(r.framework?`/${r.framework}`:""),n.dataset.sdkv=ni,r.sampleRate&&(n.dataset.sampleRate=r.sampleRate.toString()),r.route&&(n.dataset.route=r.route),r.endpoint?n.dataset.endpoint=r.endpoint:r.basePath&&(n.dataset.endpoint=`${r.basePath}/speed-insights/vitals`),r.dsn&&(n.dataset.dsn=r.dsn),Hn()&&r.debug===!1&&(n.dataset.debug="false"),n.onerror=()=>{},document.head.appendChild(n),{setRoute:s=>{n.dataset.route=s??void 0}}}function ci(){if(!(typeof process>"u"||typeof cn>"u"))return cn.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function di(r){u.useEffect(()=>{var t;r.beforeSend&&((t=window.si)==null||t.call(window,"beforeSend",r.beforeSend))},[r.beforeSend]);const e=u.useRef(null);return u.useEffect(()=>{if(e.current)r.route&&e.current(r.route);else{const t=li({framework:r.framework??"react",basePath:r.basePath??ci(),...r});t&&(e.current=t.setRoute)}},[r.route]),null}const ui=void 0,fi=void 0;throw new Error("Missing Supabase environment variables");const x=oo(ui,fi),Un=u.createContext(null),hi=60*1e3,pi=5*60*1e3;function mi({children:r}){const[e,t]=u.useState(null),[n,s]=u.useState(null),[i,a]=u.useState(null),[l,c]=u.useState(!0),[d,h]=u.useState(null),[m,g]=u.useState(!1),S=u.useRef(null),k=u.useRef(Date.now()),R=u.useCallback(()=>{k.current=Date.now()},[]);async function E(v){if(!v){s(null),a(null);return}try{const{data:C,error:T}=await x.from("profiles").select("*").eq("id",v.id).single();if(T){h(T);return}s(C);const{data:L}=await x.from("resources").select("*").eq("user_id",v.id).maybeSingle();a(L),h(null)}catch(C){h(C)}}const w=u.useCallback(async()=>{try{const{data:{session:v},error:C}=await x.auth.getSession();if(C)return;if(!v){await D();return}const T=v.expires_at*1e3,L=Date.now(),I=T-L;if(I<=0)await D();else if(I<=pi){g(!0);const{data:Z,error:he}=await x.auth.refreshSession();he||!Z.session||g(!1)}else g(!1)}catch{}},[]);async function D(){t(null),s(null),a(null),g(!1),await x.auth.signOut();const v=window.location.pathname;v!=="/login"&&v!=="/register"&&(window.location.href="/login?expired=true")}const b=u.useCallback(()=>{S.current&&clearInterval(S.current),S.current=setInterval(()=>{w()},hi);const v=()=>{document.visibilityState==="visible"&&w()};document.addEventListener("visibilitychange",v);const C=["mousedown","keydown","touchstart","scroll"];return C.forEach(T=>{document.addEventListener(T,R,{passive:!0})}),()=>{S.current&&clearInterval(S.current),document.removeEventListener("visibilitychange",v),C.forEach(T=>{document.removeEventListener(T,R)})}},[w,R]);u.useEffect(()=>{let v=!0,C=null;async function T(){try{const{data:{session:I},error:Z}=await x.auth.getSession();Z&&v&&h(Z),v&&(t(I?.user??null),c(!1),I?.user&&(E(I.user),C=b()))}catch(I){v&&(h(I),c(!1))}}T();const{data:{subscription:L}}=x.auth.onAuthStateChange(async(I,Z)=>{v&&(t(Z?.user??null),c(!1),Z?.user?(E(Z.user),C&&C(),C=b()):(s(null),a(null),C&&(C(),C=null)),(I==="SIGNED_OUT"||I==="TOKEN_REFRESHED")&&g(!1))});return()=>{v=!1,L.unsubscribe(),C&&C()}},[b]);async function p(){try{await x.auth.signOut(),t(null),s(null),a(null),g(!1)}catch(v){h(v)}}async function f(){e&&await E(e)}async function y(){try{const{data:v,error:C}=await x.auth.refreshSession();return C?!1:v.session?(g(!1),!0):!1}catch{return!1}}const _={user:e,profile:n,role:n?.role||"viewer",linkedResource:i,isLoading:l,error:d,signOut:p,refreshUserData:f,refreshSession:y,isAuthenticated:!!e,sessionExpiring:m};return o.jsx(Un.Provider,{value:_,children:r})}function Tt(){const r=u.useContext(Un);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r}const Fn=u.createContext(null);function gi({children:r}){const[e,t]=u.useState(null),[n,s]=u.useState(!0),[i,a]=u.useState(null);u.useEffect(()=>{let h=!0;async function m(){try{const{data:g,error:S}=await x.from("projects").select("*").eq("reference","AMSF001").single();S?h&&a(S):h&&(t(g),a(null))}catch(g){h&&a(g)}finally{h&&s(!1)}}return m(),()=>{h=!1}},[]);async function l(h){s(!0),a(null);try{const{data:m,error:g}=await x.from("projects").select("*").eq("reference",h).single();g?a(g):t(m)}catch(m){a(m)}finally{s(!1)}}async function c(){if(e)try{const{data:h,error:m}=await x.from("projects").select("*").eq("id",e.id).single();m?a(m):t(h)}catch(h){a(h)}}const d={currentProject:e,projectId:e?.id||null,projectRef:e?.reference||null,projectName:e?.name||null,isLoading:n,error:i,switchProject:l,refreshProject:c};return o.jsx(Fn.Provider,{value:d,children:r})}function Gn(){const r=u.useContext(Fn);if(!r)throw new Error("useProject must be used within a ProjectProvider");return r}const Vn=u.createContext();function yi({children:r}){const[e,t]=u.useState(!1),[n,s]=u.useState(null),[i,a]=u.useState([]);u.useEffect(()=>{l(),c()},[]);async function l(){const{data:{user:R}}=await x.auth.getUser();if(R){const{data:E}=await x.from("profiles").select("role").eq("id",R.id).single();E&&s(E.role)}}async function c(){const{data:R}=await x.from("profiles").select("id").eq("is_test_user",!0);R&&a(R.map(E=>E.id))}const d=n==="admin"||n==="supplier_pm";function h(){d&&t(R=>!R)}function m(R){return i.includes(R)}function g(R,E="user_id"){return!R||e?R:R.filter(w=>!i.includes(w[E]))}function S(R){return!R||e?R:R.filter(E=>!E.is_test_content)}const k={showTestUsers:e,setShowTestUsers:t,toggleTestUsers:h,canToggleTestUsers:d,testUserIds:i,isTestUser:m,filterTestContent:g,filterByTestFlag:S,userRole:n};return o.jsx(Vn.Provider,{value:k,children:r})}function bi(){const r=u.useContext(Vn);if(!r)throw new Error("useTestUsers must be used within a TestUserProvider");return r}const Yn=u.createContext();function vi(){return u.useContext(Yn)}function xi({children:r}){const[e,t]=u.useState([]),[n,s]=u.useState(0),[i,a]=u.useState(0),[l,c]=u.useState(!0),[d,h]=u.useState(null),[m,g]=u.useState(null),S=f=>["admin","supplier_pm","customer_pm"].includes(f),k=u.useCallback(async(f,y)=>{try{let _=[];if(S(y)){const{data:v}=await x.from("timesheets").select("id, hours_worked, hours, work_date, date").eq("status","Submitted"),{data:C}=await x.from("expenses").select("id, amount, category, reason, resource_name, chargeable_to_customer").eq("status","Submitted"),{data:T}=await x.from("deliverables").select("id, name, deliverable_ref").eq("status","Submitted"),{data:L}=await x.from("milestone_certificates").select("id, milestone_id").eq("status","Submitted");v&&v.forEach(I=>{_.push({id:`ts-${I.id}`,type:"timesheet",notification_type:"action",title:"Timesheet Submitted",message:`Timesheet (${I.hours_worked||I.hours||0}h) pending approval`,action_url:"/timesheets",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),C&&C.forEach(I=>{const Z=I.chargeable_to_customer!==!1;_.push({id:`exp-${I.id}`,type:"expense",notification_type:"action",title:"Expense Submitted",message:`${I.resource_name||"Unknown"} expense (Â£${parseFloat(I.amount||0).toFixed(2)}) pending validation`,action_url:"/expenses",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1,isChargeable:Z})}),T&&T.forEach(I=>{_.push({id:`del-${I.id}`,type:"deliverable",notification_type:"action",title:"Deliverable Submitted",message:`${I.deliverable_ref}: ${I.name} pending review`,action_url:"/deliverables",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),L&&L.forEach(I=>{_.push({id:`cert-${I.id}`,type:"certificate",notification_type:"action",title:"Certificate Submitted",message:"Milestone certificate pending approval",action_url:"/milestones",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})})}else{const{data:v}=await x.from("timesheets").select("id, hours_worked, hours, work_date, date, resource_id").eq("status","Submitted").eq("user_id",f),{data:C}=await x.from("expenses").select("id, amount, category, reason, resource_name").eq("status","Submitted").eq("created_by",f);v&&v.forEach(T=>{_.push({id:`ts-${T.id}`,type:"timesheet",notification_type:"action",title:"Timesheet Submitted",message:`Your timesheet for ${T.hours_worked||T.hours||0}h is pending approval`,action_url:"/timesheets",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})}),C&&C.forEach(T=>{_.push({id:`exp-${T.id}`,type:"expense",notification_type:"action",title:"Expense Submitted",message:`Your expense (Â£${parseFloat(T.amount||0).toFixed(2)}) is pending validation`,action_url:"/expenses",created_at:new Date().toISOString(),is_read:!1,is_actioned:!1})})}return{count:_.length,items:_}}catch{return{count:0,items:[]}}},[]),R=u.useCallback(async()=>{try{const{data:{user:f}}=await x.auth.getUser();if(!f){t([]),s(0),a(0),c(!1);return}h(f.id);const{data:y}=await x.from("profiles").select("role").eq("id",f.id).single(),_=y?.role||"viewer";g(_);const{count:v,items:C}=await k(f.id,_);t(C),s(v),a(v)}catch{}finally{c(!1)}},[k]),E=u.useCallback(async f=>{t(y=>y.map(_=>_.id===f?{..._,is_read:!0}:_)),s(y=>Math.max(0,y-1))},[]),w=u.useCallback(async f=>{t(y=>y.map(_=>_.id===f?{..._,is_actioned:!0,is_read:!0}:_)),s(y=>Math.max(0,y-1)),a(y=>Math.max(0,y-1))},[]),D=u.useCallback(async()=>{t(f=>f.map(y=>({...y,is_read:!0}))),s(0)},[]),b=u.useCallback(async f=>{const y=e.find(_=>_.id===f);y&&(t(_=>_.filter(v=>v.id!==f)),y.is_read||s(_=>Math.max(0,_-1)),y.notification_type==="action"&&!y.is_actioned&&a(_=>Math.max(0,_-1)))},[e]);u.useEffect(()=>{R();const f=setInterval(()=>{R()},3e4);return()=>clearInterval(f)},[R]),u.useEffect(()=>{const{data:{subscription:f}}=x.auth.onAuthStateChange((y,_)=>{y==="SIGNED_IN"?R():y==="SIGNED_OUT"&&(t([]),s(0),a(0),h(null),g(null))});return()=>f.unsubscribe()},[R]);const p={notifications:e,unreadCount:n,actionCount:i,loading:l,fetchNotifications:R,markAsRead:E,markAsActioned:w,markAllAsRead:D,dismissNotification:b};return o.jsx(Yn.Provider,{value:p,children:r})}const Xn=u.createContext(null),Mr="amsf-chat-history",wi=50,rr={maxRetries:2,baseDelayMs:1e3,retryableCodes:[429,503,504]};function _i(){try{const r=localStorage.getItem(Mr);if(r){const e=JSON.parse(r);return{messages:e.messages||[],tokenUsage:e.tokenUsage||{input:0,output:0,requests:0}}}}catch{}return{messages:[],tokenUsage:{input:0,output:0,requests:0}}}function Si(r,e){try{const t=r.slice(-wi);localStorage.setItem(Mr,JSON.stringify({messages:t,tokenUsage:e,savedAt:new Date().toISOString()}))}catch{}}function ji({children:r}){const{user:e,profile:t,linkedResource:n,role:s}=Tt(),{projectId:i,projectName:a,projectRef:l,currentProject:c}=Gn(),d=_i(),[h,m]=u.useState(!1),[g,S]=u.useState(d.messages),[k,R]=u.useState(!1),[E,w]=u.useState(null),[D,b]=u.useState(0),[p,f]=u.useState(d.tokenUsage),y=u.useRef(null);u.useEffect(()=>{(g.length>0||p.requests>0)&&Si(g,p)},[g,p]);const _=u.useCallback(()=>c?{id:i,reference:l||c?.reference,name:a||c?.name,description:c?.description||null}:null,[c,i,l,a]),v=u.useCallback(()=>({name:t?.full_name||e?.email?.split("@")[0]||"User",email:e?.email,role:s||t?.role||"unknown",linkedResourceName:n?.name||null,linkedResourceId:n?.id||null,partnerId:n?.partner_id||null,partnerName:n?.partners?.name||null}),[e,t,n,s]),C=async(re,ne=1)=>{y.current=new AbortController;try{const B=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re),signal:y.current.signal}),O=await B.json().catch(()=>({}));if(!B.ok){if(rr.retryableCodes.includes(B.status)&&ne<=rr.maxRetries&&O.recoverable!==!1){const Y=O.retryAfter?O.retryAfter*1e3:rr.baseDelayMs*Math.pow(2,ne-1);return b(ne),await new Promise(q=>setTimeout(q,Y)),C(re,ne+1)}throw new Error(O.error||`Request failed (${B.status})`)}return b(0),O}catch(B){throw B.name==="AbortError"?new Error("Request cancelled"):B}},T=u.useCallback(async re=>{if(!re.trim()||k)return;y.current&&y.current.abort();const ne={role:"user",content:re.trim(),timestamp:new Date().toISOString()};S(B=>[...B,ne]),R(!0),w(null),b(0);try{const B=_(),O=v(),Q=[...g.slice(-9),ne].map(q=>({role:q.role,content:q.content})),Y=await C({messages:Q,projectContext:B,userContext:O,projectId:i});Y.usage&&f(q=>({input:q.input+(Y.usage.input_tokens||0),output:q.output+(Y.usage.output_tokens||0),requests:q.requests+1})),S(q=>[...q,{role:"assistant",content:Y.message,toolsUsed:Y.toolsUsed||!1,cached:Y.cached||!1,timestamp:new Date().toISOString(),tokens:Y.usage?{input:Y.usage.input_tokens,output:Y.usage.output_tokens}:null}])}catch(B){let O=B.message;B.message==="Request cancelled"?O=null:B.message.includes("Failed to fetch")&&(O="Unable to connect. Please check your internet connection."),O&&(w(O),S(Q=>Q.slice(0,-1)))}finally{R(!1),b(0)}},[g,k,_,v,i]),L=u.useCallback(()=>{y.current&&(y.current.abort(),R(!1),b(0))},[]),I=u.useCallback(()=>{L(),S([]),w(null),localStorage.removeItem(Mr)},[L]),Z=u.useCallback(()=>{I(),f({input:0,output:0,requests:0})},[I]),he=u.useCallback(()=>{m(re=>!re)},[]),Pe=u.useCallback(()=>{w(null)},[]),z=u.useCallback(()=>{if(g.length===0)return null;const re=v(),ne=_();let B=`# Chat Export

`;return B+=`**Exported:** ${new Date().toLocaleString("en-GB")}
`,B+=`**User:** ${re.name} (${re.role})
`,ne&&(B+=`**Project:** ${ne.name} (${ne.reference})
`),B+=`**Messages:** ${g.length}
`,B+=`**Token Usage:** ${p.input.toLocaleString()} input / ${p.output.toLocaleString()} output

`,B+=`---

`,g.forEach((O,Q)=>{const Y=O.role==="user"?"ðŸ‘¤ You":"ðŸ¤– Assistant",q=O.timestamp?new Date(O.timestamp).toLocaleTimeString("en-GB"):"";B+=`### ${Y}${q?` (${q})`:""}

`,B+=`${O.content}

`,O.toolsUsed&&(B+=`*ðŸ“Š Queried project data*

`),Q<g.length-1&&(B+=`---

`)}),B},[g,p,v,_]),X=u.useCallback(()=>{const re=z();if(!re)return;const ne=new Blob([re],{type:"text/markdown"}),B=URL.createObjectURL(ne),O=document.createElement("a");O.href=B,O.download=`chat-export-${new Date().toISOString().split("T")[0]}.md`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(B)},[z]),ye=u.useCallback(async re=>{try{return await navigator.clipboard.writeText(re),!0}catch{return!1}},[]),ue={isOpen:h,setIsOpen:m,toggleChat:he,messages:g,isLoading:k,error:E,retryCount:D,tokenUsage:p,sendMessage:T,clearChat:I,resetAllStats:Z,cancelRequest:L,dismissError:Pe,exportChat:z,downloadChat:X,copyMessage:ye};return o.jsx(Xn.Provider,{value:ue,children:r})}function Ri(){const r=u.useContext(Xn);if(!r)throw new Error("useChat must be used within a ChatProvider");return r}class Ci extends kn.Component{constructor(t){super(t);Qt(this,"handleReload",()=>{window.location.reload()});Qt(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){this.setState({errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem",backgroundColor:"#fef2f2",borderRadius:"12px",margin:"1rem",border:"1px solid #fecaca"},children:[o.jsx(zn,{size:48,style:{color:"#dc2626",marginBottom:"1rem"}}),o.jsx("h2",{style:{color:"#991b1b",margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600"},children:"Something went wrong"}),o.jsx("p",{style:{color:"#64748b",margin:"0 0 1.5rem 0",textAlign:"center",maxWidth:"400px"},children:this.state.error?.message||"An unexpected error occurred. Please try again."}),o.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[o.jsx("button",{onClick:this.handleReset,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:"Try Again"}),o.jsxs("button",{onClick:this.handleReload,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1.25rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:[o.jsx(St,{size:16}),"Reload Page"]})]})]}):this.props.children}}function Tr({message:r,size:e="medium",fullPage:t=!1}){const n={small:{icon:16,text:"0.75rem",padding:"0.5rem"},medium:{icon:24,text:"0.875rem",padding:"1.5rem"},large:{icon:40,text:"1rem",padding:"3rem"}},s=n[e]||n.medium,i={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:s.padding,...t&&{minHeight:"60vh"}},a={animation:"spin 1s linear infinite",color:"#3b82f6"},l={marginTop:"0.75rem",color:"#64748b",fontSize:s.text};return o.jsxs("div",{style:i,children:[o.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `}),o.jsx(Mn,{size:s.icon,style:a}),r&&o.jsx("p",{style:l,children:r})]})}const Ei={background:"linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%)",backgroundSize:"200% 100%",animation:"shimmer 1.5s infinite"};function Ee({width:r="100%",height:e="1rem",style:t={},className:n=""}){return o.jsxs(o.Fragment,{children:[o.jsx("style",{children:`
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      `}),o.jsx("div",{className:n,style:{width:r,height:e,borderRadius:"4px",...Ei,...t}})]})}function vr({width:r="100%",lines:e=1}){return o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Array.from({length:e}).map((t,n)=>o.jsx(Ee,{width:n===e-1&&e>1?"70%":r,height:"1rem"},n))})}function Pi(){return o.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"1rem"},children:[o.jsx(Ee,{width:"48px",height:"48px",style:{borderRadius:"12px"}}),o.jsxs("div",{style:{flex:1},children:[o.jsx(Ee,{width:"60%",height:"0.875rem",style:{marginBottom:"0.5rem"}}),o.jsx(Ee,{width:"40%",height:"1.5rem"})]})]})}function Di({columns:r=6}){return o.jsx("tr",{children:Array.from({length:r}).map((e,t)=>o.jsx("td",{style:{padding:"0.75rem 1rem"},children:o.jsx(Ee,{width:t===0?"80%":t===r-1?"60px":"70%",height:"1rem"})},t))})}function nr({hasHeader:r=!0}){return o.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[r&&o.jsx(Ee,{width:"40%",height:"1.5rem",style:{marginBottom:"1rem"}}),o.jsx(vr,{lines:3})]})}function lt({type:r="text",count:e=1,...t}){return(()=>{switch(r){case"text":return o.jsx(vr,{...t});case"stat-card":case"stats":return o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:Array.from({length:e}).map((s,i)=>o.jsx(Pi,{},i))});case"table":return o.jsx("div",{className:"card",children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsx("tr",{children:Array.from({length:t.columns||6}).map((s,i)=>o.jsx("th",{style:{padding:"0.75rem 1rem"},children:o.jsx(Ee,{width:"60%",height:"0.875rem"})},i))})}),o.jsx("tbody",{children:Array.from({length:t.rows||5}).map((s,i)=>o.jsx(Di,{columns:t.columns||6},i))})]})});case"card":return o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:Array.from({length:e}).map((s,i)=>o.jsx(nr,{...t},i))});case"page":return o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx(Ee,{width:"200px",height:"1.75rem",style:{marginBottom:"0.5rem"}}),o.jsx(Ee,{width:"300px",height:"1rem"})]}),o.jsx(Ee,{width:"120px",height:"40px",style:{borderRadius:"8px"}})]}),o.jsx(lt,{type:"stats",count:4}),o.jsx(lt,{type:"table",rows:8,columns:6})]});case"detail":return o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[o.jsx(Ee,{width:"80px",height:"36px",style:{borderRadius:"8px"}}),o.jsx(Ee,{width:"250px",height:"1.75rem"})]}),o.jsx(lt,{type:"stats",count:4}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[o.jsx(nr,{}),o.jsx(nr,{})]}),o.jsx(lt,{type:"table",rows:5,columns:5})]});default:return o.jsx(vr,{...t})}})()}function gt({icon:r,label:e,value:t,subtext:n,color:s="#3b82f6",borderColor:i,backgroundColor:a,style:l={},onClick:c}){const d={...i&&{borderLeft:`4px solid ${i}`},...a&&{backgroundColor:a},...c&&{cursor:"pointer"},...l};return o.jsxs("div",{className:"stat-card",style:d,onClick:c,role:c?"button":void 0,tabIndex:c?0:void 0,children:[o.jsxs("div",{className:"stat-label",children:[r&&o.jsx(r,{size:20,style:{color:s}}),e]}),o.jsx("div",{className:"stat-value",style:{color:s},children:t}),n&&o.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b"},children:n})]})}function Oi({icon:r,title:e,subtitle:t,children:n,style:s={}}){return o.jsxs("div",{className:"page-header",style:s,children:[o.jsxs("div",{className:"page-title",children:[r&&o.jsx(r,{size:28}),o.jsxs("div",{children:[o.jsx("h1",{children:e}),t&&o.jsx("p",{children:t})]})]}),n&&o.jsx("div",{className:"page-actions",children:n})]})}const dn={success:{icon:ao,bgColor:"#dcfce7",borderColor:"#86efac",textColor:"#166534",iconColor:"#16a34a"},error:{icon:Tn,bgColor:"#fee2e2",borderColor:"#fecaca",textColor:"#991b1b",iconColor:"#dc2626"},warning:{icon:zn,bgColor:"#fef3c7",borderColor:"#fde68a",textColor:"#92400e",iconColor:"#d97706"},info:{icon:io,bgColor:"#dbeafe",borderColor:"#93c5fd",textColor:"#1e40af",iconColor:"#3b82f6"}};function ki({id:r,message:e,type:t="info",duration:n=4e3,onClose:s}){const i=dn[t]||dn.info,a=i.icon;return u.useEffect(()=>{if(n>0){const l=setTimeout(()=>{s(r)},n);return()=>clearTimeout(l)}},[r,n,s]),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.875rem 1rem",backgroundColor:i.bgColor,border:`1px solid ${i.borderColor}`,borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",minWidth:"300px",maxWidth:"450px",animation:"slideIn 0.3s ease-out"},children:[o.jsx(a,{size:20,style:{color:i.iconColor,flexShrink:0}}),o.jsx("span",{style:{color:i.textColor,fontSize:"0.875rem",fontWeight:"500",flex:1},children:e}),o.jsx("button",{onClick:()=>s(r),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center",color:i.textColor,opacity:.7,borderRadius:"4px"},onMouseEnter:l=>l.target.style.opacity=1,onMouseLeave:l=>l.target.style.opacity=.7,children:o.jsx(Ve,{size:16})})]})}function zi({toasts:r,removeToast:e}){return r.length===0?null:o.jsxs("div",{style:{position:"fixed",top:"1rem",right:"1rem",zIndex:9999,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[o.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `}),r.map(t=>o.jsx(ki,{id:t.id,message:t.message,type:t.type,duration:t.duration,onClose:e},t.id))]})}const Kn=u.createContext(null),Mi=4e3;function Ti({children:r}){const[e,t]=u.useState([]),n=u.useCallback(h=>{t(m=>m.filter(g=>g.id!==h))},[]),s=u.useCallback((h,m="info",g=Mi)=>{const S=Date.now()+Math.random(),k={id:S,message:h,type:m,duration:g};return t(R=>[...R,k]),S},[]),i=u.useCallback((h,m)=>s(h,"success",m),[s]),a=u.useCallback((h,m)=>s(h,"error",m||6e3),[s]),l=u.useCallback((h,m)=>s(h,"warning",m),[s]),c=u.useCallback((h,m)=>s(h,"info",m),[s]),d={showToast:s,showSuccess:i,showError:a,showWarning:l,showInfo:c,removeToast:n};return o.jsxs(Kn.Provider,{value:d,children:[r,o.jsx(zi,{toasts:e,removeToast:n})]})}function Ii(){const r=u.useContext(Kn);if(!r)throw new Error("useToast must be used within a ToastProvider");return r}function Ni(){const{isOpen:r,toggleChat:e,messages:t,isLoading:n,error:s,retryCount:i,tokenUsage:a,sendMessage:l,clearChat:c,cancelRequest:d,dismissError:h,downloadChat:m,copyMessage:g}=Ri(),[S,k]=u.useState(""),[R,E]=u.useState(null),[w,D]=u.useState(!1),b=u.useRef(null),p=u.useRef(null);u.useEffect(()=>{b.current?.scrollIntoView({behavior:"smooth"})},[t]),u.useEffect(()=>{r&&setTimeout(()=>p.current?.focus(),100)},[r]),u.useEffect(()=>{if(R!==null){const L=setTimeout(()=>E(null),2e3);return()=>clearTimeout(L)}},[R]);const f=L=>{L.preventDefault(),S.trim()&&!n&&(l(S),k(""))},y=L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),f(L))},_=async(L,I)=>{await g(L)&&E(I)},v={role:"assistant",content:`Hello! I'm your Project Assistant. I can query your project data and help you understand what's happening. Try asking:

â€¢ **"What do I need to do?"** - See your pending actions
â€¢ **"Show my timesheets this month"** - Query your time entries
â€¢ **"What milestones are at risk?"** - Check project progress
â€¢ **"What's the budget status?"** - View spend vs forecast
â€¢ **"What can my role do?"** - Understand your permissions

All data is scoped to your role, so just ask naturally!`},C=t.length===0?[v]:t,T=(a.input*.25/1e6+a.output*1.25/1e6).toFixed(4);return o.jsxs(o.Fragment,{children:[o.jsx("button",{className:`chat-toggle-btn ${r?"chat-open":""}`,onClick:e,"aria-label":r?"Close chat":"Open AI assistant",children:r?o.jsx(Ve,{size:24}):o.jsxs(o.Fragment,{children:[o.jsx(lo,{size:24}),o.jsx(co,{className:"chat-sparkle",size:12})]})}),o.jsxs("div",{className:`chat-panel ${r?"chat-panel-open":""}`,children:[o.jsxs("div",{className:"chat-header",children:[o.jsxs("div",{className:"chat-header-title",children:[o.jsx(Jt,{size:20}),o.jsx("span",{children:"Project Assistant"})]}),o.jsxs("div",{className:"chat-header-actions",children:[t.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"chat-action-btn",onClick:m,title:"Export chat as Markdown",children:o.jsx(uo,{size:16})}),o.jsx("button",{className:"chat-action-btn",onClick:c,title:"Clear chat",children:o.jsx(fo,{size:16})})]}),o.jsx("button",{className:"chat-close-btn",onClick:e,"aria-label":"Close chat",children:o.jsx(Ve,{size:20})})]})]}),o.jsxs("div",{className:"chat-messages",children:[C.map((L,I)=>o.jsxs("div",{className:`chat-message ${L.role==="user"?"chat-message-user":"chat-message-assistant"}`,children:[o.jsx("div",{className:"chat-message-avatar",children:L.role==="user"?o.jsx(ho,{size:16}):o.jsx(Jt,{size:16})}),o.jsxs("div",{className:"chat-message-content",children:[o.jsx(Li,{content:L.content}),o.jsxs("div",{className:"chat-message-actions",children:[L.toolsUsed&&o.jsx("span",{className:"chat-tools-indicator",title:"Queried project data",children:o.jsx(po,{size:12})}),o.jsx("button",{className:"chat-copy-btn",onClick:()=>_(L.content,I),title:R===I?"Copied!":"Copy message",children:R===I?o.jsx(zr,{size:12,className:"chat-copy-success"}):o.jsx(mo,{size:12})})]})]})]},I)),n&&o.jsxs("div",{className:"chat-message chat-message-assistant",children:[o.jsx("div",{className:"chat-message-avatar",children:o.jsx(Jt,{size:16})}),o.jsxs("div",{className:"chat-message-content chat-typing",children:[i>0?o.jsxs(o.Fragment,{children:[o.jsx(St,{className:"chat-typing-icon",size:16}),o.jsxs("span",{children:["Retrying (",i,"/2)..."]})]}):o.jsxs(o.Fragment,{children:[o.jsx(Mn,{className:"chat-typing-icon",size:16}),o.jsx("span",{children:"Querying data..."})]}),o.jsx("button",{className:"chat-cancel-btn",onClick:d,title:"Cancel request",children:o.jsx(Tn,{size:14})})]})]}),s&&o.jsxs("div",{className:"chat-error",children:[o.jsx("span",{children:s}),o.jsx("button",{className:"chat-error-dismiss",onClick:h,title:"Dismiss",children:o.jsx(Ve,{size:14})})]}),o.jsx("div",{ref:b})]}),o.jsxs("form",{className:"chat-input-form",onSubmit:f,children:[o.jsx("textarea",{ref:p,className:"chat-input",value:S,onChange:L=>k(L.target.value),onKeyDown:y,placeholder:"Ask me anything about the project...",rows:1,disabled:n}),o.jsx("button",{type:"submit",className:"chat-send-btn",disabled:!S.trim()||n,"aria-label":"Send message",children:o.jsx(go,{size:18})})]}),o.jsxs("div",{className:"chat-footer",children:[o.jsx("button",{className:"chat-stats-toggle",onClick:()=>D(!w),title:"Toggle usage stats",children:o.jsx(yo,{size:12})}),w?o.jsxs("div",{className:"chat-stats",children:[o.jsxs("span",{title:"Total requests",children:[a.requests," req"]}),o.jsx("span",{className:"chat-stats-divider",children:"â€¢"}),o.jsxs("span",{title:"Input tokens",children:[a.input.toLocaleString()," in"]}),o.jsx("span",{className:"chat-stats-divider",children:"â€¢"}),o.jsxs("span",{title:"Output tokens",children:[a.output.toLocaleString()," out"]}),o.jsx("span",{className:"chat-stats-divider",children:"â€¢"}),o.jsxs("span",{title:"Estimated cost",children:["$",T]})]}):o.jsx("span",{children:"Powered by Claude AI"})]})]})]})}function Li({content:r}){const e=r.split(`
`);return o.jsx("div",{className:"chat-message-text",children:e.map((t,n)=>{if(t.startsWith("â€¢ ")||t.startsWith("- ")){const s=t.substring(2);return o.jsxs("div",{className:"chat-bullet",children:[o.jsx("span",{className:"chat-bullet-dot",children:"â€¢"}),o.jsx("span",{dangerouslySetInnerHTML:{__html:un(s)}})]},n)}return t.trim()===""?o.jsx("div",{className:"chat-line-break"},n):o.jsx("p",{dangerouslySetInnerHTML:{__html:un(t)}},n)})})}function un(r){return r.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>")}function Ai(){const[r,e]=u.useState(!1),t=u.useRef(null),n=kr(),{notifications:s,unreadCount:i,actionCount:a,loading:l,markAsRead:c,markAsActioned:d,markAllAsRead:h,dismissNotification:m}=vi();u.useEffect(()=>{function p(f){t.current&&!t.current.contains(f.target)&&e(!1)}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const g=p=>{switch(p){case"timesheet":return o.jsx(ut,{size:16});case"expense":return o.jsx(Nn,{size:16});case"deliverable":return o.jsx(In,{size:16});case"certificate":return o.jsx(jt,{size:16});default:return o.jsx(Zt,{size:16})}},S=p=>p.notification_type==="action"?p.is_actioned?"#10b981":"#f59e0b":"#3b82f6",k=async p=>{p.is_read||await c(p.id),p.action_url&&(n(p.action_url),e(!1))},R=async(p,f)=>{p.stopPropagation(),await d(f.id),f.action_url&&(n(f.action_url),e(!1))},E=async(p,f)=>{p.stopPropagation(),await m(f.id)},w=p=>{const f=new Date(p),_=new Date-f,v=Math.floor(_/6e4),C=Math.floor(_/36e5),T=Math.floor(_/864e5);return v<1?"Just now":v<60?`${v}m ago`:C<24?`${C}h ago`:T<7?`${T}d ago`:f.toLocaleDateString("en-GB",{day:"numeric",month:"short"})},D=s.slice(0,10),b=s.filter(p=>p.notification_type==="action"&&!p.is_actioned);return o.jsxs("div",{className:"notification-bell-container",ref:t,style:{position:"relative"},children:[o.jsxs("button",{onClick:()=>e(!r),style:{position:"relative",background:"none",border:"none",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s",backgroundColor:r?"#f1f5f9":"transparent"},onMouseEnter:p=>p.target.style.backgroundColor="#f1f5f9",onMouseLeave:p=>p.target.style.backgroundColor=r?"#f1f5f9":"transparent",title:`${a} actions pending`,children:[o.jsx(Zt,{size:22,color:"#64748b"}),(i>0||a>0)&&o.jsx("span",{style:{position:"absolute",top:"2px",right:"2px",backgroundColor:a>0?"#ef4444":"#3b82f6",color:"white",fontSize:"11px",fontWeight:"600",minWidth:"18px",height:"18px",borderRadius:"9px",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},children:a>0?a:i})]}),r&&o.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"380px",maxHeight:"500px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.15)",border:"1px solid #e2e8f0",zIndex:1e3,overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600"},children:"Notifications"}),a>0&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:"13px",color:"#f59e0b"},children:[a," action",a!==1?"s":""," required"]})]}),i>0&&o.jsx("button",{onClick:h,style:{background:"none",border:"none",color:"#3b82f6",fontSize:"13px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px"},children:"Mark all read"})]}),b.length>0&&o.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#fffbeb",borderBottom:"1px solid #fef3c7"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[o.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b",animation:"pulse 2s infinite"}}),o.jsx("span",{style:{fontWeight:"600",fontSize:"13px",color:"#92400e"},children:"Actions Requiring Attention"})]}),o.jsxs("button",{onClick:()=>{n("/workflow-summary"),e(!1)},style:{width:"100%",padding:"8px 12px",backgroundColor:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:["View Workflow Summary",o.jsx(bo,{size:16})]})]}),o.jsx("div",{style:{maxHeight:"350px",overflowY:"auto"},children:l?o.jsx("div",{style:{padding:"32px",textAlign:"center",color:"#64748b"},children:"Loading..."}):D.length===0?o.jsxs("div",{style:{padding:"32px",textAlign:"center",color:"#64748b"},children:[o.jsx(Zt,{size:32,style:{marginBottom:"8px",opacity:.5}}),o.jsx("p",{style:{margin:0},children:"No notifications"})]}):D.map(p=>o.jsx("div",{onClick:()=>k(p),style:{padding:"12px 16px",borderBottom:"1px solid #f1f5f9",cursor:"pointer",backgroundColor:p.is_read?"white":"#f8fafc",transition:"background-color 0.15s"},onMouseEnter:f=>f.currentTarget.style.backgroundColor="#f1f5f9",onMouseLeave:f=>f.currentTarget.style.backgroundColor=p.is_read?"white":"#f8fafc",children:o.jsxs("div",{style:{display:"flex",gap:"12px"},children:[o.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",backgroundColor:p.notification_type==="action"&&!p.is_actioned?"#fef3c7":"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",color:S(p),flexShrink:0},children:g(p.category)}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},children:[o.jsx("span",{style:{fontWeight:p.is_read?"400":"600",fontSize:"14px",color:"#1e293b"},children:p.title}),o.jsx("span",{style:{fontSize:"12px",color:"#94a3b8",flexShrink:0},children:w(p.created_at)})]}),o.jsx("p",{style:{margin:"4px 0 0",fontSize:"13px",color:"#64748b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.message}),o.jsxs("div",{style:{marginTop:"8px",display:"flex",gap:"8px"},children:[p.notification_type==="action"&&!p.is_actioned&&p.action_label&&o.jsx("button",{onClick:f=>R(f,p),style:{padding:"4px 12px",fontSize:"12px",fontWeight:"500",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:p.action_label}),p.notification_type==="info"&&o.jsxs("button",{onClick:f=>E(f,p),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"transparent",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[o.jsx(Ve,{size:12}),"Dismiss"]}),p.is_actioned&&o.jsxs("span",{style:{padding:"4px 8px",fontSize:"12px",color:"#10b981",display:"flex",alignItems:"center",gap:"4px"},children:[o.jsx(zr,{size:12}),"Completed"]})]})]})]})},p.id))}),s.length>10&&o.jsx("div",{style:{padding:"12px 16px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:o.jsx("button",{onClick:()=>{n("/workflow-summary"),e(!1)},style:{background:"none",border:"none",color:"#3b82f6",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"View all notifications"})})]}),o.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})}const j={ADMIN:"admin",SUPPLIER_PM:"supplier_pm",CUSTOMER_PM:"customer_pm",CONTRIBUTOR:"contributor",VIEWER:"viewer"},qi=[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.CONTRIBUTOR,j.VIEWER],$e=qi,Ne=[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM],G=[j.ADMIN,j.SUPPLIER_PM],ot=[j.ADMIN,j.CUSTOMER_PM],Be=[j.ADMIN,j.SUPPLIER_PM,j.CONTRIBUTOR],sr=[j.ADMIN],Wi={timesheets:{view:$e,create:Be,createForOthers:G,edit:Be,delete:G,submit:Be,approve:ot},expenses:{view:$e,create:Be,createForOthers:G,edit:Be,delete:G,submit:Be,validateChargeable:ot,validateNonChargeable:G},milestones:{view:$e,create:G,edit:G,delete:sr,useGantt:G},deliverables:{view:$e,create:[...Ne,j.CONTRIBUTOR],edit:[...Ne,j.CONTRIBUTOR],delete:G,submit:Be,review:ot,markDelivered:ot},kpis:{view:$e,create:G,edit:G,delete:G,manage:G},qualityStandards:{view:$e,create:G,edit:G,delete:G,manage:G},resources:{view:$e,create:G,edit:G,delete:sr,manage:G,seeCostPrice:G,seeResourceType:G,seeMargins:G},partners:{view:G,create:G,edit:G,delete:G,manage:G},certificates:{view:Ne,create:Ne,signAsSupplier:G,signAsCustomer:ot},invoices:{view:Ne,generateCustomer:Ne,generateThirdParty:G,viewMargins:G},settings:{access:G,edit:G},users:{view:G,manage:sr},reports:{access:Ne,viewWorkflowSummary:Ne}};function Ed(r,e,t){const n=Wi[e];if(!n)return!1;const s=n[t];return s?s.includes(r):!1}const $i={[j.ADMIN]:{label:"Admin",color:"#7c3aed",bg:"#f3e8ff"},[j.SUPPLIER_PM]:{label:"Supplier PM",color:"#059669",bg:"#d1fae5"},[j.CUSTOMER_PM]:{label:"Customer PM",color:"#d97706",bg:"#fef3c7"},[j.CONTRIBUTOR]:{label:"Contributor",color:"#2563eb",bg:"#dbeafe"},[j.VIEWER]:{label:"Viewer",color:"#64748b",bg:"#f1f5f9"}},Pd=Object.entries($i).map(([r,e])=>({value:r,...e})),It={workflowSummary:{id:"workflowSummary",path:"/workflow-summary",icon:Eo,label:"Workflow Summary",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.CONTRIBUTOR],readOnlyRoles:[]},dashboard:{id:"dashboard",path:"/dashboard",icon:Co,label:"Dashboard",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.VIEWER],readOnlyRoles:[j.VIEWER]},reports:{id:"reports",path:"/reports",icon:In,label:"Reports",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM],readOnlyRoles:[]},gantt:{id:"gantt",path:"/gantt",icon:Ro,label:"Gantt Chart",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.VIEWER],readOnlyRoles:[j.VIEWER,j.CUSTOMER_PM]},milestones:{id:"milestones",path:"/milestones",icon:jo,label:"Milestones",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.VIEWER],readOnlyRoles:[j.VIEWER]},deliverables:{id:"deliverables",path:"/deliverables",icon:gr,label:"Deliverables",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.CONTRIBUTOR,j.VIEWER],readOnlyRoles:[j.VIEWER]},kpis:{id:"kpis",path:"/kpis",icon:wt,label:"KPIs",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.VIEWER],readOnlyRoles:[j.VIEWER,j.CUSTOMER_PM]},qualityStandards:{id:"qualityStandards",path:"/quality-standards",icon:jt,label:"Quality Standards",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.VIEWER],readOnlyRoles:[j.VIEWER,j.CUSTOMER_PM]},resources:{id:"resources",path:"/resources",icon:So,label:"Resources",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[]},timesheets:{id:"timesheets",path:"/timesheets",icon:ut,label:"Timesheets",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.CONTRIBUTOR],readOnlyRoles:[]},expenses:{id:"expenses",path:"/expenses",icon:Nn,label:"Expenses",allowedRoles:[j.ADMIN,j.SUPPLIER_PM,j.CUSTOMER_PM,j.CONTRIBUTOR],readOnlyRoles:[]},partners:{id:"partners",path:"/partners",icon:_o,label:"Partners",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[]},users:{id:"users",path:"/users",icon:wo,label:"Users",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[j.SUPPLIER_PM]},settings:{id:"settings",path:"/settings",icon:Ln,label:"Settings",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[]},auditLog:{id:"auditLog",path:"/audit-log",icon:xo,label:"Audit Log",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[]},deletedItems:{id:"deletedItems",path:"/deleted-items",icon:vo,label:"Deleted Items",allowedRoles:[j.ADMIN,j.SUPPLIER_PM],readOnlyRoles:[]}},Rt={[j.ADMIN]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","resources","timesheets","expenses","partners","users","settings","auditLog","deletedItems"],[j.SUPPLIER_PM]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","resources","timesheets","expenses","partners","users","settings","auditLog","deletedItems"],[j.CUSTOMER_PM]:["workflowSummary","dashboard","reports","gantt","milestones","deliverables","kpis","qualityStandards","timesheets","expenses"],[j.CONTRIBUTOR]:["workflowSummary","timesheets","expenses","deliverables"],[j.VIEWER]:["dashboard","gantt","milestones","deliverables","kpis","qualityStandards"]};function Bi(r){return(Rt[r]||Rt[j.VIEWER]).map(t=>It[t]?.path).filter(Boolean)}function Qn(r){return(Rt[r]||Rt[j.VIEWER]).map(t=>It[t]).filter(t=>t&&t.allowedRoles.includes(r))}function fn(r,e){const t=It[e];return t?t.readOnlyRoles?.includes(r)||!1:!0}function Hi(r){return r!==j.VIEWER}function Ui(r){return Object.values(It).find(e=>e.path===r)||null}function Fi(r){return Ui(r)?.id||null}function Gi(r,e){const t=Qn(r);if(!e||!Array.isArray(e)||e.length===0)return t;const n={};t.forEach(i=>{n[i.path]=i});const s=[];return e.forEach(i=>{n[i]&&(s.push(n[i]),delete n[i])}),Object.values(n).forEach(i=>{s.push(i)}),s}function Vi(r,e){if(!e||e.length===0)return!0;const t=Bi(r);return e.length!==t.length?!1:e.every((n,s)=>n===t[s])}const hn={[j.ADMIN]:{label:"Administrator",shortLabel:"Admin",color:"#7c3aed",bg:"#f3e8ff",description:"Full system access"},[j.SUPPLIER_PM]:{label:"Supplier PM",shortLabel:"Supplier PM",color:"#059669",bg:"#d1fae5",description:"Manage resources, partners, and invoices"},[j.CUSTOMER_PM]:{label:"Customer PM",shortLabel:"Customer PM",color:"#d97706",bg:"#fef3c7",description:"Approve timesheets and validate expenses"},[j.CONTRIBUTOR]:{label:"Contributor",shortLabel:"Contributor",color:"#2563eb",bg:"#dbeafe",description:"Submit timesheets and expenses"},[j.VIEWER]:{label:"Viewer",shortLabel:"Viewer",color:"#64748b",bg:"#f1f5f9",description:"Read-only access to reports"}};function Yi(r){return hn[r]||hn[j.VIEWER]}function Xi({children:r}){const e=Js(),t=kr(),{showSuccess:n,showError:s}=Ii(),{user:i,profile:a,role:l,signOut:c}=Tt(),[d,h]=u.useState(!0),[m,g]=u.useState(null),[S,k]=u.useState(null),[R,E]=u.useState(null),w=u.useRef(null),D=u.useMemo(()=>Yi(l),[l]),b=u.useMemo(()=>a&&(a.full_name||a.email||i?.email)||"User",[a,i]),p=u.useMemo(()=>{if(!a)return"U";if(a.full_name){const z=a.full_name.split(" ");return z.length>=2?z[0][0]+z[z.length-1][0]:a.full_name[0].toUpperCase()}return b[0].toUpperCase()},[a,b]);u.useEffect(()=>{a?.nav_order&&Array.isArray(a.nav_order)&&g(a.nav_order)},[a]);async function f(){await c(),t("/login")}const y=u.useMemo(()=>Hi(l),[l]),_=u.useMemo(()=>m&&!Vi(l,m),[l,m]),v=u.useMemo(()=>{const z=Qn(l);return m&&m.length>0?Gi(l,m):z},[l,m]),C=u.useMemo(()=>{const z=Fi(e.pathname);return z?fn(l,z):!1},[l,e.pathname]);function T(z,X){y&&(w.current=z.target,k(X),setTimeout(()=>{w.current&&(w.current.style.opacity="0.5")},0))}function L(z,X){y&&X!==S&&E(X)}function I(z){y&&z.preventDefault()}function Z(){if(y){if(w.current&&(w.current.style.opacity="1"),S!==null&&R!==null&&S!==R){const z=[...v],X=z[S];z.splice(S,1),z.splice(R,0,X);const ye=z.map(ue=>ue.path);g(ye),he(ye)}k(null),E(null),w.current=null}}async function he(z){if(i)try{const{error:X}=await x.from("profiles").update({nav_order:z}).eq("id",i.id);X&&s("Failed to save menu order")}catch{s("Failed to save menu order")}}async function Pe(){if(i)try{const{error:z}=await x.from("profiles").update({nav_order:null}).eq("id",i.id);if(z){s("Failed to reset menu order");return}g(null),n("Menu order reset to default")}catch{s("Failed to reset menu order")}}return o.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#f8fafc"},children:[o.jsxs("aside",{style:{width:d?"260px":"70px",backgroundColor:"white",borderRight:"1px solid #e2e8f0",transition:"width 0.3s ease",display:"flex",flexDirection:"column",position:"fixed",height:"100vh",zIndex:50},children:[o.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d&&o.jsxs("div",{children:[o.jsx("h2",{style:{margin:0,fontSize:"1.125rem",fontWeight:"700",color:"#0f172a"},children:"AMSF001"}),o.jsx("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Project Tracker"})]}),o.jsx("button",{onClick:()=>h(!d),style:{padding:"0.5rem",borderRadius:"6px",border:"none",backgroundColor:"#f1f5f9",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:d?o.jsx(Ve,{size:20}):o.jsx(Po,{size:20})})]}),o.jsx("nav",{style:{flex:1,padding:"0.5rem",overflowY:"auto"},children:v.map((z,X)=>{const ye=z.icon,ue=e.pathname===z.path||z.path!=="/dashboard"&&e.pathname.startsWith(z.path),re=S===X,ne=R===X,B=fn(l,z.id);return o.jsx("div",{draggable:y,onDragStart:O=>T(O,X),onDragEnter:O=>L(O,X),onDragOver:I,onDragEnd:Z,style:{position:"relative",marginBottom:"0.25rem",borderTop:ne&&S>X?"2px solid #10b981":"2px solid transparent",borderBottom:ne&&S<X?"2px solid #10b981":"2px solid transparent",transition:"border-color 0.15s ease"},children:o.jsxs(qe,{to:z.path,style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:d?"0.75rem 1rem":"0.75rem",borderRadius:"8px",textDecoration:"none",color:ue?"#10b981":"#64748b",backgroundColor:ue?"#f0fdf4":re?"#f1f5f9":"transparent",fontWeight:ue?"600":"500",justifyContent:d?"flex-start":"center",transition:"all 0.15s ease",cursor:y?"grab":"pointer"},children:[d&&y&&o.jsx(Do,{size:14,style:{color:"#cbd5e1",marginRight:"-0.25rem",flexShrink:0}}),o.jsx(ye,{size:20}),d&&o.jsx("span",{style:{flex:1},children:z.label}),d&&B&&o.jsx("span",{style:{fontSize:"0.6rem",padding:"0.125rem 0.375rem",backgroundColor:"#f1f5f9",color:"#64748b",borderRadius:"4px",fontWeight:"500"},children:"VIEW"})]})},z.path)})}),d&&y&&_&&o.jsx("div",{style:{padding:"0.5rem 1rem",borderTop:"1px solid #e2e8f0"},children:o.jsxs("button",{onClick:Pe,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.5rem",backgroundColor:"#f8fafc",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:"6px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"500",transition:"all 0.15s ease"},onMouseEnter:z=>{z.currentTarget.style.backgroundColor="#f1f5f9",z.currentTarget.style.color="#475569"},onMouseLeave:z=>{z.currentTarget.style.backgroundColor="#f8fafc",z.currentTarget.style.color="#64748b"},children:[o.jsx(An,{size:14}),"Reset Menu Order"]})}),o.jsx("div",{style:{padding:"1rem",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:o.jsxs("button",{onClick:f,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:d?"flex-start":"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"#fef2f2",color:"#ef4444",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"500"},children:[o.jsx(Oo,{size:20}),d&&o.jsx("span",{children:"Logout"})]})})]}),o.jsxs("main",{style:{flex:1,marginLeft:d?"260px":"70px",transition:"margin-left 0.3s ease",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[o.jsxs("header",{style:{padding:"0.75rem 1.5rem",backgroundColor:"white",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"1rem",position:"sticky",top:0,zIndex:40},children:[o.jsxs(qe,{to:"/account",style:{display:"flex",alignItems:"center",gap:"0.75rem",paddingRight:"1rem",borderRight:"1px solid #e2e8f0",textDecoration:"none",cursor:"pointer",borderRadius:"8px",padding:"0.5rem 1rem 0.5rem 0.75rem",marginRight:"0",transition:"background-color 0.15s ease"},onMouseEnter:z=>z.currentTarget.style.backgroundColor="#f8fafc",onMouseLeave:z=>z.currentTarget.style.backgroundColor="transparent",children:[o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("div",{style:{fontWeight:"600",fontSize:"0.875rem",color:"#1e293b"},children:b}),o.jsx("span",{style:{display:"inline-block",padding:"0.125rem 0.5rem",backgroundColor:D.bg,color:D.color,borderRadius:"4px",fontSize:"0.65rem",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.025em"},children:D.shortLabel})]}),o.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:D.color,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"0.8rem"},children:p})]}),o.jsx(Ai,{})]}),C&&o.jsxs("div",{style:{padding:"0.5rem 1.5rem",backgroundColor:"#f1f5f9",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"#64748b"},children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),o.jsx("span",{children:"You have read-only access to this page"})]}),o.jsx("div",{style:{flex:1},children:r})]})]})}function Ki(){const r=kr(),[e]=Zs(),[t,n]=u.useState(!1),[s,i]=u.useState(""),[a,l]=u.useState(""),[c,d]=u.useState(null),[h,m]=u.useState(null),[g,S]=u.useState(!1),[k,R]=u.useState(!1),[E,w]=u.useState(!1),[D,b]=u.useState(!1);u.useEffect(()=>{e.get("expired")==="true"&&(b(!0),window.history.replaceState({},document.title,"/login")),x.auth.getSession().then(({data:{session:C}})=>{C&&r("/dashboard",{replace:!0})});const{data:{subscription:v}}=x.auth.onAuthStateChange((C,T)=>{C==="SIGNED_IN"&&T&&r("/dashboard",{replace:!0})});return()=>v.unsubscribe()},[r,e]);const p=async v=>{v.preventDefault(),n(!0),d(null),m(null),b(!1);try{if(g){const{error:C}=await x.auth.signUp({email:s,password:a,options:{data:{full_name:s.split("@")[0]}}});if(C)throw C;m("Check your email for confirmation link!")}else{const{error:C}=await x.auth.signInWithPassword({email:s,password:a});if(C)throw C}}catch(C){d(C.message)}finally{n(!1)}},f=async v=>{if(v.preventDefault(),!s){d("Please enter your email address");return}n(!0),d(null),m(null);try{const{error:C}=await x.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password`});if(C)throw C;m("Password reset email sent! Check your inbox.")}catch(C){d(C.message)}finally{n(!1)}},y=async v=>{if(v.preventDefault(),!s){d("Please enter your email address");return}n(!0),d(null),m(null);try{const{error:C}=await x.auth.resend({type:"signup",email:s});if(C)throw C;m("Verification email resent! Check your inbox.")}catch(C){d(C.message)}finally{n(!1)}},_=()=>{R(!1),w(!1),d(null),m(null),b(!1)};return k?o.jsx("div",{className:"auth-container",children:o.jsxs("div",{className:"auth-box",children:[o.jsxs("div",{className:"auth-logo",children:[o.jsx(ko,{size:40,style:{color:"var(--primary)",marginBottom:"0.5rem"}}),o.jsx("h1",{className:"auth-title",children:"Reset Password"}),o.jsx("p",{className:"auth-subtitle",children:"Enter your email to receive a reset link"})]}),o.jsxs("form",{onSubmit:f,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),o.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:v=>i(v.target.value),required:!0})]}),c&&o.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[o.jsx(er,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&o.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[o.jsx(tr,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Sending...":"Send Reset Link"})]}),o.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:o.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:"â† Back to Sign In"})})]})}):E?o.jsx("div",{className:"auth-container",children:o.jsxs("div",{className:"auth-box",children:[o.jsxs("div",{className:"auth-logo",children:[o.jsx(St,{size:40,style:{color:"var(--primary)",marginBottom:"0.5rem"}}),o.jsx("h1",{className:"auth-title",children:"Resend Verification"}),o.jsx("p",{className:"auth-subtitle",children:"Enter your email to resend the verification link"})]}),o.jsxs("form",{onSubmit:y,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),o.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:v=>i(v.target.value),required:!0})]}),c&&o.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[o.jsx(er,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&o.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[o.jsx(tr,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Sending...":"Resend Verification Email"})]}),o.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:o.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:"â† Back to Sign In"})})]})}):o.jsx("div",{className:"auth-container",children:o.jsxs("div",{className:"auth-box",children:[o.jsxs("div",{className:"auth-logo",children:[o.jsx("h1",{className:"auth-title",children:"AMSF001 Tracker"}),o.jsx("p",{className:"auth-subtitle",children:"Network Architecture Services Project"})]}),D&&o.jsxs("div",{style:{padding:"0.75rem",background:"#fef3c7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#92400e",border:"1px solid #fcd34d"},children:[o.jsx(ut,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Your session has expired. Please sign in again."})]}),o.jsxs("form",{onSubmit:p,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{className:"form-label",htmlFor:"email",children:"Email Address"}),o.jsx("input",{id:"email",className:"form-input",type:"email",placeholder:"you@example.com",value:s,onChange:v=>i(v.target.value),required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{className:"form-label",htmlFor:"password",children:"Password"}),o.jsx("input",{id:"password",className:"form-input",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:a,onChange:v=>l(v.target.value),required:!0})]}),c&&o.jsxs("div",{style:{padding:"0.75rem",background:"#fee2e2",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#991b1b"},children:[o.jsx(er,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:c})]}),h&&o.jsxs("div",{style:{padding:"0.75rem",background:"#dcfce7",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#166534"},children:[o.jsx(tr,{size:20}),o.jsx("span",{style:{fontSize:"0.875rem"},children:h})]}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{width:"100%",justifyContent:"center"},children:t?"Loading...":g?"Sign Up":"Sign In"})]}),!g&&o.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:o.jsx("button",{onClick:()=>{R(!0),d(null),m(null),b(!1)},style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",fontSize:"0.85rem",textDecoration:"underline"},children:"Forgot your password?"})}),o.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:o.jsx("button",{onClick:()=>{S(!g),d(null),m(null),b(!1)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.875rem"},children:g?"Already have an account? Sign In":"Don't have an account? Sign Up"})}),o.jsxs("div",{style:{marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[o.jsx("p",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"0.5rem"},children:"Haven't received your verification email?"}),o.jsxs("button",{onClick:()=>{w(!0),d(null),m(null),b(!1)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",fontSize:"0.85rem",display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[o.jsx(St,{size:14})," Resend Verification Email"]})]})]})})}var Jn={exports:{}},ft={},xr={exports:{}};(function(r,e){(function(t,n){n(e)})(eo,function(t){function n(P){return function(A,H,V,se,de,pe,oe){return P(A,H,oe)}}function s(P){return function(A,H,V,se){if(!A||!H||typeof A!="object"||typeof H!="object")return P(A,H,V,se);var de=se.get(A),pe=se.get(H);if(de&&pe)return de===H&&pe===A;se.set(A,H),se.set(H,A);var oe=P(A,H,V,se);return se.delete(A),se.delete(H),oe}}function i(P,M){var A={};for(var H in P)A[H]=P[H];for(var H in M)A[H]=M[H];return A}function a(P){return P.constructor===Object||P.constructor==null}function l(P){return typeof P.then=="function"}function c(P,M){return P===M||P!==P&&M!==M}var d="[object Arguments]",h="[object Boolean]",m="[object Date]",g="[object RegExp]",S="[object Map]",k="[object Number]",R="[object Object]",E="[object Set]",w="[object String]",D=Object.prototype.toString;function b(P){var M=P.areArraysEqual,A=P.areDatesEqual,H=P.areMapsEqual,V=P.areObjectsEqual,se=P.areRegExpsEqual,de=P.areSetsEqual,pe=P.createIsNestedEqual,oe=pe(_e);function _e(J,ee,xe){if(J===ee)return!0;if(!J||!ee||typeof J!="object"||typeof ee!="object")return J!==J&&ee!==ee;if(a(J)&&a(ee))return V(J,ee,oe,xe);var st=Array.isArray(J),mt=Array.isArray(ee);if(st||mt)return st===mt&&M(J,ee,oe,xe);var Ce=D.call(J);return Ce!==D.call(ee)?!1:Ce===m?A(J,ee,oe,xe):Ce===g?se(J,ee,oe,xe):Ce===S?H(J,ee,oe,xe):Ce===E?de(J,ee,oe,xe):Ce===R||Ce===d?l(J)||l(ee)?!1:V(J,ee,oe,xe):Ce===h||Ce===k||Ce===w?c(J.valueOf(),ee.valueOf()):!1}return _e}function p(P,M,A,H){var V=P.length;if(M.length!==V)return!1;for(;V-- >0;)if(!A(P[V],M[V],V,V,P,M,H))return!1;return!0}var f=s(p);function y(P,M){return c(P.valueOf(),M.valueOf())}function _(P,M,A,H){var V=P.size===M.size;if(!V)return!1;if(!P.size)return!0;var se={},de=0;return P.forEach(function(pe,oe){if(V){var _e=!1,J=0;M.forEach(function(ee,xe){!_e&&!se[J]&&(_e=A(oe,xe,de,J,P,M,H)&&A(pe,ee,oe,xe,P,M,H))&&(se[J]=!0),J++}),de++,V=_e}}),V}var v=s(_),C="_owner",T=Object.prototype.hasOwnProperty;function L(P,M,A,H){var V=Object.keys(P),se=V.length;if(Object.keys(M).length!==se)return!1;for(var de;se-- >0;){if(de=V[se],de===C){var pe=!!P.$$typeof,oe=!!M.$$typeof;if((pe||oe)&&pe!==oe)return!1}if(!T.call(M,de)||!A(P[de],M[de],de,de,P,M,H))return!1}return!0}var I=s(L);function Z(P,M){return P.source===M.source&&P.flags===M.flags}function he(P,M,A,H){var V=P.size===M.size;if(!V)return!1;if(!P.size)return!0;var se={};return P.forEach(function(de,pe){if(V){var oe=!1,_e=0;M.forEach(function(J,ee){!oe&&!se[_e]&&(oe=A(de,J,pe,ee,P,M,H))&&(se[_e]=!0),_e++}),V=oe}}),V}var Pe=s(he),z=Object.freeze({areArraysEqual:p,areDatesEqual:y,areMapsEqual:_,areObjectsEqual:L,areRegExpsEqual:Z,areSetsEqual:he,createIsNestedEqual:n}),X=Object.freeze({areArraysEqual:f,areDatesEqual:y,areMapsEqual:v,areObjectsEqual:I,areRegExpsEqual:Z,areSetsEqual:Pe,createIsNestedEqual:n}),ye=b(z);function ue(P,M){return ye(P,M,void 0)}var re=b(i(z,{createIsNestedEqual:function(){return c}}));function ne(P,M){return re(P,M,void 0)}var B=b(X);function O(P,M){return B(P,M,new WeakMap)}var Q=b(i(X,{createIsNestedEqual:function(){return c}}));function Y(P,M){return Q(P,M,new WeakMap)}function q(P){return b(i(z,P(z)))}function ie(P){var M=b(i(X,P(X)));return function(A,H,V){return V===void 0&&(V=new WeakMap),M(A,H,V)}}t.circularDeepEqual=O,t.circularShallowEqual=Y,t.createCustomCircularEqual=ie,t.createCustomEqual=q,t.deepEqual=ue,t.sameValueZeroEqual=c,t.shallowEqual=ne,Object.defineProperty(t,"__esModule",{value:!0})})})(xr,xr.exports);var Ir=xr.exports,F={},Qi=function(e,t,n){return e===t?!0:e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)};Object.defineProperty(F,"__esModule",{value:!0});F.bottom=Nr;F.childrenEqual=ea;F.cloneLayout=Zn;F.cloneLayoutItem=Ye;F.collides=Nt;F.compact=ts;F.compactItem=rs;F.compactType=pa;F.correctBounds=ns;F.fastPositionEqual=ta;F.fastRGLPropsEqual=void 0;F.getAllCollisions=ss;F.getFirstCollision=Fe;F.getLayoutItem=Lr;F.getStatics=Ar;F.modifyLayout=es;F.moveElement=dt;F.moveElementAwayFromCollision=_r;F.noop=void 0;F.perc=na;F.resizeItemInDirection=ca;F.setTopLeft=ua;F.setTransform=da;F.sortLayoutItems=Ur;F.sortLayoutItemsByColRow=cs;F.sortLayoutItemsByRowCol=ls;F.synchronizeLayoutWithChildren=fa;F.validateLayout=ha;F.withLayoutItem=Zi;var pn=Ir,ct=Ji(u);function Ji(r){return r&&r.__esModule?r:{default:r}}function Nr(r){let e=0,t;for(let n=0,s=r.length;n<s;n++)t=r[n].y+r[n].h,t>e&&(e=t);return e}function Zn(r){const e=Array(r.length);for(let t=0,n=r.length;t<n;t++)e[t]=Ye(r[t]);return e}function es(r,e){const t=Array(r.length);for(let n=0,s=r.length;n<s;n++)e.i===r[n].i?t[n]=e:t[n]=r[n];return t}function Zi(r,e,t){let n=Lr(r,e);return n?(n=t(Ye(n)),r=es(r,n),[r,n]):[r,null]}function Ye(r){return{w:r.w,h:r.h,x:r.x,y:r.y,i:r.i,minW:r.minW,maxW:r.maxW,minH:r.minH,maxH:r.maxH,moved:!!r.moved,static:!!r.static,isDraggable:r.isDraggable,isResizable:r.isResizable,resizeHandles:r.resizeHandles,isBounded:r.isBounded}}function ea(r,e){return(0,pn.deepEqual)(ct.default.Children.map(r,t=>t?.key),ct.default.Children.map(e,t=>t?.key))&&(0,pn.deepEqual)(ct.default.Children.map(r,t=>t?.props["data-grid"]),ct.default.Children.map(e,t=>t?.props["data-grid"]))}F.fastRGLPropsEqual=Qi;function ta(r,e){return r.left===e.left&&r.top===e.top&&r.width===e.width&&r.height===e.height}function Nt(r,e){return!(r.i===e.i||r.x+r.w<=e.x||r.x>=e.x+e.w||r.y+r.h<=e.y||r.y>=e.y+e.h)}function ts(r,e,t,n){const s=Ar(r),i=Ur(r,e),a=Array(r.length);for(let l=0,c=i.length;l<c;l++){let d=Ye(i[l]);d.static||(d=rs(s,d,e,t,i,n),s.push(d)),a[r.indexOf(i[l])]=d,d.moved=!1}return a}const ra={x:"w",y:"h"};function wr(r,e,t,n){const s=ra[n];e[n]+=1;const i=r.map(a=>a.i).indexOf(e.i);for(let a=i+1;a<r.length;a++){const l=r[a];if(!l.static){if(l.y>e.y+e.h)break;Nt(e,l)&&wr(r,l,t+e[s],n)}}e[n]=t}function rs(r,e,t,n,s,i){const a=t==="vertical",l=t==="horizontal";if(a)for(e.y=Math.min(Nr(r),e.y);e.y>0&&!Fe(r,e);)e.y--;else if(l)for(;e.x>0&&!Fe(r,e);)e.x--;let c;for(;(c=Fe(r,e))&&!(t===null&&i);)if(l?wr(s,e,c.x+c.w,"x"):wr(s,e,c.y+c.h,"y"),l&&e.x+e.w>n)for(e.x=n-e.w,e.y++;e.x>0&&!Fe(r,e);)e.x--;return e.y=Math.max(e.y,0),e.x=Math.max(e.x,0),e}function ns(r,e){const t=Ar(r);for(let n=0,s=r.length;n<s;n++){const i=r[n];if(i.x+i.w>e.cols&&(i.x=e.cols-i.w),i.x<0&&(i.x=0,i.w=e.cols),!i.static)t.push(i);else for(;Fe(t,i);)i.y++}return r}function Lr(r,e){for(let t=0,n=r.length;t<n;t++)if(r[t].i===e)return r[t]}function Fe(r,e){for(let t=0,n=r.length;t<n;t++)if(Nt(r[t],e))return r[t]}function ss(r,e){return r.filter(t=>Nt(t,e))}function Ar(r){return r.filter(e=>e.static)}function dt(r,e,t,n,s,i,a,l,c){if(e.static&&e.isDraggable!==!0||e.y===n&&e.x===t)return r;`${e.i}${String(t)}${String(n)}${e.x}${e.y}`;const d=e.x,h=e.y;typeof t=="number"&&(e.x=t),typeof n=="number"&&(e.y=n),e.moved=!0;let m=Ur(r,a);(a==="vertical"&&typeof n=="number"?h>=n:a==="horizontal"&&typeof t=="number"?d>=t:!1)&&(m=m.reverse());const S=ss(m,e),k=S.length>0;if(k&&c)return Zn(r);if(k&&i)return`${e.i}`,e.x=d,e.y=h,e.moved=!1,r;for(let R=0,E=S.length;R<E;R++){const w=S[R];`${e.i}${e.x}${e.y}${w.i}${w.x}${w.y}`,!w.moved&&(w.static?r=_r(r,w,e,s,a):r=_r(r,e,w,s,a))}return r}function _r(r,e,t,n,s,i){const a=s==="horizontal",l=s==="vertical",c=e.static;if(n){n=!1;const m={x:a?Math.max(e.x-t.w,0):t.x,y:l?Math.max(e.y-t.h,0):t.y,w:t.w,h:t.h,i:"-1"},g=Fe(r,m),S=g&&g.y+g.h>e.y,k=g&&e.x+e.w>g.x;if(g){if(S&&l)return dt(r,t,void 0,e.y+1,n,c,s);if(S&&s==null)return e.y=t.y,t.y=t.y+t.h,r;if(k&&a)return dt(r,e,t.x,void 0,n,c,s)}else return`${t.i}${m.x}${m.y}`,dt(r,t,a?m.x:void 0,l?m.y:void 0,n,c,s)}const d=a?t.x+1:void 0,h=l?t.y+1:void 0;return d==null&&h==null?r:dt(r,t,a?t.x+1:void 0,l?t.y+1:void 0,n,c,s)}function na(r){return r*100+"%"}const os=(r,e,t,n)=>r+t>n?e:t,is=(r,e,t)=>r<0?e:t,as=r=>Math.max(0,r),qr=r=>Math.max(0,r),Wr=(r,e,t)=>{let{left:n,height:s,width:i}=e;const a=r.top-(s-r.height);return{left:n,width:i,height:is(a,r.height,s),top:qr(a)}},$r=(r,e,t)=>{let{top:n,left:s,height:i,width:a}=e;return{top:n,height:i,width:os(r.left,r.width,a,t),left:as(s)}},Br=(r,e,t)=>{let{top:n,height:s,width:i}=e;const a=r.left-(i-r.width);return{height:s,width:a<0?r.width:os(r.left,r.width,i,t),top:qr(n),left:as(a)}},Hr=(r,e,t)=>{let{top:n,left:s,height:i,width:a}=e;return{width:a,left:s,height:is(n,r.height,i),top:qr(n)}},sa=function(){return Wr(arguments.length<=0?void 0:arguments[0],$r(...arguments))},oa=function(){return Wr(arguments.length<=0?void 0:arguments[0],Br(...arguments))},ia=function(){return Hr(arguments.length<=0?void 0:arguments[0],$r(...arguments))},aa=function(){return Hr(arguments.length<=0?void 0:arguments[0],Br(...arguments))},la={n:Wr,ne:sa,e:$r,se:ia,s:Hr,sw:aa,w:Br,nw:oa};function ca(r,e,t,n){const s=la[r];return s?s(e,{...e,...t},n):t}function da(r){let{top:e,left:t,width:n,height:s}=r;const i=`translate(${t}px,${e}px)`;return{transform:i,WebkitTransform:i,MozTransform:i,msTransform:i,OTransform:i,width:`${n}px`,height:`${s}px`,position:"absolute"}}function ua(r){let{top:e,left:t,width:n,height:s}=r;return{top:`${e}px`,left:`${t}px`,width:`${n}px`,height:`${s}px`,position:"absolute"}}function Ur(r,e){return e==="horizontal"?cs(r):e==="vertical"?ls(r):r}function ls(r){return r.slice(0).sort(function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1})}function cs(r){return r.slice(0).sort(function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1})}function fa(r,e,t,n,s){r=r||[];const i=[];ct.default.Children.forEach(e,l=>{if(l?.key==null)return;const c=Lr(r,String(l.key)),d=l.props["data-grid"];c&&d==null?i.push(Ye(c)):d?i.push(Ye({...d,i:l.key})):i.push(Ye({w:1,h:1,x:0,y:Nr(i),i:String(l.key)}))});const a=ns(i,{cols:t});return s?a:ts(a,n,t)}function ha(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout";const t=["x","y","w","h"];if(!Array.isArray(r))throw new Error(e+" must be an array!");for(let n=0,s=r.length;n<s;n++){const i=r[n];for(let a=0;a<t.length;a++){const l=t[a],c=i[l];if(typeof c!="number"||Number.isNaN(c))throw new Error(`ReactGridLayout: ${e}[${n}].${l} must be a number! Received: ${c} (${typeof c})`)}if(typeof i.i<"u"&&typeof i.i!="string")throw new Error(`ReactGridLayout: ${e}[${n}].i must be a string! Received: ${i.i} (${typeof i.i})`)}}function pa(r){const{verticalCompact:e,compactType:t}=r||{};return e===!1?null:t}const ma=()=>{};F.noop=ma;var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.calcGridColWidth=Lt;ke.calcGridItemPosition=ga;ke.calcGridItemWHPx=Sr;ke.calcWH=ba;ke.calcXY=ya;ke.clamp=Ge;function Lt(r){const{margin:e,containerPadding:t,containerWidth:n,cols:s}=r;return(n-e[0]*(s-1)-t[0]*2)/s}function Sr(r,e,t){return Number.isFinite(r)?Math.round(e*r+Math.max(0,r-1)*t):r}function ga(r,e,t,n,s,i){const{margin:a,containerPadding:l,rowHeight:c}=r,d=Lt(r),h={};return i&&i.resizing?(h.width=Math.round(i.resizing.width),h.height=Math.round(i.resizing.height)):(h.width=Sr(n,d,a[0]),h.height=Sr(s,c,a[1])),i&&i.dragging?(h.top=Math.round(i.dragging.top),h.left=Math.round(i.dragging.left)):i&&i.resizing&&typeof i.resizing.top=="number"&&typeof i.resizing.left=="number"?(h.top=Math.round(i.resizing.top),h.left=Math.round(i.resizing.left)):(h.top=Math.round((c+a[1])*t+l[1]),h.left=Math.round((d+a[0])*e+l[0])),h}function ya(r,e,t,n,s){const{margin:i,containerPadding:a,cols:l,rowHeight:c,maxRows:d}=r,h=Lt(r);let m=Math.round((t-a[0])/(h+i[0])),g=Math.round((e-a[1])/(c+i[1]));return m=Ge(m,0,l-n),g=Ge(g,0,d-s),{x:m,y:g}}function ba(r,e,t,n,s,i){const{margin:a,maxRows:l,cols:c,rowHeight:d}=r,h=Lt(r);let m=Math.round((e+a[0])/(h+a[0])),g=Math.round((t+a[1])/(d+a[1])),S=Ge(m,0,c-n),k=Ge(g,0,l-s);return["sw","w","nw"].indexOf(i)!==-1&&(S=Ge(m,0,c)),["nw","n","ne"].indexOf(i)!==-1&&(k=Ge(g,0,l)),{w:S,h:k}}function Ge(r,e,t){return Math.max(Math.min(r,t),e)}var At={},qt={exports:{}},ds={},ce={},ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.dontSetMe=Sa;ze.findInArray=va;ze.int=_a;ze.isFunction=xa;ze.isNum=wa;function va(r,e){for(let t=0,n=r.length;t<n;t++)if(e.apply(e,[r[t],t,r]))return r[t]}function xa(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Function]"}function wa(r){return typeof r=="number"&&!isNaN(r)}function _a(r){return parseInt(r,10)}function Sa(r,e,t){if(r[e])return new Error(`Invalid prop ${e} passed to ${t} - do not set this, set it on the child.`)}var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.browserPrefixToKey=fs;Xe.browserPrefixToStyle=ja;Xe.default=void 0;Xe.getPrefix=us;const or=["Moz","Webkit","O","ms"];function us(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const e=window.document?.documentElement?.style;if(!e||r in e)return"";for(let t=0;t<or.length;t++)if(fs(r,or[t])in e)return or[t];return""}function fs(r,e){return e?`${e}${Ra(r)}`:r}function ja(r,e){return e?`-${e.toLowerCase()}-${r}`:r}function Ra(r){let e="",t=!0;for(let n=0;n<r.length;n++)t?(e+=r[n].toUpperCase(),t=!1):r[n]==="-"?t=!0:e+=r[n];return e}Xe.default=us();Object.defineProperty(ce,"__esModule",{value:!0});ce.addClassName=ms;ce.addEvent=Ea;ce.addUserSelectStyles=Aa;ce.createCSSTransform=Ta;ce.createSVGTransform=Ia;ce.getTouch=Na;ce.getTouchIdentifier=La;ce.getTranslation=Fr;ce.innerHeight=ka;ce.innerWidth=za;ce.matchesSelector=ps;ce.matchesSelectorAndParentsTo=Ca;ce.offsetXYFromParent=Ma;ce.outerHeight=Da;ce.outerWidth=Oa;ce.removeClassName=gs;ce.removeEvent=Pa;ce.scheduleRemoveUserSelectStyles=qa;var Re=ze,mn=hs(Xe);function hs(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(hs=function(s,i){if(!i&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=i?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const d in s)d!=="default"&&{}.hasOwnProperty.call(s,d)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,d))&&(l.get||l.set)?a(c,d,l):c[d]=s[d]);return c})(r,e)}let yt="";function ps(r,e){return yt||(yt=(0,Re.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,Re.isFunction)(r[t])})),(0,Re.isFunction)(r[yt])?r[yt](e):!1}function Ca(r,e,t){let n=r;do{if(ps(n,e))return!0;if(n===t)return!1;n=n.parentNode}while(n);return!1}function Ea(r,e,t,n){if(!r)return;const s={capture:!0,...n};r.addEventListener?r.addEventListener(e,t,s):r.attachEvent?r.attachEvent("on"+e,t):r["on"+e]=t}function Pa(r,e,t,n){if(!r)return;const s={capture:!0,...n};r.removeEventListener?r.removeEventListener(e,t,s):r.detachEvent?r.detachEvent("on"+e,t):r["on"+e]=null}function Da(r){let e=r.clientHeight;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e+=(0,Re.int)(t.borderTopWidth),e+=(0,Re.int)(t.borderBottomWidth),e}function Oa(r){let e=r.clientWidth;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e+=(0,Re.int)(t.borderLeftWidth),e+=(0,Re.int)(t.borderRightWidth),e}function ka(r){let e=r.clientHeight;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e-=(0,Re.int)(t.paddingTop),e-=(0,Re.int)(t.paddingBottom),e}function za(r){let e=r.clientWidth;const t=r.ownerDocument.defaultView.getComputedStyle(r);return e-=(0,Re.int)(t.paddingLeft),e-=(0,Re.int)(t.paddingRight),e}function Ma(r,e,t){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(r.clientX+e.scrollLeft-s.left)/t,a=(r.clientY+e.scrollTop-s.top)/t;return{x:i,y:a}}function Ta(r,e){const t=Fr(r,e,"px");return{[(0,mn.browserPrefixToKey)("transform",mn.default)]:t}}function Ia(r,e){return Fr(r,e,"")}function Fr(r,e,t){let{x:n,y:s}=r,i=`translate(${n}${t},${s}${t})`;if(e){const a=`${typeof e.x=="string"?e.x:e.x+t}`,l=`${typeof e.y=="string"?e.y:e.y+t}`;i=`translate(${a}, ${l})`+i}return i}function Na(r,e){return r.targetTouches&&(0,Re.findInArray)(r.targetTouches,t=>e===t.identifier)||r.changedTouches&&(0,Re.findInArray)(r.changedTouches,t=>e===t.identifier)}function La(r){if(r.targetTouches&&r.targetTouches[0])return r.targetTouches[0].identifier;if(r.changedTouches&&r.changedTouches[0])return r.changedTouches[0].identifier}function Aa(r){if(!r)return;let e=r.getElementById("react-draggable-style-el");e||(e=r.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,r.getElementsByTagName("head")[0].appendChild(e)),r.body&&ms(r.body,"react-draggable-transparent-selection")}function qa(r){window.requestAnimationFrame?window.requestAnimationFrame(()=>{gn(r)}):gn(r)}function gn(r){if(r)try{if(r.body&&gs(r.body,"react-draggable-transparent-selection"),r.selection)r.selection.empty();else{const e=(r.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function ms(r,e){r.classList?r.classList.add(e):r.className.match(new RegExp(`(?:^|\\s)${e}(?!\\S)`))||(r.className+=` ${e}`)}function gs(r,e){r.classList?r.classList.remove(e):r.className=r.className.replace(new RegExp(`(?:^|\\s)${e}(?!\\S)`,"g"),"")}var Me={};Object.defineProperty(Me,"__esModule",{value:!0});Me.canDragX=Ba;Me.canDragY=Ha;Me.createCoreData=Fa;Me.createDraggableData=Ga;Me.getBoundPosition=Wa;Me.getControlPosition=Ua;Me.snapToGrid=$a;var je=ze,tt=ce;function Wa(r,e,t){if(!r.props.bounds)return[e,t];let{bounds:n}=r.props;n=typeof n=="string"?n:Va(n);const s=Gr(r);if(typeof n=="string"){const{ownerDocument:i}=s,a=i.defaultView;let l;if(n==="parent"?l=s.parentNode:l=s.getRootNode().querySelector(n),!(l instanceof a.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');const c=l,d=a.getComputedStyle(s),h=a.getComputedStyle(c);n={left:-s.offsetLeft+(0,je.int)(h.paddingLeft)+(0,je.int)(d.marginLeft),top:-s.offsetTop+(0,je.int)(h.paddingTop)+(0,je.int)(d.marginTop),right:(0,tt.innerWidth)(c)-(0,tt.outerWidth)(s)-s.offsetLeft+(0,je.int)(h.paddingRight)-(0,je.int)(d.marginRight),bottom:(0,tt.innerHeight)(c)-(0,tt.outerHeight)(s)-s.offsetTop+(0,je.int)(h.paddingBottom)-(0,je.int)(d.marginBottom)}}return(0,je.isNum)(n.right)&&(e=Math.min(e,n.right)),(0,je.isNum)(n.bottom)&&(t=Math.min(t,n.bottom)),(0,je.isNum)(n.left)&&(e=Math.max(e,n.left)),(0,je.isNum)(n.top)&&(t=Math.max(t,n.top)),[e,t]}function $a(r,e,t){const n=Math.round(e/r[0])*r[0],s=Math.round(t/r[1])*r[1];return[n,s]}function Ba(r){return r.props.axis==="both"||r.props.axis==="x"}function Ha(r){return r.props.axis==="both"||r.props.axis==="y"}function Ua(r,e,t){const n=typeof e=="number"?(0,tt.getTouch)(r,e):null;if(typeof e=="number"&&!n)return null;const s=Gr(t),i=t.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,tt.offsetXYFromParent)(n||r,i,t.props.scale)}function Fa(r,e,t){const n=!(0,je.isNum)(r.lastX),s=Gr(r);return n?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:t,x:e,y:t}:{node:s,deltaX:e-r.lastX,deltaY:t-r.lastY,lastX:r.lastX,lastY:r.lastY,x:e,y:t}}function Ga(r,e){const t=r.props.scale;return{node:e.node,x:r.state.x+e.deltaX/t,y:r.state.y+e.deltaY/t,deltaX:e.deltaX/t,deltaY:e.deltaY/t,lastX:r.state.x,lastY:r.state.y}}function Va(r){return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}function Gr(r){const e=r.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var Wt={},$t={};Object.defineProperty($t,"__esModule",{value:!0});$t.default=Ya;function Ya(){}Object.defineProperty(Wt,"__esModule",{value:!0});Wt.default=void 0;var ir=ys(u),be=Vr(We),Xa=Vr(kt),me=ce,Le=Me,ar=ze,it=Vr($t);function Vr(r){return r&&r.__esModule?r:{default:r}}function ys(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(ys=function(s,i){if(!i&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=i?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const d in s)d!=="default"&&{}.hasOwnProperty.call(s,d)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,d))&&(l.get||l.set)?a(c,d,l):c[d]=s[d]);return c})(r,e)}function ve(r,e,t){return(e=Ka(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ka(r){var e=Qa(r,"string");return typeof e=="symbol"?e:e+""}function Qa(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const De={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Ae=De.mouse,Bt=class extends ir.Component{constructor(){super(...arguments),ve(this,"dragging",!1),ve(this,"lastX",NaN),ve(this,"lastY",NaN),ve(this,"touchIdentifier",null),ve(this,"mounted",!1),ve(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=t;if(this.props.disabled||!(e.target instanceof n.defaultView.Node)||this.props.handle&&!(0,me.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,me.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;e.type==="touchstart"&&!this.props.allowMobileScroll&&e.preventDefault();const s=(0,me.getTouchIdentifier)(e);this.touchIdentifier=s;const i=(0,Le.getControlPosition)(e,s,this);if(i==null)return;const{x:a,y:l}=i,c=(0,Le.createCoreData)(this,a,l);(0,it.default)("DraggableCore: handleDragStart: %j",c),(0,it.default)("calling",this.props.onStart),!(this.props.onStart(e,c)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,me.addUserSelectStyles)(n),this.dragging=!0,this.lastX=a,this.lastY=l,(0,me.addEvent)(n,Ae.move,this.handleDrag),(0,me.addEvent)(n,Ae.stop,this.handleDragStop))}),ve(this,"handleDrag",e=>{const t=(0,Le.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:n,y:s}=t;if(Array.isArray(this.props.grid)){let l=n-this.lastX,c=s-this.lastY;if([l,c]=(0,Le.snapToGrid)(this.props.grid,l,c),!l&&!c)return;n=this.lastX+l,s=this.lastY+c}const i=(0,Le.createCoreData)(this,n,s);if((0,it.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(e,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const c=document.createEvent("MouseEvents");c.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(c)}return}this.lastX=n,this.lastY=s}),ve(this,"handleDragStop",e=>{if(!this.dragging)return;const t=(0,Le.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:n,y:s}=t;if(Array.isArray(this.props.grid)){let c=n-this.lastX||0,d=s-this.lastY||0;[c,d]=(0,Le.snapToGrid)(this.props.grid,c,d),n=this.lastX+c,s=this.lastY+d}const i=(0,Le.createCoreData)(this,n,s);if(this.props.onStop(e,i)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,me.scheduleRemoveUserSelectStyles)(l.ownerDocument),(0,it.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,it.default)("DraggableCore: Removing handlers"),(0,me.removeEvent)(l.ownerDocument,Ae.move,this.handleDrag),(0,me.removeEvent)(l.ownerDocument,Ae.stop,this.handleDragStop))}),ve(this,"onMouseDown",e=>(Ae=De.mouse,this.handleDragStart(e))),ve(this,"onMouseUp",e=>(Ae=De.mouse,this.handleDragStop(e))),ve(this,"onTouchStart",e=>(Ae=De.touch,this.handleDragStart(e))),ve(this,"onTouchEnd",e=>(Ae=De.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,me.addEvent)(e,De.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,me.removeEvent)(t,De.mouse.move,this.handleDrag),(0,me.removeEvent)(t,De.touch.move,this.handleDrag),(0,me.removeEvent)(t,De.mouse.stop,this.handleDragStop),(0,me.removeEvent)(t,De.touch.stop,this.handleDragStop),(0,me.removeEvent)(e,De.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,me.scheduleRemoveUserSelectStyles)(t)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:Xa.default.findDOMNode(this)}render(){return ir.cloneElement(ir.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Wt.default=Bt;ve(Bt,"displayName","DraggableCore");ve(Bt,"propTypes",{allowAnyClick:be.default.bool,allowMobileScroll:be.default.bool,children:be.default.node.isRequired,disabled:be.default.bool,enableUserSelectHack:be.default.bool,offsetParent:function(r,e){if(r[e]&&r[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:be.default.arrayOf(be.default.number),handle:be.default.string,cancel:be.default.string,nodeRef:be.default.object,onStart:be.default.func,onDrag:be.default.func,onStop:be.default.func,onMouseDown:be.default.func,scale:be.default.number,className:ar.dontSetMe,style:ar.dontSetMe,transform:ar.dontSetMe});ve(Bt,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DraggableCore",{enumerable:!0,get:function(){return c.default}}),r.default=void 0;var e=m(u),t=h(We),n=h(kt),s=zt,i=ce,a=Me,l=ze,c=h(Wt),d=h($t);function h(w){return w&&w.__esModule?w:{default:w}}function m(w,D){if(typeof WeakMap=="function")var b=new WeakMap,p=new WeakMap;return(m=function(f,y){if(!y&&f&&f.__esModule)return f;var _,v,C={__proto__:null,default:f};if(f===null||typeof f!="object"&&typeof f!="function")return C;if(_=y?p:b){if(_.has(f))return _.get(f);_.set(f,C)}for(const T in f)T!=="default"&&{}.hasOwnProperty.call(f,T)&&((v=(_=Object.defineProperty)&&Object.getOwnPropertyDescriptor(f,T))&&(v.get||v.set)?_(C,T,v):C[T]=f[T]);return C})(w,D)}function g(){return g=Object.assign?Object.assign.bind():function(w){for(var D=1;D<arguments.length;D++){var b=arguments[D];for(var p in b)({}).hasOwnProperty.call(b,p)&&(w[p]=b[p])}return w},g.apply(null,arguments)}function S(w,D,b){return(D=k(D))in w?Object.defineProperty(w,D,{value:b,enumerable:!0,configurable:!0,writable:!0}):w[D]=b,w}function k(w){var D=R(w,"string");return typeof D=="symbol"?D:D+""}function R(w,D){if(typeof w!="object"||!w)return w;var b=w[Symbol.toPrimitive];if(b!==void 0){var p=b.call(w,D);if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(w)}class E extends e.Component{static getDerivedStateFromProps(D,b){let{position:p}=D,{prevPropsPosition:f}=b;return p&&(!f||p.x!==f.x||p.y!==f.y)?((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:p,prevPropsPosition:f}),{x:p.x,y:p.y,prevPropsPosition:{...p}}):null}constructor(D){super(D),S(this,"onDragStart",(b,p)=>{if((0,d.default)("Draggable: onDragStart: %j",p),this.props.onStart(b,(0,a.createDraggableData)(this,p))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),S(this,"onDrag",(b,p)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",p);const f=(0,a.createDraggableData)(this,p),y={x:f.x,y:f.y,slackX:0,slackY:0};if(this.props.bounds){const{x:v,y:C}=y;y.x+=this.state.slackX,y.y+=this.state.slackY;const[T,L]=(0,a.getBoundPosition)(this,y.x,y.y);y.x=T,y.y=L,y.slackX=this.state.slackX+(v-y.x),y.slackY=this.state.slackY+(C-y.y),f.x=y.x,f.y=y.y,f.deltaX=y.x-this.state.x,f.deltaY=y.y-this.state.y}if(this.props.onDrag(b,f)===!1)return!1;this.setState(y)}),S(this,"onDragStop",(b,p)=>{if(!this.state.dragging||this.props.onStop(b,(0,a.createDraggableData)(this,p))===!1)return!1;(0,d.default)("Draggable: onDragStop: %j",p);const y={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:v,y:C}=this.props.position;y.x=v,y.y=C}this.setState(y)}),this.state={dragging:!1,dragged:!1,x:D.position?D.position.x:D.defaultPosition.x,y:D.position?D.position.y:D.defaultPosition.y,prevPropsPosition:{...D.position},slackX:0,slackY:0,isElementSVG:!1},D.position&&(D.onDrag||D.onStop)}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??n.default.findDOMNode(this)}render(){const{axis:D,bounds:b,children:p,defaultPosition:f,defaultClassName:y,defaultClassNameDragging:_,defaultClassNameDragged:v,position:C,positionOffset:T,scale:L,...I}=this.props;let Z={},he=null;const z=!!!C||this.state.dragging,X=C||f,ye={x:(0,a.canDragX)(this)&&z?this.state.x:X.x,y:(0,a.canDragY)(this)&&z?this.state.y:X.y};this.state.isElementSVG?he=(0,i.createSVGTransform)(ye,T):Z=(0,i.createCSSTransform)(ye,T);const ue=(0,s.clsx)(p.props.className||"",y,{[_]:this.state.dragging,[v]:this.state.dragged});return e.createElement(c.default,g({},I,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(p),{className:ue,style:{...p.props.style,...Z},transform:he}))}}r.default=E,S(E,"displayName","Draggable"),S(E,"propTypes",{...c.default.propTypes,axis:t.default.oneOf(["both","x","y","none"]),bounds:t.default.oneOfType([t.default.shape({left:t.default.number,right:t.default.number,top:t.default.number,bottom:t.default.number}),t.default.string,t.default.oneOf([!1])]),defaultClassName:t.default.string,defaultClassNameDragging:t.default.string,defaultClassNameDragged:t.default.string,defaultPosition:t.default.shape({x:t.default.number,y:t.default.number}),positionOffset:t.default.shape({x:t.default.oneOfType([t.default.number,t.default.string]),y:t.default.oneOfType([t.default.number,t.default.string])}),position:t.default.shape({x:t.default.number,y:t.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),S(E,"defaultProps",{...c.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(ds);const{default:bs,DraggableCore:Ja}=ds;qt.exports=bs;qt.exports.default=bs;qt.exports.DraggableCore=Ja;var vs=qt.exports,Ht={exports:{}},ht={},Yr={};Yr.__esModule=!0;Yr.cloneElement=sl;var Za=el(u);function el(r){return r&&r.__esModule?r:{default:r}}function yn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function bn(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yn(Object(t),!0).forEach(function(n){tl(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):yn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function tl(r,e,t){return e=rl(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function rl(r){var e=nl(r,"string");return typeof e=="symbol"?e:String(e)}function nl(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function sl(r,e){return e.style&&r.props.style&&(e.style=bn(bn({},r.props.style),e.style)),e.className&&r.props.className&&(e.className=r.props.className+" "+e.className),Za.default.cloneElement(r,e)}var pt={};pt.__esModule=!0;pt.resizableProps=void 0;var W=ol(We);function ol(r){return r&&r.__esModule?r:{default:r}}var il={axis:W.default.oneOf(["both","x","y","none"]),className:W.default.string,children:W.default.element.isRequired,draggableOpts:W.default.shape({allowAnyClick:W.default.bool,cancel:W.default.string,children:W.default.node,disabled:W.default.bool,enableUserSelectHack:W.default.bool,offsetParent:W.default.node,grid:W.default.arrayOf(W.default.number),handle:W.default.string,nodeRef:W.default.object,onStart:W.default.func,onDrag:W.default.func,onStop:W.default.func,onMouseDown:W.default.func,scale:W.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t[0];if(s.axis==="both"||s.axis==="y"){var i;return(i=W.default.number).isRequired.apply(i,t)}return W.default.number.apply(W.default,t)},handle:W.default.oneOfType([W.default.node,W.default.func]),handleSize:W.default.arrayOf(W.default.number),lockAspectRatio:W.default.bool,maxConstraints:W.default.arrayOf(W.default.number),minConstraints:W.default.arrayOf(W.default.number),onResizeStop:W.default.func,onResizeStart:W.default.func,onResize:W.default.func,resizeHandles:W.default.arrayOf(W.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:W.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t[0];if(s.axis==="both"||s.axis==="x"){var i;return(i=W.default.number).isRequired.apply(i,t)}return W.default.number.apply(W.default,t)}};pt.resizableProps=il;ht.__esModule=!0;ht.default=void 0;var at=ul(u),al=vs,ll=Yr,cl=pt,dl=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function xs(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(xs=function(s){return s?t:e})(r)}function ul(r,e){if(r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=xs(e);if(t&&t.has(r))return t.get(r);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var a=s?Object.getOwnPropertyDescriptor(r,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=r[i]}return n.default=r,t&&t.set(r,n),n}function jr(){return jr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},jr.apply(this,arguments)}function fl(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function vn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function lr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vn(Object(t),!0).forEach(function(n){hl(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):vn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function hl(r,e,t){return e=pl(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function pl(r){var e=ml(r,"string");return typeof e=="symbol"?e:String(e)}function ml(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gl(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Rr(r,e)}function Rr(r,e){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Rr(r,e)}var Xr=function(r){gl(e,r);function e(){for(var n,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return n=r.call.apply(r,[this].concat(i))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var t=e.prototype;return t.componentWillUnmount=function(){this.resetData()},t.resetData=function(){this.lastHandleRect=this.slack=null},t.runConstraints=function(s,i){var a=this.props,l=a.minConstraints,c=a.maxConstraints,d=a.lockAspectRatio;if(!l&&!c&&!d)return[s,i];if(d){var h=this.props.width/this.props.height,m=s-this.props.width,g=i-this.props.height;Math.abs(m)>Math.abs(g*h)?i=s/h:s=i*h}var S=s,k=i,R=this.slack||[0,0],E=R[0],w=R[1];return s+=E,i+=w,l&&(s=Math.max(l[0],s),i=Math.max(l[1],i)),c&&(s=Math.min(c[0],s),i=Math.min(c[1],i)),this.slack=[E+(S-s),w+(k-i)],[s,i]},t.resizeHandler=function(s,i){var a=this;return function(l,c){var d=c.node,h=c.deltaX,m=c.deltaY;s==="onResizeStart"&&a.resetData();var g=(a.props.axis==="both"||a.props.axis==="x")&&i!=="n"&&i!=="s",S=(a.props.axis==="both"||a.props.axis==="y")&&i!=="e"&&i!=="w";if(!(!g&&!S)){var k=i[0],R=i[i.length-1],E=d.getBoundingClientRect();if(a.lastHandleRect!=null){if(R==="w"){var w=E.left-a.lastHandleRect.left;h+=w}if(k==="n"){var D=E.top-a.lastHandleRect.top;m+=D}}a.lastHandleRect=E,R==="w"&&(h=-h),k==="n"&&(m=-m);var b=a.props.width+(g?h/a.props.transformScale:0),p=a.props.height+(S?m/a.props.transformScale:0),f=a.runConstraints(b,p);b=f[0],p=f[1];var y=b!==a.props.width||p!==a.props.height,_=typeof a.props[s]=="function"?a.props[s]:null,v=s==="onResize"&&!y;_&&!v&&(l.persist==null||l.persist(),_(l,{node:d,size:{width:b,height:p},handle:i})),s==="onResizeStop"&&a.resetData()}}},t.renderResizeHandle=function(s,i){var a=this.props.handle;if(!a)return at.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+s,ref:i});if(typeof a=="function")return a(s,i);var l=typeof a.type=="string",c=lr({ref:i},l?{}:{handleAxis:s});return at.cloneElement(a,c)},t.render=function(){var s=this,i=this.props,a=i.children,l=i.className,c=i.draggableOpts;i.width,i.height,i.handle,i.handleSize,i.lockAspectRatio,i.axis,i.minConstraints,i.maxConstraints,i.onResize,i.onResizeStop,i.onResizeStart;var d=i.resizeHandles;i.transformScale;var h=fl(i,dl);return(0,ll.cloneElement)(a,lr(lr({},h),{},{className:(l?l+" ":"")+"react-resizable",children:[].concat(a.props.children,d.map(function(m){var g,S=(g=s.handleRefs[m])!=null?g:s.handleRefs[m]=at.createRef();return at.createElement(al.DraggableCore,jr({},c,{nodeRef:S,key:"resizableHandle-"+m,onStop:s.resizeHandler("onResizeStop",m),onStart:s.resizeHandler("onResizeStart",m),onDrag:s.resizeHandler("onResize",m)}),s.renderResizeHandle(m,S))}))}))},e}(at.Component);ht.default=Xr;Xr.propTypes=cl.resizableProps;Xr.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1};var Ut={};Ut.__esModule=!0;Ut.default=void 0;var cr=wl(u),yl=ws(We),bl=ws(ht),vl=pt,xl=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function ws(r){return r&&r.__esModule?r:{default:r}}function _s(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(_s=function(s){return s?t:e})(r)}function wl(r,e){if(r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=_s(e);if(t&&t.has(r))return t.get(r);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var a=s?Object.getOwnPropertyDescriptor(r,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=r[i]}return n.default=r,t&&t.set(r,n),n}function Cr(){return Cr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Cr.apply(this,arguments)}function xn(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function Ct(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xn(Object(t),!0).forEach(function(n){_l(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):xn(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function _l(r,e,t){return e=Sl(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Sl(r){var e=jl(r,"string");return typeof e=="symbol"?e:String(e)}function jl(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Rl(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function Cl(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Er(r,e)}function Er(r,e){return Er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Er(r,e)}var Ss=function(r){Cl(e,r);function e(){for(var n,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return n=r.call.apply(r,[this].concat(i))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(l,c){var d=c.size;n.props.onResize?(l.persist==null||l.persist(),n.setState(d,function(){return n.props.onResize&&n.props.onResize(l,c)})):n.setState(d)},n}e.getDerivedStateFromProps=function(s,i){return i.propsWidth!==s.width||i.propsHeight!==s.height?{width:s.width,height:s.height,propsWidth:s.width,propsHeight:s.height}:null};var t=e.prototype;return t.render=function(){var s=this.props,i=s.handle,a=s.handleSize;s.onResize;var l=s.onResizeStart,c=s.onResizeStop,d=s.draggableOpts,h=s.minConstraints,m=s.maxConstraints,g=s.lockAspectRatio,S=s.axis;s.width,s.height;var k=s.resizeHandles,R=s.style,E=s.transformScale,w=Rl(s,xl);return cr.createElement(bl.default,{axis:S,draggableOpts:d,handle:i,handleSize:a,height:this.state.height,lockAspectRatio:g,maxConstraints:m,minConstraints:h,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:k,transformScale:E,width:this.state.width},cr.createElement("div",Cr({},w,{style:Ct(Ct({},R),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},e}(cr.Component);Ut.default=Ss;Ss.propTypes=Ct(Ct({},vl.resizableProps),{},{children:yl.default.element});Ht.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};Ht.exports.Resizable=ht.default;Ht.exports.ResizableBox=Ut.default;var El=Ht.exports,Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.resizeHandleType=Ie.resizeHandleAxesType=Ie.default=void 0;var $=js(We),Pl=js(u);function js(r){return r&&r.__esModule?r:{default:r}}const Dl=Ie.resizeHandleAxesType=$.default.arrayOf($.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),Ol=Ie.resizeHandleType=$.default.oneOfType([$.default.node,$.default.func]);Ie.default={className:$.default.string,style:$.default.object,width:$.default.number,autoSize:$.default.bool,cols:$.default.number,draggableCancel:$.default.string,draggableHandle:$.default.string,verticalCompact:function(r){r.verticalCompact},compactType:$.default.oneOf(["vertical","horizontal"]),layout:function(r){var e=r.layout;e!==void 0&&F.validateLayout(e,"layout")},margin:$.default.arrayOf($.default.number),containerPadding:$.default.arrayOf($.default.number),rowHeight:$.default.number,maxRows:$.default.number,isBounded:$.default.bool,isDraggable:$.default.bool,isResizable:$.default.bool,allowOverlap:$.default.bool,preventCollision:$.default.bool,useCSSTransforms:$.default.bool,transformScale:$.default.number,isDroppable:$.default.bool,resizeHandles:Dl,resizeHandle:Ol,onLayoutChange:$.default.func,onDragStart:$.default.func,onDrag:$.default.func,onDragStop:$.default.func,onResizeStart:$.default.func,onResize:$.default.func,onResizeStop:$.default.func,onDrop:$.default.func,droppingItem:$.default.shape({i:$.default.string.isRequired,w:$.default.number.isRequired,h:$.default.number.isRequired}),children:function(r,e){const t=r[e],n={};Pl.default.Children.forEach(t,function(s){if(s?.key!=null){if(n[s.key])throw new Error('Duplicate child key "'+s.key+'" found! This will cause problems in ReactGridLayout.');n[s.key]=!0}})},innerRef:$.default.any};Object.defineProperty(At,"__esModule",{value:!0});At.default=void 0;var Je=Kr(u),wn=kt,K=Kr(We),kl=vs,zl=El,Ze=F,fe=ke,_n=Ie,Ml=Kr(zt);function Kr(r){return r&&r.__esModule?r:{default:r}}function Oe(r,e,t){return(e=Tl(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Tl(r){var e=Il(r,"string");return typeof e=="symbol"?e:e+""}function Il(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Qr extends Je.default.Component{constructor(){super(...arguments),Oe(this,"state",{resizing:null,dragging:null,className:""}),Oe(this,"elementRef",Je.default.createRef()),Oe(this,"onDragStart",(e,t)=>{let{node:n}=t;const{onDragStart:s,transformScale:i}=this.props;if(!s)return;const a={top:0,left:0},{offsetParent:l}=n;if(!l)return;const c=l.getBoundingClientRect(),d=n.getBoundingClientRect(),h=d.left/i,m=c.left/i,g=d.top/i,S=c.top/i;a.left=h-m+l.scrollLeft,a.top=g-S+l.scrollTop,this.setState({dragging:a});const{x:k,y:R}=(0,fe.calcXY)(this.getPositionParams(),a.top,a.left,this.props.w,this.props.h);return s.call(this,this.props.i,k,R,{e,node:n,newPosition:a})}),Oe(this,"onDrag",(e,t,n)=>{let{node:s,deltaX:i,deltaY:a}=t;const{onDrag:l}=this.props;if(!l)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let c=this.state.dragging.top+a,d=this.state.dragging.left+i;const{isBounded:h,i:m,w:g,h:S,containerWidth:k}=this.props,R=this.getPositionParams();if(h){const{offsetParent:b}=s;if(b){const{margin:p,rowHeight:f}=this.props,y=b.clientHeight-(0,fe.calcGridItemWHPx)(S,f,p[1]);c=(0,fe.clamp)(c,0,y);const _=(0,fe.calcGridColWidth)(R),v=k-(0,fe.calcGridItemWHPx)(g,_,p[0]);d=(0,fe.clamp)(d,0,v)}}const E={top:c,left:d};n?this.setState({dragging:E}):(0,wn.flushSync)(()=>{this.setState({dragging:E})});const{x:w,y:D}=(0,fe.calcXY)(R,c,d,g,S);return l.call(this,m,w,D,{e,node:s,newPosition:E})}),Oe(this,"onDragStop",(e,t)=>{let{node:n}=t;const{onDragStop:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:i,h:a,i:l}=this.props,{left:c,top:d}=this.state.dragging,h={top:d,left:c};this.setState({dragging:null});const{x:m,y:g}=(0,fe.calcXY)(this.getPositionParams(),d,c,i,a);return s.call(this,l,m,g,{e,node:n,newPosition:h})}),Oe(this,"onResizeStop",(e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStop")),Oe(this,"onResizeStart",(e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStart")),Oe(this,"onResize",(e,t,n)=>this.onResizeHandler(e,t,n,"onResize"))}shouldComponentUpdate(e,t){if(this.props.children!==e.children||this.props.droppingPosition!==e.droppingPosition)return!0;const n=(0,fe.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),s=(0,fe.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,Ze.fastPositionEqual)(n,s)||this.props.useCSSTransforms!==e.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(e){this.moveDroppingItem(e)}moveDroppingItem(e){const{droppingPosition:t}=this.props;if(!t)return;const n=this.elementRef.current;if(!n)return;const s=e.droppingPosition||{left:0,top:0},{dragging:i}=this.state,a=i&&t.left!==s.left||t.top!==s.top;if(!i)this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top});else if(a){const l=t.left-i.left,c=t.top-i.top;this.onDrag(t.e,{node:n,deltaX:l,deltaY:c},!0)}}getPositionParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}createStyle(e){const{usePercentages:t,containerWidth:n,useCSSTransforms:s}=this.props;let i;return s?i=(0,Ze.setTransform)(e):(i=(0,Ze.setTopLeft)(e),t&&(i.left=(0,Ze.perc)(e.left/n),i.width=(0,Ze.perc)(e.width/n))),i}mixinDraggable(e,t){return Je.default.createElement(kl.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}curryResizeHandler(e,t){return(n,s)=>t(n,s,e)}mixinResizable(e,t,n){const{cols:s,minW:i,minH:a,maxW:l,maxH:c,transformScale:d,resizeHandles:h,resizeHandle:m}=this.props,g=this.getPositionParams(),S=(0,fe.calcGridItemPosition)(g,0,0,s,0).width,k=(0,fe.calcGridItemPosition)(g,0,0,i,a),R=(0,fe.calcGridItemPosition)(g,0,0,l,c),E=[k.width,k.height],w=[Math.min(R.width,S),Math.min(R.height,1/0)];return Je.default.createElement(zl.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:E,maxConstraints:w,onResizeStop:this.curryResizeHandler(t,this.onResizeStop),onResizeStart:this.curryResizeHandler(t,this.onResizeStart),onResize:this.curryResizeHandler(t,this.onResize),transformScale:d,resizeHandles:h,handle:m},e)}onResizeHandler(e,t,n,s){let{node:i,size:a,handle:l}=t;const c=this.props[s];if(!c)return;const{x:d,y:h,i:m,maxH:g,minH:S,containerWidth:k}=this.props,{minW:R,maxW:E}=this.props;let w=a;i&&(w=(0,Ze.resizeItemInDirection)(l,n,a,k),(0,wn.flushSync)(()=>{this.setState({resizing:s==="onResizeStop"?null:w})}));let{w:D,h:b}=(0,fe.calcWH)(this.getPositionParams(),w.width,w.height,d,h,l);D=(0,fe.clamp)(D,Math.max(R,1),E),b=(0,fe.clamp)(b,S,g),c.call(this,m,D,b,{e,node:i,size:w,handle:l})}render(){const{x:e,y:t,w:n,h:s,isDraggable:i,isResizable:a,droppingPosition:l,useCSSTransforms:c}=this.props,d=(0,fe.calcGridItemPosition)(this.getPositionParams(),e,t,n,s,this.state),h=Je.default.Children.only(this.props.children);let m=Je.default.cloneElement(h,{ref:this.elementRef,className:(0,Ml.default)("react-grid-item",h.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":i,"react-draggable-dragging":!!this.state.dragging,dropping:!!l,cssTransforms:c}),style:{...this.props.style,...h.props.style,...this.createStyle(d)}});return m=this.mixinResizable(m,d,a),m=this.mixinDraggable(m,i),m}}At.default=Qr;Oe(Qr,"propTypes",{children:K.default.element,cols:K.default.number.isRequired,containerWidth:K.default.number.isRequired,rowHeight:K.default.number.isRequired,margin:K.default.array.isRequired,maxRows:K.default.number.isRequired,containerPadding:K.default.array.isRequired,x:K.default.number.isRequired,y:K.default.number.isRequired,w:K.default.number.isRequired,h:K.default.number.isRequired,minW:function(r,e){const t=r[e];if(typeof t!="number")return new Error("minWidth not Number");if(t>r.w||t>r.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(r,e){const t=r[e];if(typeof t!="number")return new Error("maxWidth not Number");if(t<r.w||t<r.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(r,e){const t=r[e];if(typeof t!="number")return new Error("minHeight not Number");if(t>r.h||t>r.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(r,e){const t=r[e];if(typeof t!="number")return new Error("maxHeight not Number");if(t<r.h||t<r.minH)return new Error("maxHeight smaller than item height/minHeight")},i:K.default.string.isRequired,resizeHandles:_n.resizeHandleAxesType,resizeHandle:_n.resizeHandleType,onDragStop:K.default.func,onDragStart:K.default.func,onDrag:K.default.func,onResizeStop:K.default.func,onResizeStart:K.default.func,onResize:K.default.func,isDraggable:K.default.bool.isRequired,isResizable:K.default.bool.isRequired,isBounded:K.default.bool.isRequired,static:K.default.bool,useCSSTransforms:K.default.bool.isRequired,transformScale:K.default.number,className:K.default.string,handle:K.default.string,cancel:K.default.string,droppingPosition:K.default.shape({e:K.default.object.isRequired,left:K.default.number.isRequired,top:K.default.number.isRequired})});Oe(Qr,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1});Object.defineProperty(ft,"__esModule",{value:!0});ft.default=void 0;var He=Rs(u),dr=Ir,Nl=Jr(zt),N=F,Ll=ke,Sn=Jr(At),Al=Jr(Ie);function Jr(r){return r&&r.__esModule?r:{default:r}}function Rs(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(Rs=function(s,i){if(!i&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=i?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const d in s)d!=="default"&&{}.hasOwnProperty.call(s,d)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,d))&&(l.get||l.set)?a(c,d,l):c[d]=s[d]);return c})(r,e)}function ge(r,e,t){return(e=ql(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ql(r){var e=Wl(r,"string");return typeof e=="symbol"?e:e+""}function Wl(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const jn="react-grid-layout";let Cs=!1;try{Cs=/firefox/i.test(navigator.userAgent)}catch{}class Ft extends He.Component{constructor(){super(...arguments),ge(this,"state",{activeDrag:null,layout:(0,N.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,N.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),ge(this,"dragEnterCounter",0),ge(this,"onDragStart",(e,t,n,s)=>{let{e:i,node:a}=s;const{layout:l}=this.state,c=(0,N.getLayoutItem)(l,e);if(!c)return;const d={w:c.w,h:c.h,x:c.x,y:c.y,placeholder:!0,i:e};return this.setState({oldDragItem:(0,N.cloneLayoutItem)(c),oldLayout:l,activeDrag:d}),this.props.onDragStart(l,c,c,null,i,a)}),ge(this,"onDrag",(e,t,n,s)=>{let{e:i,node:a}=s;const{oldDragItem:l}=this.state;let{layout:c}=this.state;const{cols:d,allowOverlap:h,preventCollision:m}=this.props,g=(0,N.getLayoutItem)(c,e);if(!g)return;const S={w:g.w,h:g.h,x:g.x,y:g.y,placeholder:!0,i:e};c=(0,N.moveElement)(c,g,t,n,!0,m,(0,N.compactType)(this.props),d,h),this.props.onDrag(c,l,g,S,i,a),this.setState({layout:h?c:(0,N.compact)(c,(0,N.compactType)(this.props),d),activeDrag:S})}),ge(this,"onDragStop",(e,t,n,s)=>{let{e:i,node:a}=s;if(!this.state.activeDrag)return;const{oldDragItem:l}=this.state;let{layout:c}=this.state;const{cols:d,preventCollision:h,allowOverlap:m}=this.props,g=(0,N.getLayoutItem)(c,e);if(!g)return;c=(0,N.moveElement)(c,g,t,n,!0,h,(0,N.compactType)(this.props),d,m);const k=m?c:(0,N.compact)(c,(0,N.compactType)(this.props),d);this.props.onDragStop(k,l,g,null,i,a);const{oldLayout:R}=this.state;this.setState({activeDrag:null,layout:k,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(k,R)}),ge(this,"onResizeStart",(e,t,n,s)=>{let{e:i,node:a}=s;const{layout:l}=this.state,c=(0,N.getLayoutItem)(l,e);c&&(this.setState({oldResizeItem:(0,N.cloneLayoutItem)(c),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(l,c,c,null,i,a))}),ge(this,"onResize",(e,t,n,s)=>{let{e:i,node:a,size:l,handle:c}=s;const{oldResizeItem:d}=this.state,{layout:h}=this.state,{cols:m,preventCollision:g,allowOverlap:S}=this.props;let k=!1,R,E,w;const[D,b]=(0,N.withLayoutItem)(h,e,f=>{let y;return E=f.x,w=f.y,["sw","w","nw","n","ne"].indexOf(c)!==-1&&(["sw","nw","w"].indexOf(c)!==-1&&(E=f.x+(f.w-t),t=f.x!==E&&E<0?f.w:t,E=E<0?0:E),["ne","n","nw"].indexOf(c)!==-1&&(w=f.y+(f.h-n),n=f.y!==w&&w<0?f.h:n,w=w<0?0:w),k=!0),g&&!S&&(y=(0,N.getAllCollisions)(h,{...f,w:t,h:n,x:E,y:w}).filter(v=>v.i!==f.i).length>0,y&&(w=f.y,n=f.h,E=f.x,t=f.w,k=!1)),f.w=t,f.h=n,f});if(!b)return;R=D,k&&(R=(0,N.moveElement)(D,b,E,w,!0,this.props.preventCollision,(0,N.compactType)(this.props),m,S));const p={w:b.w,h:b.h,x:b.x,y:b.y,static:!0,i:e};this.props.onResize(R,d,b,p,i,a),this.setState({layout:S?R:(0,N.compact)(R,(0,N.compactType)(this.props),m),activeDrag:p})}),ge(this,"onResizeStop",(e,t,n,s)=>{let{e:i,node:a}=s;const{layout:l,oldResizeItem:c}=this.state,{cols:d,allowOverlap:h}=this.props,m=(0,N.getLayoutItem)(l,e),g=h?l:(0,N.compact)(l,(0,N.compactType)(this.props),d);this.props.onResizeStop(g,c,m,null,i,a);const{oldLayout:S}=this.state;this.setState({activeDrag:null,layout:g,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(g,S)}),ge(this,"onDragOver",e=>{if(e.preventDefault(),e.stopPropagation(),Cs&&!e.nativeEvent.target?.classList.contains(jn))return!1;const{droppingItem:t,onDropDragOver:n,margin:s,cols:i,rowHeight:a,maxRows:l,width:c,containerPadding:d,transformScale:h}=this.props,m=n?.(e);if(m===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const g={...t,...m},{layout:S}=this.state,k=e.currentTarget.getBoundingClientRect(),R=e.clientX-k.left,E=e.clientY-k.top,w={left:R/h,top:E/h,e};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:D,top:b}=this.state.droppingPosition;(D!=R||b!=E)&&this.setState({droppingPosition:w})}}else{const D={cols:i,margin:s,maxRows:l,rowHeight:a,containerWidth:c,containerPadding:d||s},b=(0,Ll.calcXY)(D,E,R,g.w,g.h);this.setState({droppingDOMNode:He.createElement("div",{key:g.i}),droppingPosition:w,layout:[...S,{...g,x:b.x,y:b.y,static:!1,isDraggable:!0}]})}}),ge(this,"removeDroppingPlaceholder",()=>{const{droppingItem:e,cols:t}=this.props,{layout:n}=this.state,s=(0,N.compact)(n.filter(i=>i.i!==e.i),(0,N.compactType)(this.props),t,this.props.allowOverlap);this.setState({layout:s,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),ge(this,"onDragLeave",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),ge(this,"onDragEnter",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter++}),ge(this,"onDrop",e=>{e.preventDefault(),e.stopPropagation();const{droppingItem:t}=this.props,{layout:n}=this.state,s=n.find(i=>i.i===t.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,s,e)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(e,t){let n;return t.activeDrag?null:(!(0,dr.deepEqual)(e.layout,t.propsLayout)||e.compactType!==t.compactType?n=e.layout:(0,N.childrenEqual)(e.children,t.children)||(n=t.layout),n?{layout:(0,N.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,N.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}shouldComponentUpdate(e,t){return this.props.children!==e.children||!(0,N.fastRGLPropsEqual)(this.props,e,dr.deepEqual)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}componentDidUpdate(e,t){if(!this.state.activeDrag){const n=this.state.layout,s=t.layout;this.onLayoutMaybeChanged(n,s)}}containerHeight(){if(!this.props.autoSize)return;const e=(0,N.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+t*2+"px"}onLayoutMaybeChanged(e,t){t||(t=this.state.layout),(0,dr.deepEqual)(t,e)||this.props.onLayoutChange(e)}placeholder(){const{activeDrag:e}=this.state;if(!e)return null;const{width:t,cols:n,margin:s,containerPadding:i,rowHeight:a,maxRows:l,useCSSTransforms:c,transformScale:d}=this.props;return He.createElement(Sn.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:t,cols:n,margin:s,containerPadding:i||s,maxRows:l,rowHeight:a,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:c,transformScale:d},He.createElement("div",null))}processGridItem(e,t){if(!e||!e.key)return;const n=(0,N.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;const{width:s,cols:i,margin:a,containerPadding:l,rowHeight:c,maxRows:d,isDraggable:h,isResizable:m,isBounded:g,useCSSTransforms:S,transformScale:k,draggableCancel:R,draggableHandle:E,resizeHandles:w,resizeHandle:D}=this.props,{mounted:b,droppingPosition:p}=this.state,f=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&h,y=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&m,_=n.resizeHandles||w,v=f&&g&&n.isBounded!==!1;return He.createElement(Sn.default,{containerWidth:s,cols:i,margin:a,containerPadding:l||a,maxRows:d,rowHeight:c,cancel:R,handle:E,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:f,isResizable:y,isBounded:v,useCSSTransforms:S&&b,usePercentages:!b,transformScale:k,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?p:void 0,resizeHandles:_,resizeHandle:D},e)}render(){const{className:e,style:t,isDroppable:n,innerRef:s}=this.props,i=(0,Nl.default)(jn,e),a={height:this.containerHeight(),...t};return He.createElement("div",{ref:s,className:i,style:a,onDrop:n?this.onDrop:N.noop,onDragLeave:n?this.onDragLeave:N.noop,onDragEnter:n?this.onDragEnter:N.noop,onDragOver:n?this.onDragOver:N.noop},He.Children.map(this.props.children,l=>this.processGridItem(l)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}ft.default=Ft;ge(Ft,"displayName","ReactGridLayout");ge(Ft,"propTypes",Al.default);ge(Ft,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:N.noop,onDragStart:N.noop,onDrag:N.noop,onDragStop:N.noop,onResizeStart:N.noop,onResize:N.noop,onResizeStop:N.noop,onDrop:N.noop,onDropDragOver:N.noop});var Gt={},Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.findOrGenerateResponsiveLayout=Hl;Ke.getBreakpointFromWidth=$l;Ke.getColsFromBreakpoint=Bl;Ke.sortBreakpoints=Zr;var bt=F;function $l(r,e){const t=Zr(r);let n=t[0];for(let s=1,i=t.length;s<i;s++){const a=t[s];e>r[a]&&(n=a)}return n}function Bl(r,e){if(!e[r])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+r+" is missing!");return e[r]}function Hl(r,e,t,n,s,i){if(r[t])return(0,bt.cloneLayout)(r[t]);let a=r[n];const l=Zr(e),c=l.slice(l.indexOf(t));for(let d=0,h=c.length;d<h;d++){const m=c[d];if(r[m]){a=r[m];break}}return a=(0,bt.cloneLayout)(a||[]),(0,bt.compact)((0,bt.correctBounds)(a,{cols:s}),i,s)}function Zr(r){return Object.keys(r).sort(function(t,n){return r[t]-r[n]})}Object.defineProperty(Gt,"__esModule",{value:!0});Gt.default=void 0;var Rn=Ps(u),we=Es(We),ur=Ir,rt=F,Ue=Ke,Ul=Es(ft);function Es(r){return r&&r.__esModule?r:{default:r}}function Ps(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(Ps=function(s,i){if(!i&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=i?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const d in s)d!=="default"&&{}.hasOwnProperty.call(s,d)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,d))&&(l.get||l.set)?a(c,d,l):c[d]=s[d]);return c})(r,e)}function Pr(){return Pr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Pr.apply(null,arguments)}function Et(r,e,t){return(e=Fl(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Fl(r){var e=Gl(r,"string");return typeof e=="symbol"?e:e+""}function Gl(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Cn=r=>Object.prototype.toString.call(r);function vt(r,e){return r==null?null:Array.isArray(r)?r:r[e]}class en extends Rn.Component{constructor(){super(...arguments),Et(this,"state",this.generateInitialState()),Et(this,"onLayoutChange",e=>{this.props.onLayoutChange(e,{...this.props.layouts,[this.state.breakpoint]:e})})}generateInitialState(){const{width:e,breakpoints:t,layouts:n,cols:s}=this.props,i=(0,Ue.getBreakpointFromWidth)(t,e),a=(0,Ue.getColsFromBreakpoint)(i,s),l=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Ue.findOrGenerateResponsiveLayout)(n,t,i,i,a,l),breakpoint:i,cols:a}}static getDerivedStateFromProps(e,t){if(!(0,ur.deepEqual)(e.layouts,t.layouts)){const{breakpoint:n,cols:s}=t;return{layout:(0,Ue.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,s,e.compactType),layouts:e.layouts}}return null}componentDidUpdate(e){(this.props.width!=e.width||this.props.breakpoint!==e.breakpoint||!(0,ur.deepEqual)(this.props.breakpoints,e.breakpoints)||!(0,ur.deepEqual)(this.props.cols,e.cols))&&this.onWidthChange(e)}onWidthChange(e){const{breakpoints:t,cols:n,layouts:s,compactType:i}=this.props,a=this.props.breakpoint||(0,Ue.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),l=this.state.breakpoint,c=(0,Ue.getColsFromBreakpoint)(a,n),d={...s};if(l!==a||e.breakpoints!==t||e.cols!==n){l in d||(d[l]=(0,rt.cloneLayout)(this.state.layout));let g=(0,Ue.findOrGenerateResponsiveLayout)(d,t,a,l,c,i);g=(0,rt.synchronizeLayoutWithChildren)(g,this.props.children,c,i,this.props.allowOverlap),d[a]=g,this.props.onBreakpointChange(a,c),this.props.onLayoutChange(g,d),this.setState({breakpoint:a,layout:g,cols:c})}const h=vt(this.props.margin,a),m=vt(this.props.containerPadding,a);this.props.onWidthChange(this.props.width,h,c,m)}render(){const{breakpoint:e,breakpoints:t,cols:n,layouts:s,margin:i,containerPadding:a,onBreakpointChange:l,onLayoutChange:c,onWidthChange:d,...h}=this.props;return Rn.createElement(Ul.default,Pr({},h,{margin:vt(i,this.state.breakpoint),containerPadding:vt(a,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}Gt.default=en;Et(en,"propTypes",{breakpoint:we.default.string,breakpoints:we.default.object,allowOverlap:we.default.bool,cols:we.default.object,margin:we.default.oneOfType([we.default.array,we.default.object]),containerPadding:we.default.oneOfType([we.default.array,we.default.object]),layouts(r,e){if(Cn(r[e])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+Cn(r[e]));Object.keys(r[e]).forEach(t=>{if(!(t in r.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,rt.validateLayout)(r.layouts[t],"layouts."+t)})},width:we.default.number.isRequired,onBreakpointChange:we.default.func,onLayoutChange:we.default.func,onWidthChange:we.default.func});Et(en,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:rt.noop,onLayoutChange:rt.noop,onWidthChange:rt.noop});var tn={},Ds=function(){if(typeof Map<"u")return Map;function r(e,t){var n=-1;return e.some(function(s,i){return s[0]===t?(n=i,!0):!1}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var n=r(this.__entries__,t),s=this.__entries__[n];return s&&s[1]},e.prototype.set=function(t,n){var s=r(this.__entries__,t);~s?this.__entries__[s][1]=n:this.__entries__.push([t,n])},e.prototype.delete=function(t){var n=this.__entries__,s=r(n,t);~s&&n.splice(s,1)},e.prototype.has=function(t){return!!~r(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,n){n===void 0&&(n=null);for(var s=0,i=this.__entries__;s<i.length;s++){var a=i[s];t.call(n,a[1],a[0])}},e}()}(),Dr=typeof window<"u"&&typeof document<"u"&&window.document===document,Pt=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Vl=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Pt):function(r){return setTimeout(function(){return r(Date.now())},1e3/60)}}(),Yl=2;function Xl(r,e){var t=!1,n=!1,s=0;function i(){t&&(t=!1,r()),n&&l()}function a(){Vl(i)}function l(){var c=Date.now();if(t){if(c-s<Yl)return;n=!0}else t=!0,n=!1,setTimeout(a,e);s=c}return l}var Kl=20,Ql=["top","right","bottom","left","width","height","size","weight"],Jl=typeof MutationObserver<"u",Zl=function(){function r(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Xl(this.refresh.bind(this),Kl)}return r.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},r.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},r.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},r.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},r.prototype.connect_=function(){!Dr||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Jl?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},r.prototype.disconnect_=function(){!Dr||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},r.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=t===void 0?"":t,s=Ql.some(function(i){return!!~n.indexOf(i)});s&&this.refresh()},r.getInstance=function(){return this.instance_||(this.instance_=new r),this.instance_},r.instance_=null,r}(),Os=function(r,e){for(var t=0,n=Object.keys(e);t<n.length;t++){var s=n[t];Object.defineProperty(r,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return r},nt=function(r){var e=r&&r.ownerDocument&&r.ownerDocument.defaultView;return e||Pt},ks=Vt(0,0,0,0);function Dt(r){return parseFloat(r)||0}function En(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(n,s){var i=r["border-"+s+"-width"];return n+Dt(i)},0)}function ec(r){for(var e=["top","right","bottom","left"],t={},n=0,s=e;n<s.length;n++){var i=s[n],a=r["padding-"+i];t[i]=Dt(a)}return t}function tc(r){var e=r.getBBox();return Vt(0,0,e.width,e.height)}function rc(r){var e=r.clientWidth,t=r.clientHeight;if(!e&&!t)return ks;var n=nt(r).getComputedStyle(r),s=ec(n),i=s.left+s.right,a=s.top+s.bottom,l=Dt(n.width),c=Dt(n.height);if(n.boxSizing==="border-box"&&(Math.round(l+i)!==e&&(l-=En(n,"left","right")+i),Math.round(c+a)!==t&&(c-=En(n,"top","bottom")+a)),!sc(r)){var d=Math.round(l+i)-e,h=Math.round(c+a)-t;Math.abs(d)!==1&&(l-=d),Math.abs(h)!==1&&(c-=h)}return Vt(s.left,s.top,l,c)}var nc=function(){return typeof SVGGraphicsElement<"u"?function(r){return r instanceof nt(r).SVGGraphicsElement}:function(r){return r instanceof nt(r).SVGElement&&typeof r.getBBox=="function"}}();function sc(r){return r===nt(r).document.documentElement}function oc(r){return Dr?nc(r)?tc(r):rc(r):ks}function ic(r){var e=r.x,t=r.y,n=r.width,s=r.height,i=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(i.prototype);return Os(a,{x:e,y:t,width:n,height:s,top:t,right:e+n,bottom:s+t,left:e}),a}function Vt(r,e,t,n){return{x:r,y:e,width:t,height:n}}var ac=function(){function r(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Vt(0,0,0,0),this.target=e}return r.prototype.isActive=function(){var e=oc(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},r.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},r}(),lc=function(){function r(e,t){var n=ic(t);Os(this,{target:e,contentRect:n})}return r}(),cc=function(){function r(e,t,n){if(this.activeObservations_=[],this.observations_=new Ds,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return r.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof nt(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new ac(e)),this.controller_.addObserver(this),this.controller_.refresh())}},r.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof nt(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},r.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},r.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},r.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(n){return new lc(n.target,n.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},r.prototype.clearActive=function(){this.activeObservations_.splice(0)},r.prototype.hasActive=function(){return this.activeObservations_.length>0},r}(),zs=typeof WeakMap<"u"?new WeakMap:new Ds,Ms=function(){function r(e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=Zl.getInstance(),n=new cc(e,t,this);zs.set(this,n)}return r}();["observe","unobserve","disconnect"].forEach(function(r){Ms.prototype[r]=function(){var e;return(e=zs.get(this))[r].apply(e,arguments)}});var dc=function(){return typeof Pt.ResizeObserver<"u"?Pt.ResizeObserver:Ms}();const uc=Object.freeze(Object.defineProperty({__proto__:null,default:dc},Symbol.toStringTag,{value:"Module"})),fc=to(uc);Object.defineProperty(tn,"__esModule",{value:!0});tn.default=vc;var xt=Ts(u),hc=rn(We),pc=rn(fc),mc=rn(zt);function rn(r){return r&&r.__esModule?r:{default:r}}function Ts(r,e){if(typeof WeakMap=="function")var t=new WeakMap,n=new WeakMap;return(Ts=function(s,i){if(!i&&s&&s.__esModule)return s;var a,l,c={__proto__:null,default:s};if(s===null||typeof s!="object"&&typeof s!="function")return c;if(a=i?n:t){if(a.has(s))return a.get(s);a.set(s,c)}for(const d in s)d!=="default"&&{}.hasOwnProperty.call(s,d)&&((l=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(s,d))&&(l.get||l.set)?a(c,d,l):c[d]=s[d]);return c})(r,e)}function Or(){return Or=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Or.apply(null,arguments)}function et(r,e,t){return(e=gc(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function gc(r){var e=yc(r,"string");return typeof e=="symbol"?e:e+""}function yc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const bc="react-grid-layout";function vc(r){var e;return e=class extends xt.Component{constructor(){super(...arguments),et(this,"state",{width:1280}),et(this,"elementRef",xt.createRef()),et(this,"mounted",!1),et(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new pc.default(s=>{if(this.elementRef.current instanceof HTMLElement){const a=s[0].contentRect.width;this.setState({width:a})}});const n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;const n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){const{measureBeforeMount:n,...s}=this.props;return n&&!this.mounted?xt.createElement("div",{className:(0,mc.default)(this.props.className,bc),style:this.props.style,ref:this.elementRef}):xt.createElement(r,Or({innerRef:this.elementRef},s,this.state))}},et(e,"defaultProps",{measureBeforeMount:!1}),et(e,"propTypes",{measureBeforeMount:hc.default.bool}),e}(function(r){r.exports=ft.default,r.exports.utils=F,r.exports.calculateUtils=ke,r.exports.Responsive=Gt.default,r.exports.Responsive.utils=Ke,r.exports.WidthProvider=tn.default})(Jn);var Pn=Jn.exports;const xc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function wc(r){return r==null?"":typeof r!="string"?String(r):r.replace(/[&<>"'`=\/]/g,e=>xc[e])}function nn(r,e={}){const{maxLength:t=1e4,trim:n=!0,normalizeWhitespace:s=!0}=e;if(r==null)return"";typeof r!="string"&&(r=String(r));let i=r;return i=i.replace(/\0/g,""),i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""),n&&(i=i.trim()),s&&(i=i.replace(/[ \t]+/g," ")),i.length>t&&(i=i.substring(0,t)),i}function Ot(r,e=255){return r==null?"":(typeof r!="string"&&(r=String(r)),nn(r,{maxLength:e}).replace(/[\r\n]/g," ").replace(/\s+/g," ").trim())}function Is(r,e=1e4){return r==null?"":(typeof r!="string"&&(r=String(r)),nn(r,{maxLength:e,normalizeWhitespace:!1}).replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`).trim())}function Ns(r){return r?Ot(r,254).toLowerCase():""}function Yt(r,e={}){const{min:t=-1/0,max:n=1/0,decimals:s=2}=e;if(r==null||r==="")return null;let i=String(r).replace(/[^0-9.\-]/g,""),a=parseFloat(i);return isNaN(a)?null:(a=Math.max(t,Math.min(n,a)),a=Math.round(a*Math.pow(10,s))/Math.pow(10,s),a)}function _c(r){const e=Yt(r,{min:0,decimals:2});return e!==null?Math.round(e*100)/100:null}function Sc(r){const e=Yt(r,{min:0,max:24,decimals:1});return e===null?null:Math.round(e*2)/2}function jc(r){return Yt(r,{min:0,max:100,decimals:1})}function Rc(r){if(!r)return null;const e=String(r).trim();return/^(javascript|data|vbscript):/i.test(e)?null:/^(https?:\/\/|\/|#)/i.test(e)?e:`https://${e}`}function Cc(r,e={}){if(!r||typeof r!="object")return r;const t={...r};for(const[n,s]of Object.entries(e)){if(t[n]===void 0)continue;const{type:i="text",maxLength:a}=s;switch(i){case"singleLine":t[n]=Ot(t[n],a);break;case"multiLine":t[n]=Is(t[n],a);break;case"email":t[n]=Ns(t[n]);break;case"number":t[n]=Yt(t[n],s);break;case"currency":t[n]=_c(t[n]);break;case"hours":t[n]=Sc(t[n]);break;case"percentage":t[n]=jc(t[n]);break;case"url":t[n]=Rc(t[n]);break;case"html":t[n]=wc(t[n]);break;default:t[n]=nn(t[n],{maxLength:a})}}return t}const Ec={timesheet:{description:{type:"multiLine",maxLength:2e3},hours_worked:{type:"hours"}},expense:{reason:{type:"multiLine",maxLength:2e3},amount:{type:"currency"}},resource:{name:{type:"singleLine",maxLength:100},email:{type:"email"},role:{type:"singleLine",maxLength:100},notes:{type:"multiLine",maxLength:5e3}},partner:{name:{type:"singleLine",maxLength:200},contact_name:{type:"singleLine",maxLength:100},contact_email:{type:"email"},notes:{type:"multiLine",maxLength:5e3}},milestone:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3}},deliverable:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3}},kpi:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3},target_value:{type:"number",decimals:2},actual_value:{type:"number",decimals:2}},qualityStandard:{name:{type:"singleLine",maxLength:200},description:{type:"multiLine",maxLength:5e3},target_value:{type:"percentage"}}};function Dn(r,e){const t=Ec[r];return t?Cc(e,t):e}class Te{constructor(e,t={}){this.tableName=e,this.supportsSoftDelete=t.supportsSoftDelete!==!1,this.sanitizeConfig=t.sanitizeConfig||null}getSoftDeleteFilter(){return this.supportsSoftDelete?"is_deleted.is.null,is_deleted.eq.false":null}async getAll(e,t={}){try{let n=x.from(this.tableName).select(t.select||"*").eq("project_id",e);this.supportsSoftDelete&&!t.includeDeleted&&(n=n.or(this.getSoftDeleteFilter())),t.filters&&Array.isArray(t.filters)&&t.filters.forEach(a=>{const{column:l,operator:c,value:d}=a;switch(c){case"eq":n=n.eq(l,d);break;case"neq":n=n.neq(l,d);break;case"gt":n=n.gt(l,d);break;case"gte":n=n.gte(l,d);break;case"lt":n=n.lt(l,d);break;case"lte":n=n.lte(l,d);break;case"like":n=n.like(l,d);break;case"ilike":n=n.ilike(l,d);break;case"in":n=n.in(l,d);break;case"is":n=n.is(l,d);break;default:n=n.eq(l,d)}}),t.orderBy&&(n=n.order(t.orderBy.column,{ascending:t.orderBy.ascending??!0}));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getDeleted(e){if(!this.supportsSoftDelete)return[];try{const{data:t,error:n}=await x.from(this.tableName).select("*").eq("project_id",e).eq("is_deleted",!0).order("deleted_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){throw t}}async getById(e,t={}){try{let n=x.from(this.tableName).select(t.select||"*").eq("id",e);this.supportsSoftDelete&&!t.includeDeleted&&(n=n.or(this.getSoftDeleteFilter()));const{data:s,error:i}=await n.single();if(i){if(i.code==="PGRST116")return null;throw i}return s}catch(n){throw n}}async create(e){try{if(!e.project_id)throw new Error("project_id is required");let t=e;this.sanitizeConfig&&(t=Dn(this.sanitizeConfig,e)),this.supportsSoftDelete&&(delete t.is_deleted,delete t.deleted_at,delete t.deleted_by);const{data:n,error:s}=await x.from(this.tableName).insert(t).select().single();if(s)throw s;return n}catch(t){throw t}}async update(e,t){try{let n=t;this.sanitizeConfig&&(n=Dn(this.sanitizeConfig,t));const s={...n,updated_at:new Date().toISOString()};delete s.is_deleted,delete s.deleted_at,delete s.deleted_by;const{data:i,error:a}=await x.from(this.tableName).update(s).eq("id",e).select().single();if(a)throw a;return i}catch(n){throw n}}async delete(e,t=null){try{if(this.supportsSoftDelete){const{error:n}=await x.from(this.tableName).update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:t}).eq("id",e);if(n)throw n}else{const{error:n}=await x.from(this.tableName).delete().eq("id",e);if(n)throw n}return!0}catch(n){throw n}}async hardDelete(e){try{const{error:t}=await x.from(this.tableName).delete().eq("id",e);if(t)throw t;return!0}catch(t){throw t}}async restore(e){if(!this.supportsSoftDelete)throw new Error("This entity does not support soft delete");try{const{data:t,error:n}=await x.from(this.tableName).update({is_deleted:!1,deleted_at:null,deleted_by:null}).eq("id",e).select().single();if(n)throw n;return t}catch(t){throw t}}async exists(e){try{let t=x.from(this.tableName).select("id",{count:"exact",head:!0}).eq("id",e);this.supportsSoftDelete&&(t=t.or(this.getSoftDeleteFilter()));const{count:n,error:s}=await t;if(s)throw s;return n>0}catch(t){throw t}}async count(e,t=[]){try{let n=x.from(this.tableName).select("id",{count:"exact",head:!0}).eq("project_id",e);this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.forEach(a=>{const{column:l,operator:c,value:d}=a;c==="eq"?n=n.eq(l,d):c==="in"&&(n=n.in(l,d))});const{count:s,error:i}=await n;if(i)throw i;return s||0}catch(n){throw n}}}class Pc extends Te{constructor(){super("partners")}async getAll(e){return super.getAll(e,{orderBy:{column:"name",ascending:!0}})}async getActive(e){return super.getAll(e,{filters:[{column:"is_active",operator:"eq",value:!0}],orderBy:{column:"name",ascending:!0}})}async getWithResources(e){try{const{data:t,error:n}=await x.from("partners").select(`
          *,
          resources (
            id,
            name,
            daily_rate,
            cost_price,
            is_active
          )
        `).eq("id",e).single();if(n){if(n.code==="PGRST116")return null;throw n}return t}catch(t){throw t}}async getSummary(e){try{const{data:t,error:n}=await x.from("partners").select(`
          id,
          name,
          contact_name,
          contact_email,
          payment_terms,
          is_active,
          created_at
        `).eq("project_id",e).order("name",{ascending:!0});if(n)throw n;return t||[]}catch(t){throw t}}async create(e){if(!e.name?.trim())throw new Error("Partner name is required");if(await this.findByName(e.project_id,e.name))throw new Error(`Partner "${e.name}" already exists`);return super.create({...e,name:e.name.trim(),is_active:e.is_active??!0,payment_terms:e.payment_terms||"Net 30"})}async findByName(e,t){try{const{data:n,error:s}=await x.from("partners").select("*").eq("project_id",e).ilike("name",t.trim()).single();if(s){if(s.code==="PGRST116")return null;throw s}return n}catch(n){if(n.code==="PGRST116")return null;throw n}}async toggleActive(e){const t=await this.getById(e);if(!t)throw new Error("Partner not found");return this.update(e,{is_active:!t.is_active})}async getForSelect(e,t=!0){return(t?await this.getActive(e):await this.getAll(e)).map(s=>({value:s.id,label:s.name}))}async getDependencyCounts(e){try{const{data:t,error:n}=await x.from("resources").select("id").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(n)throw n;const s=t?.map(d=>d.id)||[];let i=0,a=0;if(s.length>0){const{count:d,error:h}=await x.from("timesheets").select("*",{count:"exact",head:!0}).in("resource_id",s).or("is_deleted.is.null,is_deleted.eq.false");if(h)throw h;i=d||0;const{count:m,error:g}=await x.from("expenses").select("*",{count:"exact",head:!0}).in("resource_id",s).or("is_deleted.is.null,is_deleted.eq.false");if(g)throw g;a=m||0}const{count:l,error:c}=await x.from("partner_invoices").select("*",{count:"exact",head:!0}).eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(c)throw c;return{resourceCount:t?.length||0,timesheetCount:i,expenseCount:a,invoiceCount:l||0,canDelete:!t?.length&&!l}}catch(t){throw t}}}const kd=new Pc;class Dc extends Te{constructor(){super("resources",{sanitizeConfig:"resource",supportsSoftDelete:!0})}sanitizeData(e){const t={...e};return t.name&&(t.name=Ot(t.name,100)),t.role&&(t.role=Ot(t.role,100)),t.email&&(t.email=Ns(t.email)),t.notes&&(t.notes=Is(t.notes,5e3)),t}async getAll(e,t={}){const{includePartner:n=!0,activeOnly:s=!1,showTestUsers:i=!0,includeDeleted:a=!1}=t;let l="*";n&&(l="*, partner:partners(id, name, is_active)");let c=x.from(this.tableName).select(l).eq("project_id",e).order("name");a||(c=c.or("is_deleted.is.null,is_deleted.eq.false")),s&&(c=c.eq("is_active",!0)),i||(c=c.or("is_test_content.is.null,is_test_content.eq.false"));const{data:d,error:h}=await c;if(h)throw h;return d||[]}async getAllFiltered(e,t=!0){return this.getAll(e,{showTestUsers:t,includePartner:!0})}async getById(e){const{data:t,error:n}=await x.from(this.tableName).select("*, partner:partners(id, name, contact_name, contact_email, is_active)").eq("id",e).or("is_deleted.is.null,is_deleted.eq.false").single();if(n)throw n;return t}async getByType(e,t){const{data:n,error:s}=await x.from(this.tableName).select("*, partner:partners(id, name)").eq("project_id",e).eq("resource_type",t).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(s)throw s;return n||[]}async getByPartner(e){const{data:t,error:n}=await x.from(this.tableName).select("*").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(n)throw n;return t||[]}async getWithTimesheetSummary(e){const t=await this.getById(e);if(!t)return null;const{data:n,error:s}=await x.from("timesheets").select("id, hours_worked, hours, status, was_rejected, date").eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false");let i=0,a=0,l=0;return n&&n.forEach(c=>{const d=parseFloat(c.hours_worked||c.hours||0);i+=d,c.status==="Approved"?a+=d:c.status==="Submitted"&&!c.was_rejected&&(l+=d)}),{...t,timesheetSummary:{totalEntries:n?.length||0,totalHours:i,approvedHours:a,pendingHours:l,daysWorked:i/8}}}async create(e){const t=this.sanitizeData(e);if(!t.name?.trim())throw new Error("Resource name is required");if(!t.project_id)throw new Error("Project ID is required");if(!t.email?.trim())throw new Error("Email is required");t.resource_type==="internal"&&(t.partner_id=null);const{data:n,error:s}=await x.from(this.tableName).insert([t]).select("*, partner:partners(id, name)").single();if(s)throw s;return n}async update(e,t){const n=this.sanitizeData(t);n.resource_type==="internal"&&(n.partner_id=null),n.updated_at=new Date().toISOString();const{data:s,error:i}=await x.from(this.tableName).update(n).eq("id",e).select("*, partner:partners(id, name)").single();if(i)throw i;return s}async delete(e,t=null){const{data:n,error:s}=await x.from(this.tableName).update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:t}).eq("id",e).select().single();if(s)throw s;return n}async restore(e){const{data:t,error:n}=await x.from(this.tableName).update({is_deleted:!1,deleted_at:null,deleted_by:null}).eq("id",e).select().single();if(n)throw n;return t}async linkToPartner(e,t){const n={partner_id:t,resource_type:t?"third_party":"internal",updated_at:new Date().toISOString()};return this.update(e,n)}async toggleActive(e){const t=await this.getById(e);if(!t)throw new Error("Resource not found");return this.update(e,{is_active:!t.is_active})}async getForSelect(e){const{data:t,error:n}=await x.from(this.tableName).select("id, name, resource_type, role").eq("project_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("name");if(n)throw n;return t||[]}calculateMargin(e,t){if(!e||e===0||!t)return{percent:null,amount:null,status:"unknown"};const n=(e-t)/e*100,s=e-t;let i="critical";return n>=25?i="good":n>=10&&(i="low"),{percent:n,amount:s,status:i}}async getUtilization(e){const t=await this.getWithTimesheetSummary(e);if(!t)return null;const n=t.days_allocated||0,s=t.timesheetSummary.daysWorked,i=Math.max(0,n-s),a=n>0?s/n*100:0;return{resourceId:e,resourceName:t.name,daysAllocated:n,daysUsed:s,remaining:i,utilizationPercent:a,totalValue:(t.daily_rate||0)*n,valueUsed:(t.daily_rate||0)*s}}async getSummary(e){const t=await this.getAll(e,{includePartner:!1});return{total:t.length,internal:t.filter(n=>n.resource_type==="internal").length,thirdParty:t.filter(n=>n.resource_type==="third_party").length,active:t.filter(n=>n.is_active).length,totalBudget:t.reduce((n,s)=>n+(s.daily_rate||0)*(s.days_allocated||0),0)}}async getProfileByEmail(e){try{const{data:t,error:n}=await this.supabase.from("profiles").select("id, email, full_name, role").eq("email",e).single();if(n){if(n.code==="PGRST116")return null;throw n}return t}catch(t){throw t}}async getAllWithTestFilter(e,t=[]){try{const n=await this.getAll(e,{orderBy:{column:"name",ascending:!0}});return t&&t.length>0?n.filter(s=>!s.user_id||!t.includes(s.user_id)):n}catch(n){throw n}}async getDependencyCounts(e){try{const[t,n]=await Promise.all([this.supabase.from("timesheets").select("id",{count:"exact",head:!0}).eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false"),this.supabase.from("expenses").select("id",{count:"exact",head:!0}).eq("resource_id",e).or("is_deleted.is.null,is_deleted.eq.false")]);return{timesheetCount:t.count||0,expenseCount:n.count||0,canDelete:(t.count||0)===0&&(n.count||0)===0}}catch(t){throw t}}}const zd=new Dc;class Oc extends Te{constructor(){super("timesheets",{supportsSoftDelete:!0,sanitizeConfig:"timesheet"})}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||`
      *,
      resources(id, name, email, daily_rate, cost_price),
      milestones(id, milestone_ref, name)
    `,orderBy:t.orderBy||{column:"date",ascending:!1}})}async getAllFiltered(e,t=!1){try{let n=x.from(this.tableName).select(`
          *,
          resources(id, name, email, daily_rate, cost_price),
          milestones(id, milestone_ref, name)
        `).eq("project_id",e).order("date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getByResource(e,t={}){try{let n=x.from(this.tableName).select("*, milestones(id, milestone_ref, name)").eq("resource_id",e).order("date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.start&&(n=n.gte("date",t.start)),t.end&&(n=n.lte("date",t.end)),t.status&&(n=n.eq("status",t.status));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getByPartner(e,t={}){try{const{data:n}=await x.from("resources").select("id, name, cost_price").eq("partner_id",e).or("is_deleted.is.null,is_deleted.eq.false");if(!n||n.length===0)return[];const s=n.map(c=>c.id);let i=x.from(this.tableName).select("*, resources(id, name, cost_price), milestones(id, milestone_ref, name)").in("resource_id",s).order("date",{ascending:!1});this.supportsSoftDelete&&(i=i.or(this.getSoftDeleteFilter())),t.start&&(i=i.gte("date",t.start)),t.end&&(i=i.lte("date",t.end)),t.status&&(i=i.eq("status",t.status));const{data:a,error:l}=await i;if(l)throw l;return a||[]}catch(n){throw n}}async getApprovedForInvoice(e,t){if(!t.start||!t.end)throw new Error("Date range (start and end) is required for invoice queries");return this.getByPartner(e,{...t,status:"Approved"})}async getSummary(e,t={}){try{const n=await this.getAll(e,t),s={totalHours:0,totalDays:0,approvedHours:0,pendingHours:0,draftHours:0,rejectedHours:0,totalCost:0,approvedCost:0,byStatus:{Draft:{count:0,hours:0},Submitted:{count:0,hours:0},Approved:{count:0,hours:0},Rejected:{count:0,hours:0}},byMilestone:{},count:n.length};return n.forEach(i=>{const a=parseFloat(i.hours_worked||i.hours||0),l=i.resources?.cost_price||0,c=a/8*l;switch(s.totalHours+=a,s.totalCost+=c,s.byStatus[i.status]&&(s.byStatus[i.status].count++,s.byStatus[i.status].hours+=a),i.status){case"Approved":s.approvedHours+=a,s.approvedCost+=c;break;case"Submitted":i.was_rejected||(s.pendingHours+=a);break;case"Draft":s.draftHours+=a;break;case"Rejected":s.rejectedHours+=a;break}if(i.milestone_id){const d=i.milestones?.milestone_ref||"Unknown";s.byMilestone[i.milestone_id]||(s.byMilestone[i.milestone_id]={ref:d,name:i.milestones?.name||"Unknown",hours:0,cost:0}),s.byMilestone[i.milestone_id].hours+=a,s.byMilestone[i.milestone_id].cost+=c}}),s.totalDays=s.totalHours/8,s}catch(n){throw n}}async create(e){if(!e.resource_id)throw new Error("resource_id is required");if(!e.date)throw new Error("date is required");const t=parseFloat(e.hours_worked||e.hours||0);if(!t||t<=0)throw new Error("hours must be greater than 0");const n={...e,hours_worked:t,hours:t,date:e.date||e.work_date,work_date:e.work_date||e.date,description:e.description||e.comments||"",comments:e.comments||e.description||"",status:e.status||"Draft"};return super.create(n)}async submit(e){return this.update(e,{status:"Submitted"})}async approve(e){return this.update(e,{status:"Approved"})}async reject(e,t=null){const n={status:"Rejected",was_rejected:!0};return t&&(n.rejection_reason=t),this.update(e,n)}calculateCost(e,t){return e/8*t}calculateBillable(e,t){return e/8*t}}const kc=new Oc;class zc extends Te{constructor(){super("expenses",{supportsSoftDelete:!0,sanitizeConfig:"expense"})}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||"*, expense_files(*)",orderBy:t.orderBy||{column:"expense_date",ascending:!1}})}async getAllFiltered(e,t=!1){try{let n=x.from(this.tableName).select("*, expense_files(*)").eq("project_id",e).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getByResource(e,t={}){try{let n=x.from(this.tableName).select("*, expense_files(*)").eq("resource_id",e).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter())),t.start&&(n=n.gte("expense_date",t.start)),t.end&&(n=n.lte("expense_date",t.end));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getByPartner(e,t={}){try{const{data:n}=await x.from("resources").select("id").eq("partner_id",e);if(!n||n.length===0)return[];const s=n.map(c=>c.id);let i=x.from(this.tableName).select("*, expense_files(*)").in("resource_id",s).order("expense_date",{ascending:!1});this.supportsSoftDelete&&(i=i.or(this.getSoftDeleteFilter())),t.start&&(i=i.gte("expense_date",t.start)),t.end&&(i=i.lte("expense_date",t.end)),t.procurementMethod&&(i=i.eq("procurement_method",t.procurementMethod));const{data:a,error:l}=await i;if(l)throw l;return a||[]}catch(n){throw n}}async getPartnerProcuredForInvoice(e,t){if(!t.start||!t.end)throw new Error("Date range (start and end) is required for invoice queries");return this.getByPartner(e,{...t,procurementMethod:"partner"})}async getSummary(e,t={}){try{const n=await this.getAll(e,t),s={total:0,chargeable:0,nonChargeable:0,supplierProcured:0,partnerProcured:0,byCategory:{Travel:0,Accommodation:0,Sustenance:0},byStatus:{Draft:0,Submitted:0,Approved:0,Rejected:0,Paid:0},count:n.length};return n.forEach(i=>{const a=parseFloat(i.amount||0);s.total+=a,i.chargeable_to_customer!==!1?s.chargeable+=a:s.nonChargeable+=a,i.procurement_method==="partner"?s.partnerProcured+=a:s.supplierProcured+=a,s.byCategory[i.category]!==void 0&&(s.byCategory[i.category]+=a),s.byStatus[i.status]!==void 0&&(s.byStatus[i.status]+=a)}),s}catch(n){throw n}}async create(e){if(!e.resource_id)throw new Error("resource_id is required");if(!e.category)throw new Error("category is required");if(!e.amount||e.amount<=0)throw new Error("amount must be greater than 0");const t={...e,status:e.status||"Draft",chargeable_to_customer:e.chargeable_to_customer??!0,procurement_method:e.procurement_method||"supplier"};return super.create(t)}async createMany(e){if(!e||e.length===0)return[];try{const t=e.map(i=>{if(!i.resource_id)throw new Error("resource_id is required for all expenses");if(!i.category)throw new Error("category is required for all expenses");if(!i.amount||i.amount<=0)throw new Error("amount must be greater than 0 for all expenses");return{...i,status:i.status||"Draft",chargeable_to_customer:i.chargeable_to_customer??!0,procurement_method:i.procurement_method||"supplier"}}),{data:n,error:s}=await x.from(this.tableName).insert(t).select();if(s)throw s;return n||[]}catch(t){throw t}}async submit(e){return this.update(e,{status:"Submitted"})}async approve(e){return this.update(e,{status:"Approved"})}async reject(e,t=null){const n={status:"Rejected"};return t&&(n.rejection_reason=t),this.update(e,n)}async markPaid(e){return this.update(e,{status:"Paid"})}async uploadReceipt(e,t,n){try{const s=`${e}/${Date.now()}-${t.name}`,{error:i}=await x.storage.from("receipts").upload(s,t);if(i)throw i;const{data:a,error:l}=await x.from("expense_files").insert({expense_id:e,file_name:t.name,file_path:s,file_size:t.size,file_type:t.type,uploaded_by:n}).select().single();if(l)throw l;return a}catch(s){throw s}}async downloadReceipt(e){try{const{data:t,error:n}=await x.storage.from("receipts").download(e);if(n)throw n;return t}catch(t){throw t}}}const Md=new zc;class Mc extends Te{constructor(){super("partner_invoices")}async getAll(e,t={}){return super.getAll(e,{...t,select:t.select||"*, partners(name)",orderBy:t.orderBy||{column:"invoice_date",ascending:!1}})}async getByPartner(e,t={}){try{let n=x.from(this.tableName).select("*").eq("partner_id",e).order("invoice_date",{ascending:!1});t.status&&(n=n.eq("status",t.status));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async getWithLines(e){try{const{data:t,error:n}=await x.from(this.tableName).select("*, partners(name, contact_name, contact_email, payment_terms)").eq("id",e).single();if(n)throw n;if(!t)return null;const{data:s,error:i}=await x.from("partner_invoice_lines").select("*").eq("invoice_id",e).order("line_type",{ascending:!0}).order("resource_name",{ascending:!0}).order("line_date",{ascending:!0});if(i)throw i;const a={timesheets:(s||[]).filter(l=>l.line_type==="timesheet"),supplierExpenses:(s||[]).filter(l=>l.line_type==="supplier_expense"),partnerExpenses:(s||[]).filter(l=>l.line_type==="expense")};return{...t,lines:s||[],groupedLines:a}}catch(t){throw t}}async generateInvoiceNumber(e){try{const n=`INV-${new Date().getFullYear()}-`,{data:s,error:i}=await x.from(this.tableName).select("invoice_number").eq("project_id",e).like("invoice_number",`${n}%`).order("invoice_number",{ascending:!1}).limit(1);if(i)throw i;let a=1;if(s&&s.length>0){const l=s[0].invoice_number,c=parseInt(l.replace(n,""),10);isNaN(c)||(a=c+1)}return`${n}${String(a).padStart(3,"0")}`}catch(t){throw t}}async generateInvoice(e){const{projectId:t,partnerId:n,periodStart:s,periodEnd:i,createdBy:a,notes:l,includeSubmitted:c=!0}=e;try{const{data:d,error:h}=await x.from("resources").select("id, name, cost_price").eq("partner_id",n);if(h)throw h;if(!d||d.length===0)throw new Error("No resources linked to this partner");const m=d.map(O=>O.id),g={};d.forEach(O=>{g[O.id]=O});const S=c?["Approved","Submitted"]:["Approved"],{data:k,error:R}=await x.from("timesheets").select("id, date, hours_worked, hours, status, resource_id").in("resource_id",m).gte("date",s).lte("date",i).in("status",S);if(R)throw R;const{data:E,error:w}=await x.from("expenses").select("id, expense_date, category, reason, amount, resource_id, resource_name, procurement_method, chargeable_to_customer, status").in("resource_id",m).gte("expense_date",s).lte("expense_date",i).in("status",["Approved","Submitted","Paid"]);if(w)throw w;const D=(E||[]).filter(O=>O.procurement_method==="partner"||!O.procurement_method),b=(E||[]).filter(O=>O.procurement_method==="supplier");let p=0,f=0;const y=[],_={};(k||[]).forEach(O=>{_[O.resource_id]||(_[O.resource_id]=[]),_[O.resource_id].push(O)}),Object.keys(_).forEach(O=>{const Q=g[O];_[O].forEach(q=>{const ie=parseFloat(q.hours_worked||q.hours||0),P=Q?.cost_price||0,M=ie/8,A=M*P;p+=A,f+=A,y.push({line_type:"timesheet",timesheet_id:q.id,expense_id:null,description:`${Q?.name||"Unknown"} - ${ie}h (${M.toFixed(2)} days)`,quantity:ie,unit_price:P,line_total:A,resource_name:Q?.name,line_date:q.date,hours:ie,cost_price:P,source_status:q.status,chargeable_to_customer:!0,procurement_method:null,expense_category:null})})});let v=0,C=0,T=0;const L=[];D.forEach(O=>{const Q=parseFloat(O.amount||0);v+=Q,O.chargeable_to_customer?C+=Q:T+=Q,L.push({line_type:"expense",timesheet_id:null,expense_id:O.id,description:`${O.resource_name} - ${O.category}: ${O.reason}`,quantity:1,unit_price:Q,line_total:Q,resource_name:O.resource_name,line_date:O.expense_date,hours:null,cost_price:null,source_status:O.status,chargeable_to_customer:O.chargeable_to_customer,procurement_method:"partner",expense_category:O.category})});let I=0,Z=0,he=0;const Pe=[];b.forEach(O=>{const Q=parseFloat(O.amount||0);I+=Q,O.chargeable_to_customer?Z+=Q:he+=Q,Pe.push({line_type:"supplier_expense",timesheet_id:null,expense_id:O.id,description:`${O.resource_name} - ${O.category}: ${O.reason}`,quantity:1,unit_price:Q,line_total:Q,resource_name:O.resource_name,line_date:O.expense_date,hours:null,cost_price:null,source_status:O.status,chargeable_to_customer:O.chargeable_to_customer,procurement_method:"supplier",expense_category:O.category})});const z=p+v,X=f+C+Z,ye=T+he,ue=await this.generateInvoiceNumber(t),{data:re,error:ne}=await x.from(this.tableName).insert({project_id:t,partner_id:n,invoice_number:ue,invoice_date:new Date().toISOString().split("T")[0],period_start:s,period_end:i,timesheet_total:p,expense_total:v,supplier_expense_total:I,invoice_total:z,chargeable_total:X,non_chargeable_total:ye,status:"Draft",notes:l||null,created_by:a}).select().single();if(ne)throw ne;const B=[...y,...L,...Pe].map(O=>({...O,invoice_id:re.id}));if(B.length>0){const{error:O}=await x.from("partner_invoice_lines").insert(B);if(O)throw O}return this.getWithLines(re.id)}catch(d){throw d}}async updateStatus(e,t){const n={status:t};return t==="Sent"?n.sent_at=new Date().toISOString():t==="Paid"&&(n.paid_at=new Date().toISOString()),this.update(e,n)}async markSent(e){return this.updateStatus(e,"Sent")}async markPaid(e){return this.updateStatus(e,"Paid")}async cancel(e){return this.updateStatus(e,"Cancelled")}async getPartnerStats(e){try{const{data:t,error:n}=await x.from(this.tableName).select("status, invoice_total").eq("partner_id",e);if(n)throw n;const s={total:0,draft:0,sent:0,paid:0,cancelled:0,count:t?.length||0};return(t||[]).forEach(i=>{const a=parseFloat(i.invoice_total||0);switch(s.total+=a,i.status){case"Draft":s.draft+=a;break;case"Sent":s.sent+=a;break;case"Paid":s.paid+=a;break;case"Cancelled":s.cancelled+=a;break}}),s}catch(t){throw t}}}const Td=new Mc;class Tc extends Te{constructor(){super("milestones",{supportsSoftDelete:!0,sanitizeConfig:"milestone"})}async getAllWithStats(e){try{const t=await this.getAll(e,{orderBy:{column:"start_date",ascending:!0}}),{data:n}=await x.from("timesheets").select("milestone_id, hours_worked").eq("project_id",e).not("milestone_id","is",null).or("is_deleted.is.null,is_deleted.eq.false"),s={};return(n||[]).forEach(i=>{s[i.milestone_id]||(s[i.milestone_id]=0),s[i.milestone_id]+=parseFloat(i.hours_worked||0)}),t.map(i=>({...i,logged_hours:s[i.id]||0,logged_days:(s[i.id]||0)/8}))}catch(t){throw t}}async getWithDeliverables(e){try{const{data:t,error:n}=await x.from(this.tableName).select("*").eq("id",e).or(this.getSoftDeleteFilter()).single();if(n)throw n;const{data:s,error:i}=await x.from("deliverables").select("*").eq("milestone_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("due_date",{ascending:!0});if(i)throw i;return{...t,deliverables:s||[]}}catch(t){throw t}}async getByStatus(e,t){return this.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"start_date",ascending:!0}})}async getUpcoming(e,t=30){try{const n=new Date().toISOString().split("T")[0],s=new Date;s.setDate(s.getDate()+t);const i=s.toISOString().split("T")[0];let a=x.from(this.tableName).select("*").eq("project_id",e).gte("end_date",n).lte("end_date",i).neq("status","Completed").order("end_date",{ascending:!0});this.supportsSoftDelete&&(a=a.or(this.getSoftDeleteFilter()));const{data:l,error:c}=await a;if(c)throw c;return l||[]}catch(n){throw n}}async updateStatus(e,t){return this.update(e,{status:t})}async updateCompletion(e,t){const n={completion_percentage:t};return t>=100&&(n.status="Completed"),this.update(e,n)}async getSummary(e){try{const t=await this.getAll(e),n={total:t.length,completed:0,inProgress:0,notStarted:0,overdue:0,upcoming:0},s=new Date().toISOString().split("T")[0],i=new Date;i.setDate(i.getDate()+7);const a=i.toISOString().split("T")[0];return t.forEach(l=>{l.status==="Completed"?n.completed++:l.status==="In Progress"?(n.inProgress++,l.end_date<s&&n.overdue++):l.status==="Not Started"&&(n.notStarted++,l.start_date<=a&&n.upcoming++)}),n}catch(t){throw t}}async getCertificates(e){try{const{data:t,error:n}=await x.from("milestone_certificates").select("*").eq("project_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){throw t}}async createCertificate(e){try{const{data:t,error:n}=await x.from("milestone_certificates").insert([e]).select().single();if(n)throw n;return t}catch(t){throw t}}async updateCertificate(e,t){try{const{data:n,error:s}=await x.from("milestone_certificates").update(t).eq("id",e).select().single();if(s)throw s;return n}catch(n){throw n}}}const Ic=new Tc;class Nc extends Te{constructor(){super("deliverables",{supportsSoftDelete:!0,sanitizeConfig:"deliverable"})}async getAllWithMilestones(e){return this.getAll(e,{select:"*, milestones(name, milestone_ref)",orderBy:{column:"due_date",ascending:!0}})}async getByMilestone(e){try{let t=x.from(this.tableName).select("*").eq("milestone_id",e).order("due_date",{ascending:!0});this.supportsSoftDelete&&(t=t.or(this.getSoftDeleteFilter()));const{data:n,error:s}=await t;if(s)throw s;return n||[]}catch(t){throw t}}async getByStatus(e,t){return this.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"due_date",ascending:!0}})}async getOverdue(e){try{const t=new Date().toISOString().split("T")[0];let n=x.from(this.tableName).select("*, milestones(name)").eq("project_id",e).lt("due_date",t).not("status","in",'("Delivered","Cancelled")').order("due_date",{ascending:!0});this.supportsSoftDelete&&(n=n.or(this.getSoftDeleteFilter()));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(t){throw t}}async getUpcoming(e,t=14){try{const n=new Date().toISOString().split("T")[0],s=new Date;s.setDate(s.getDate()+t);const i=s.toISOString().split("T")[0];let a=x.from(this.tableName).select("*, milestones(name)").eq("project_id",e).gte("due_date",n).lte("due_date",i).not("status","eq","Delivered").order("due_date",{ascending:!0});this.supportsSoftDelete&&(a=a.or(this.getSoftDeleteFilter()));const{data:l,error:c}=await a;if(c)throw c;return l||[]}catch(n){throw n}}async updateStatus(e,t,n){const s={status:t};return t==="Submitted"?(s.submitted_date=new Date().toISOString(),s.submitted_by=n):t==="Delivered"&&(s.delivered_date=new Date().toISOString(),s.delivered_by=n),this.update(e,s)}async submit(e,t){return this.updateStatus(e,"Submitted",t)}async markDelivered(e,t){return this.updateStatus(e,"Delivered",t)}async reject(e,t){return this.update(e,{status:"Rejected",rejection_reason:t})}async getSummary(e){try{const t=await this.getAll(e),n=new Date().toISOString().split("T")[0],s={total:t.length,delivered:0,inProgress:0,notStarted:0,overdue:0,dueThisWeek:0},i=new Date;i.setDate(i.getDate()+7);const a=i.toISOString().split("T")[0];return t.forEach(l=>{l.status==="Delivered"?s.delivered++:l.status==="In Progress"?(s.inProgress++,l.due_date<n?s.overdue++:l.due_date<=a&&s.dueThisWeek++):(l.status==="Not Started"||l.status==="Draft")&&(s.notStarted++,l.due_date<n&&s.overdue++)}),s}catch(t){throw t}}async getAllWithRelations(e,t=!1){try{let n=x.from("deliverables").select(`
          *,
          milestones(milestone_ref, name),
          deliverable_kpis(kpi_id, kpis(kpi_ref, name)),
          deliverable_quality_standards(quality_standard_id, quality_standards(qs_ref, name))
        `).eq("project_id",e).or("is_deleted.is.null,is_deleted.eq.false").order("deliverable_ref");t||(n=n.or("is_test_content.is.null,is_test_content.eq.false"));const{data:s,error:i}=await n;if(i)throw i;return s||[]}catch(n){throw n}}async syncKPILinks(e,t=[]){try{const{error:n}=await x.from("deliverable_kpis").delete().eq("deliverable_id",e);if(n)throw n;if(t.length>0){const s=t.map(a=>({deliverable_id:e,kpi_id:a})),{error:i}=await x.from("deliverable_kpis").insert(s);if(i)throw i}return!0}catch(n){throw n}}async syncQSLinks(e,t=[]){try{const{error:n}=await x.from("deliverable_quality_standards").delete().eq("deliverable_id",e);if(n)throw n;if(t.length>0){const s=t.map(a=>({deliverable_id:e,quality_standard_id:a})),{error:i}=await x.from("deliverable_quality_standards").insert(s);if(i)throw i}return!0}catch(n){throw n}}async upsertKPIAssessments(e,t,n){try{const s=t.map(a=>({deliverable_id:e,kpi_id:a.kpiId,criteria_met:a.criteriaMet,assessed_at:new Date().toISOString(),assessed_by:n})),{error:i}=await x.from("deliverable_kpi_assessments").upsert(s,{onConflict:"deliverable_id,kpi_id"});if(i)throw i;return!0}catch(s){throw s}}async upsertQSAssessments(e,t,n){try{const s=t.map(a=>({deliverable_id:e,quality_standard_id:a.qsId,criteria_met:a.criteriaMet,assessed_at:new Date().toISOString(),assessed_by:n})),{error:i}=await x.from("deliverable_qs_assessments").upsert(s,{onConflict:"deliverable_id,quality_standard_id"});if(i)throw i;return!0}catch(s){throw s}}}const Lc=new Nc;class Ac extends Te{constructor(){super("kpis")}async getAllWithStatus(e){try{return(await this.getAll(e,{orderBy:{column:"name",ascending:!0}})).map(n=>({...n,rag_status:this.calculateRAG(n)}))}catch(t){throw t}}calculateRAG(e){if(!e.target_value||e.actual_value===null||e.actual_value===void 0)return"Unknown";const t=parseFloat(e.actual_value),n=parseFloat(e.target_value),s=parseFloat(e.threshold_amber||10);return e.trend==="higher_better"?t>=n?"Green":t>=n*(1-s/100)?"Amber":"Red":t<=n?"Green":t<=n*(1+s/100)?"Amber":"Red"}async getByRAGStatus(e,t){try{return(await this.getAllWithStatus(e)).filter(s=>s.rag_status===t)}catch(n){throw n}}async getNeedingAttention(e){try{return(await this.getAllWithStatus(e)).filter(n=>n.rag_status==="Amber"||n.rag_status==="Red")}catch(t){throw t}}async updateActualValue(e,t){return this.update(e,{actual_value:t,last_updated:new Date().toISOString()})}async getHistory(e,t=12){try{const{data:n,error:s}=await x.from("kpi_history").select("*").eq("kpi_id",e).order("recorded_at",{ascending:!1}).limit(t);if(s)throw s;return n||[]}catch{return[]}}async getSummary(e){try{const t=await this.getAllWithStatus(e);return{total:t.length,green:t.filter(n=>n.rag_status==="Green").length,amber:t.filter(n=>n.rag_status==="Amber").length,red:t.filter(n=>n.rag_status==="Red").length,unknown:t.filter(n=>n.rag_status==="Unknown").length}}catch(t){throw t}}async getAssessments(e){try{const{data:t,error:n}=await x.from("deliverable_kpi_assessments").select("kpi_id, criteria_met").eq("project_id",e);if(n)throw n;return t||[]}catch(t){throw t}}}const qc=new Ac;class Wc extends Te{constructor(){super("quality_standards")}async getAllWithStatus(e){try{return(await this.getAll(e,{orderBy:{column:"name",ascending:!0}})).map(n=>({...n,compliance_status:this.calculateCompliance(n)}))}catch(t){throw t}}calculateCompliance(e){if(e.actual_value===null||e.actual_value===void 0)return"Not Measured";const t=parseFloat(e.actual_value),n=parseFloat(e.target_value||0);return t>=n?"Compliant":t>=n*.9?"Near Compliant":"Non-Compliant"}async getNonCompliant(e){try{return(await this.getAllWithStatus(e)).filter(n=>n.compliance_status==="Non-Compliant")}catch(t){throw t}}async updateMeasurement(e,t,n){return this.update(e,{actual_value:t,measurement_notes:n,last_measured:new Date().toISOString()})}async getSummary(e){try{const t=await this.getAllWithStatus(e);return{total:t.length,compliant:t.filter(n=>n.compliance_status==="Compliant").length,nearCompliant:t.filter(n=>n.compliance_status==="Near Compliant").length,nonCompliant:t.filter(n=>n.compliance_status==="Non-Compliant").length,notMeasured:t.filter(n=>n.compliance_status==="Not Measured").length}}catch(t){throw t}}}const $c=new Wc;class Bc extends Te{constructor(){super("standards",{supportsSoftDelete:!1,sanitizeConfig:"standard"})}async getAll(e){return super.getAll(e,{orderBy:{column:"standard_ref",ascending:!0}})}async getByStatus(e,t){return super.getAll(e,{filters:[{column:"status",operator:"eq",value:t}],orderBy:{column:"standard_ref",ascending:!0}})}async getByCategory(e,t){return super.getAll(e,{filters:[{column:"category",operator:"eq",value:t}],orderBy:{column:"standard_ref",ascending:!0}})}async getSummary(e){try{const t=await this.getAll(e);return{total:t.length,completed:t.filter(n=>n.status==="Completed").length,inProgress:t.filter(n=>n.status==="In Progress").length,notStarted:t.filter(n=>!n.status||n.status==="Not Started").length}}catch(t){throw t}}}new Bc;const Hc={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!0,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!0,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:4,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:6,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:8,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!0,x:0,y:12,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!0,x:6,y:12,w:6,h:3,minW:4,minH:3,maxH:5}}},Uc={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!0,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!0,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:4,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:6,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:8,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!1,x:0,y:12,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!1,x:6,y:12,w:6,h:3,minW:4,minH:3,maxH:5}}},Fc={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!1,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!1,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:2,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!0,x:0,y:4,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:6,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!0,x:0,y:10,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!0,x:6,y:10,w:6,h:3,minW:4,minH:3,maxH:5}}},Ls={version:"2.0",widgets:{"progress-hero":{visible:!0,x:0,y:0,w:12,h:2,minW:6,minH:2,maxH:3},"budget-summary":{visible:!1,x:0,y:2,w:6,h:2,minW:4,minH:2,maxH:3},"pmo-tracking":{visible:!1,x:6,y:2,w:6,h:2,minW:6,minH:2,maxH:4},"stats-grid":{visible:!0,x:0,y:2,w:12,h:2,minW:8,minH:2,maxH:3},certificates:{visible:!1,x:0,y:4,w:12,h:2,minW:6,minH:2,maxH:3},"milestones-list":{visible:!0,x:0,y:4,w:12,h:4,minW:8,minH:3,maxH:6},"kpis-category":{visible:!1,x:0,y:8,w:6,h:3,minW:4,minH:3,maxH:5},"quality-standards":{visible:!1,x:6,y:8,w:6,h:3,minW:4,minH:3,maxH:5}}},fr={...Ls},As={"progress-hero":{id:"progress-hero",title:"Project Progress",description:"Overall project completion percentage",icon:"target",category:"overview"},"budget-summary":{id:"budget-summary",title:"Budget Overview",description:"Total budget and spend to date",icon:"dollar-sign",category:"financial"},"pmo-tracking":{id:"pmo-tracking",title:"PMO Cost Tracking",description:"PMO vs Non-PMO budget breakdown",icon:"briefcase",category:"financial"},"stats-grid":{id:"stats-grid",title:"Key Statistics",description:"Milestones, deliverables, resources, KPIs, and quality standards counts",icon:"bar-chart",category:"overview"},certificates:{id:"certificates",title:"Milestone Certificates",description:"Certificate signing status summary",icon:"file-check",category:"compliance"},"milestones-list":{id:"milestones-list",title:"Milestones",description:"Milestone status, progress, and spend by milestone",icon:"clock",category:"delivery"},"kpis-category":{id:"kpis-category",title:"KPIs by Category",description:"KPI performance grouped by category",icon:"trending-up",category:"performance"},"quality-standards":{id:"quality-standards",title:"Quality Standards",description:"Quality standard achievement summary",icon:"award",category:"compliance"}};function _t(r){if(!r)return fr;const e=r.toUpperCase();return e.includes("ADMIN")?Hc:e.includes("SUPPLIER")&&e.includes("PM")?Uc:e.includes("CUSTOMER")&&e.includes("PM")?Fc:e.includes("CONTRIBUTOR")?Ls:(e.includes("VIEWER"),fr)}const hr=_t;function Gc(r){return Object.keys(As)}class Vc{constructor(){this.tableName="dashboard_layouts"}async getLayout(e,t,n){try{const{data:s,error:i}=await x.from(this.tableName).select("layout_config").eq("user_id",e).eq("project_id",t).maybeSingle();if(i)throw i;return s?.layout_config?s.layout_config:hr(n)}catch{return hr(n)}}async saveLayout(e,t,n){try{const{data:s,error:i}=await x.from(this.tableName).upsert({user_id:e,project_id:t,layout_config:n,updated_at:new Date().toISOString()},{onConflict:"user_id,project_id"}).select().single();if(i)throw i;return s}catch(s){throw s}}async deleteLayout(e,t){try{const{error:n}=await x.from(this.tableName).delete().eq("user_id",e).eq("project_id",t);if(n)throw n}catch(n){throw n}}async resetToDefault(e,t,n){try{return await this.deleteLayout(e,t),hr(n)}catch(s){throw s}}}const pr=new Vc;function Yc(r,e,t){const[n,s]=u.useState(null),[i,a]=u.useState(!0),[l,c]=u.useState(!1),[d,h]=u.useState(null),m=u.useCallback(async()=>{if(!r||!e){a(!1);return}try{a(!0);const f=await pr.getLayout(r,e);if(f)s(f);else{const y=_t(t);s(y)}}catch{const y=_t(t);s(y)}finally{a(!1)}},[r,e,t]),g=u.useCallback(async f=>{if(!(!r||!e||!f))try{c(!0),await pr.saveLayout(r,e,f),s(f),h(new Date)}catch(y){throw y}finally{c(!1)}},[r,e]),S=u.useCallback((f,y)=>{s(_=>_&&{..._,widgets:{..._.widgets,[f]:{..._.widgets[f],visible:y}}})},[]),k=u.useCallback(async f=>{const y={...n,widgets:{...n.widgets,...Object.entries(f).reduce((_,[v,C])=>(_[v]={...n.widgets[v],visible:C},_),{})}};await g(y)},[n,g]),R=u.useCallback(f=>{if(!n)return;const y={...n.widgets};f.forEach(v=>{y[v.i]&&(y[v.i]={...y[v.i],x:v.x,y:v.y,w:v.w,h:v.h})});const _={...n,widgets:y};s(_)},[n]),E=u.useCallback(async f=>{if(!n)return;const y={...n.widgets};f.forEach(v=>{y[v.i]&&(y[v.i]={...y[v.i],x:v.x,y:v.y,w:v.w,h:v.h})});const _={...n,widgets:y};await g(_)},[n,g]),w=u.useCallback(async()=>{if(!(!r||!e))try{c(!0),await pr.deleteLayout(r,e);const f=_t(t);s(f),h(new Date)}catch(f){throw f}finally{c(!1)}},[r,e,t]),D=u.useCallback(f=>!n||!n.widgets?!0:n.widgets[f]?.visible!==!1,[n]),b=u.useCallback(()=>!n||!n.widgets?[]:Object.entries(n.widgets).filter(([f,y])=>y.visible!==!1).map(([f,y])=>({i:f,x:y.x||0,y:y.y||0,w:y.w||12,h:y.h||2,minW:y.minW,minH:y.minH,maxH:y.maxH})),[n]),p=u.useCallback(f=>!n||!n.widgets?null:n.widgets[f],[n]);return u.useEffect(()=>{m()},[m]),{layout:n,loading:i,saving:l,lastSaved:d,updateVisibility:S,bulkUpdateVisibility:k,updateLayoutPositions:R,saveLayoutPositions:E,resetToDefault:w,isWidgetVisible:D,getGridLayout:b,getWidgetConfig:p}}function Xc({isOpen:r,onClose:e,layout:t,role:n,onUpdateVisibility:s,onReset:i,saving:a,lastSaved:l}){const[c,d]=u.useState({}),[h,m]=u.useState(!1),g=Gc(),S=p=>c.hasOwnProperty(p)?c[p]:t?.widgets?.[p]?.visible!==!1,k=p=>{d(f=>({...f,[p]:!S(p)}))},R=async()=>{if(Object.keys(c).length===0){e();return}try{await s(c),d({}),e()}catch{}},E=()=>{d({}),e()},w=async()=>{try{await i(),d({}),m(!1)}catch{}};if(!r)return null;const D=g.filter(p=>S(p)).length,b=Object.keys(c).length>0;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"dashboard-customize-backdrop",onClick:E,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999,opacity:r?1:0,transition:"opacity 0.3s ease"}}),o.jsxs("div",{className:"dashboard-customize-panel",style:{position:"fixed",top:0,right:r?0:"-400px",bottom:0,width:"400px",maxWidth:"90vw",backgroundColor:"white",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.15)",zIndex:1e3,display:"flex",flexDirection:"column",transition:"right 0.3s ease"},children:[o.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"600"},children:"Customize Dashboard"}),o.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.875rem",color:"#64748b"},children:[D," of ",g.length," widgets visible"]})]}),o.jsx("button",{onClick:E,style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",color:"#64748b",borderRadius:"4px"},onMouseEnter:p=>p.target.style.backgroundColor="#f1f5f9",onMouseLeave:p=>p.target.style.backgroundColor="transparent",children:o.jsx(Ve,{size:20})})]}),o.jsx("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:o.jsxs("div",{style:{marginBottom:"1rem"},children:[o.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Available Widgets"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:g.map(p=>{const f=As[p],y=S(p),_=c.hasOwnProperty(p);return o.jsx("div",{onClick:()=>k(p),style:{padding:"1rem",border:"1px solid #e2e8f0",borderRadius:"8px",cursor:"pointer",backgroundColor:y?"#f0f9ff":"white",borderColor:y?"#3b82f6":"#e2e8f0",transition:"all 0.2s ease",position:"relative"},onMouseEnter:v=>{y||(v.target.style.backgroundColor="#f8fafc")},onMouseLeave:v=>{y||(v.target.style.backgroundColor="white")},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[o.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:y?"#3b82f6":"#e2e8f0",display:"flex",alignItems:"center",justifyContent:"center",color:y?"white":"#64748b",flexShrink:0},children:y?o.jsx(zo,{size:20}):o.jsx(Mo,{size:20})}),o.jsxs("div",{style:{flex:1},children:[o.jsx("div",{style:{fontWeight:"500",fontSize:"0.9375rem",marginBottom:"0.125rem",color:y?"#1e293b":"#64748b"},children:f.title}),o.jsx("div",{style:{fontSize:"0.8125rem",color:"#64748b"},children:f.description})]}),_&&o.jsx("div",{style:{position:"absolute",top:"0.5rem",right:"0.5rem",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b"}})]})},p)})})]})}),o.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l&&!b&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.8125rem",color:"#10b981"},children:[o.jsx(zr,{size:16}),"Saved ",new Date(l).toLocaleTimeString()]}),o.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:h?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>m(!1),style:{flex:1,padding:"0.625rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:w,disabled:a,style:{flex:1,padding:"0.625rem",border:"none",borderRadius:"6px",backgroundColor:"#ef4444",color:"white",fontSize:"0.875rem",fontWeight:"500",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Resetting...":"Confirm Reset"})]}):o.jsxs("button",{onClick:()=>m(!0),style:{flex:1,padding:"0.625rem 1rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},onMouseEnter:p=>{p.target.style.backgroundColor="#f8fafc",p.target.style.borderColor="#cbd5e1"},onMouseLeave:p=>{p.target.style.backgroundColor="white",p.target.style.borderColor="#e2e8f0"},children:[o.jsx(An,{size:16}),"Reset to Default"]})}),o.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[o.jsx("button",{onClick:E,style:{flex:1,padding:"0.625rem 1rem",border:"1px solid #e2e8f0",borderRadius:"6px",backgroundColor:"white",color:"#64748b",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},onMouseEnter:p=>{p.target.style.backgroundColor="#f8fafc"},onMouseLeave:p=>{p.target.style.backgroundColor="white"},children:"Cancel"}),o.jsx("button",{onClick:R,disabled:a||!b,style:{flex:1,padding:"0.625rem 1rem",border:"none",borderRadius:"6px",backgroundColor:b?"#3b82f6":"#94a3b8",color:"white",fontSize:"0.875rem",fontWeight:"500",cursor:a||!b?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:a?"Saving...":o.jsxs(o.Fragment,{children:[o.jsx(To,{size:16}),"Apply Changes"]})})]})]})]})]})}const Kc=Pn.WidthProvider(Pn.Responsive);function On(r){if(!r)return!1;const e=r.toLowerCase();return e.includes("pmo")||e.includes("project manager")}function Qc(){const{showTestUsers:r,testUserIds:e}=bi(),{projectId:t,projectName:n,projectRef:s}=Gn(),{user:i,role:a}=Tt(),{layout:l,loading:c,saving:d,lastSaved:h,bulkUpdateVisibility:m,saveLayoutPositions:g,resetToDefault:S,getGridLayout:k}=Yc(i?.id,t,a),[R,E]=u.useState(!1),[w,D]=u.useState(!0),[b,p]=u.useState({totalMilestones:0,completedMilestones:0,totalDeliverables:0,deliveredCount:0,totalResources:0,totalKPIs:0,achievedKPIs:0,totalQS:0,achievedQS:0,totalBudget:0,spendToDate:0}),[f,y]=u.useState({signed:0,pending:0,awaitingGeneration:0}),[_,v]=u.useState({pmoBudget:0,pmoSpend:0,nonPmoBudget:0,nonPmoSpend:0,pmoResources:[],nonPmoResources:[]}),[C,T]=u.useState([]),[L,I]=u.useState({}),[Z,he]=u.useState({}),[Pe,z]=u.useState([]),[X,ye]=u.useState(0),ue=u.useRef(null),re=u.useCallback(async()=>{if(t){D(!0);try{const Y=await Ic.getAll(t,{orderBy:{column:"milestone_ref",ascending:!0}});T(Y);const q=await Lc.getSummary(t),ie=await qc.getAll(t,{orderBy:{column:"kpi_ref",ascending:!0}}),P=await $c.getAll(t,{orderBy:{column:"qs_ref",ascending:!0}});z(P);const{data:M}=await x.from("resources").select("*"),A=await kc.getAllFiltered(t,r);let H=0,V=0;const se=[],de=[];M&&M.forEach(U=>{const Se=(U.daily_rate||0)*(U.days_allocated||0);On(U.role)?(H+=Se,se.push({name:U.name,role:U.role,budget:Se})):(V+=Se,de.push({name:U.name,role:U.role,budget:Se}))});const pe={};let oe=0,_e=0,J=0;A&&M&&A.forEach(U=>{if(!(U.status==="Approved"||U.status==="Submitted"&&!U.was_rejected))return;const Xs=parseFloat(U.hours_worked||U.hours||0),Kt=U.resources||M.find(Qe=>Qe.id===U.resource_id);if(Kt){const Qe=Xs/8*(Kt.daily_rate||0);U.milestone_id&&(pe[U.milestone_id]=(pe[U.milestone_id]||0)+Qe),oe+=Qe,On(Kt.role)?_e+=Qe:J+=Qe}}),I(pe),v({pmoBudget:H,pmoSpend:_e,nonPmoBudget:V,nonPmoSpend:J,pmoResources:se,nonPmoResources:de});const ee={};ie.forEach(U=>{const Se=U.category||"Other";ee[Se]||(ee[Se]=[]),ee[Se].push(U)}),he(ee);const xe=Y.length,st=Y.filter(U=>U.status==="Completed").length,mt=q.total,Ce=q.delivered,qs=M?.length||0,Ws=ie.length,$s=ie.filter(U=>(U.current_value||0)>=(U.target||90)).length,Bs=P.length,Hs=P.filter(U=>(U.current_value||0)>=(U.target||100)).length,{data:Xt}=await x.from("milestone_certificates").select("*").eq("project_id",t),Us=Xt?.filter(U=>U.status==="Signed").length||0,Fs=Xt?.filter(U=>U.status==="Pending Customer Signature"||U.status==="Pending Supplier Signature").length||0,Gs=Math.max(0,st-(Xt?.length||0));y({signed:Us,pending:Fs,awaitingGeneration:Gs});const Vs=Y.reduce((U,Se)=>U+(Se.budget||0),0),Ys=xe>0?Math.round(Y.reduce((U,Se)=>U+(Se.progress||0),0)/xe):0;ye(Ys),p({totalMilestones:xe,completedMilestones:st,totalDeliverables:mt,deliveredCount:Ce,totalResources:qs,totalKPIs:Ws,achievedKPIs:$s,totalQS:Bs,achievedQS:Hs,totalBudget:Vs,spendToDate:oe})}catch{}finally{D(!1)}}},[t,r]);u.useEffect(()=>{re()},[re]);function ne(Y){switch(Y){case"Time Performance":return"#3b82f6";case"Quality of Collaboration":return"#8b5cf6";case"Delivery Performance":return"#10b981";default:return"#64748b"}}const B=u.useCallback(Y=>{ue.current&&clearTimeout(ue.current),ue.current=setTimeout(()=>{g(Y)},1e3)},[g]),O=Y=>{switch(Y){case"progress-hero":return o.jsx("div",{className:"card",style:{height:"100%",background:"linear-gradient(135deg, #1e3a5f 0%, #2563eb 100%)",color:"white",display:"flex",alignItems:"center"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[o.jsxs("div",{children:[o.jsxs("h2",{style:{fontSize:"2.5rem",fontWeight:"700",margin:0},children:[X,"%"]}),o.jsx("p",{style:{opacity:.9,margin:0},children:"Overall Progress"})]}),o.jsx("div",{style:{width:"120px",height:"120px",position:"relative"},children:o.jsxs("svg",{viewBox:"0 0 100 100",style:{transform:"rotate(-90deg)"},children:[o.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"10"}),o.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"white",strokeWidth:"10",strokeDasharray:`${X*2.51} 251`,strokeLinecap:"round"})]})})]})});case"budget-summary":return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",height:"100%"},children:[o.jsx("div",{className:"card",style:{borderLeft:"4px solid #3b82f6",height:"100%"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b",marginBottom:"0.25rem"},children:"Total Budget"}),o.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#3b82f6"},children:["Â£",b.totalBudget.toLocaleString()]})]}),o.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#dbeafe",borderRadius:"8px"},children:o.jsx(Lo,{size:24,style:{color:"#3b82f6"}})})]})}),o.jsx("div",{className:"card",style:{borderLeft:"4px solid #10b981",height:"100%"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:"0.85rem",color:"#64748b",marginBottom:"0.25rem"},children:"Spend to Date"}),o.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#10b981"},children:["Â£",Math.round(b.spendToDate).toLocaleString()]}),o.jsxs("div",{style:{fontSize:"0.85rem",color:"#64748b"},children:[b.totalBudget>0?Math.round(b.spendToDate/b.totalBudget*100):0,"% of budget"]})]}),o.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#dcfce7",borderRadius:"8px"},children:o.jsx(wt,{size:24,style:{color:"#10b981"}})})]})})]});case"pmo-tracking":return o.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[o.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx(No,{size:20})," PMO Cost Tracking"]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.75rem",marginBottom:"1rem"},children:[o.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#fef3c7",borderRadius:"8px",borderLeft:"4px solid #f59e0b"},children:[o.jsx("div",{style:{fontSize:"0.75rem",color:"#92400e",marginBottom:"0.25rem"},children:"PMO Budget"}),o.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#d97706"},children:["Â£",Math.round(_.pmoBudget/1e3),"k"]})]}),o.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#ffedd5",borderRadius:"8px",borderLeft:"4px solid #ea580c"},children:[o.jsx("div",{style:{fontSize:"0.75rem",color:"#9a3412",marginBottom:"0.25rem"},children:"PMO Spend"}),o.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#ea580c"},children:["Â£",Math.round(_.pmoSpend/1e3),"k"]})]}),o.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#dbeafe",borderRadius:"8px",borderLeft:"4px solid #3b82f6"},children:[o.jsx("div",{style:{fontSize:"0.75rem",color:"#1e40af",marginBottom:"0.25rem"},children:"Non-PMO Budget"}),o.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#2563eb"},children:["Â£",Math.round(_.nonPmoBudget/1e3),"k"]})]}),o.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#dcfce7",borderRadius:"8px",borderLeft:"4px solid #16a34a"},children:[o.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"Non-PMO Spend"}),o.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#16a34a"},children:["Â£",Math.round(_.nonPmoSpend/1e3),"k"]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[o.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500"},children:"Spend Distribution"}),o.jsxs("span",{style:{fontSize:"0.85rem",color:"#64748b"},children:["PMO: ",b.spendToDate>0?Math.round(_.pmoSpend/b.spendToDate*100):0,"% | Non-PMO: ",b.spendToDate>0?Math.round(_.nonPmoSpend/b.spendToDate*100):0,"%"]})]}),o.jsxs("div",{style:{display:"flex",height:"24px",borderRadius:"4px",overflow:"hidden",backgroundColor:"#e2e8f0"},children:[o.jsx("div",{style:{width:`${b.spendToDate>0?_.pmoSpend/b.spendToDate*100:0}%`,backgroundColor:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.75rem",fontWeight:"600",minWidth:_.pmoSpend>0?"40px":"0"},children:_.pmoSpend>0&&"PMO"}),o.jsx("div",{style:{width:`${b.spendToDate>0?_.nonPmoSpend/b.spendToDate*100:0}%`,backgroundColor:"#3b82f6",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.75rem",fontWeight:"600",minWidth:_.nonPmoSpend>0?"60px":"0"},children:_.nonPmoSpend>0&&"Non-PMO"})]})]})]});case"stats-grid":return o.jsxs("div",{style:{height:"100%",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem"},children:[o.jsx(gt,{icon:ut,label:"Milestones",value:`${b.completedMilestones} / ${b.totalMilestones}`,subtext:`${b.totalMilestones>0?Math.round(b.completedMilestones/b.totalMilestones*100):0}% Complete`,color:"#3b82f6"}),o.jsx(gt,{icon:gr,label:"Deliverables",value:`${b.deliveredCount} / ${b.totalDeliverables}`,subtext:`${b.totalDeliverables>0?Math.round(b.deliveredCount/b.totalDeliverables*100):0}% Delivered`,color:"#10b981"}),o.jsx(gt,{icon:wt,label:"KPIs",value:`${b.achievedKPIs} / ${b.totalKPIs}`,subtext:`${b.totalKPIs>0?Math.round(b.achievedKPIs/b.totalKPIs*100):0}% Achieved`,color:"#3b82f6"}),o.jsx(gt,{icon:jt,label:"Quality Standards",value:`${b.achievedQS} / ${b.totalQS}`,subtext:`${b.totalQS>0?Math.round(b.achievedQS/b.totalQS*100):0}% Achieved`,color:"#8b5cf6"})]});case"certificates":return o.jsx("div",{className:"card",style:{height:"100%",backgroundColor:"#fefce8",borderLeft:"4px solid #eab308"},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"1rem"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[o.jsx(Io,{size:28,style:{color:"#ca8a04"}}),o.jsx("div",{children:o.jsx("h4",{style:{margin:0,color:"#854d0e"},children:"Milestone Certificates"})})]}),o.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#16a34a"},children:f.signed}),o.jsx("div",{style:{fontSize:"0.8rem",color:"#166534"},children:"Signed"})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#d97706"},children:f.pending}),o.jsx("div",{style:{fontSize:"0.8rem",color:"#92400e"},children:"Pending"})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:f.awaitingGeneration>0?"#dc2626":"#64748b"},children:f.awaitingGeneration}),o.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:"Awaiting"})]})]}),o.jsx(qe,{to:"/milestones",style:{padding:"0.5rem 1rem",backgroundColor:"#ca8a04",color:"white",textDecoration:"none",borderRadius:"6px",fontWeight:"500"},children:"View â†’"})]})});case"milestones-list":return o.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[o.jsx("h3",{style:{marginBottom:"0.5rem"},children:"Billable vs Spend by Milestone"}),o.jsxs("div",{style:{display:"flex",gap:"0.25rem",marginBottom:"1rem"},children:[o.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",marginRight:"1rem"},children:[o.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:"#3b82f6",borderRadius:"2px"}}),"Billable"]}),o.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem"},children:[o.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:"#10b981",borderRadius:"2px"}}),"Spend"]})]}),o.jsx("div",{style:{display:"flex",gap:"0.5rem",height:"calc(100% - 80px)",alignItems:"flex-end"},children:C.map(q=>{const ie=Math.max(...C.map(H=>H.budget||0)),P=L[q.id]||0,M=ie>0?(q.budget||0)/ie*100:0,A=ie>0?P/ie*100:0;return o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[o.jsxs("div",{style:{display:"flex",gap:"2px",alignItems:"flex-end",height:"100%",width:"100%",justifyContent:"center"},children:[o.jsx("div",{style:{width:"45%",height:`${M}%`,backgroundColor:"#3b82f6",borderRadius:"4px 4px 0 0",minHeight:q.budget>0?"20px":"0",position:"relative"},title:`Billable: Â£${(q.budget||0).toLocaleString()}`,children:M>15&&o.jsxs("span",{style:{position:"absolute",top:"4px",left:"50%",transform:"translateX(-50%)",fontSize:"0.65rem",fontWeight:"600",color:"white"},children:["Â£",Math.round((q.budget||0)/1e3),"k"]})}),o.jsx("div",{style:{width:"45%",height:`${A}%`,backgroundColor:"#10b981",borderRadius:"4px 4px 0 0",minHeight:P>0?"20px":"0",position:"relative"},title:`Spend: Â£${Math.round(P).toLocaleString()}`,children:A>15&&o.jsxs("span",{style:{position:"absolute",top:"4px",left:"50%",transform:"translateX(-50%)",fontSize:"0.65rem",fontWeight:"600",color:"white"},children:["Â£",Math.round(P/1e3),"k"]})})]}),o.jsx("span",{style:{fontSize:"0.7rem",fontWeight:"600",color:"#64748b"},children:q.milestone_ref})]},q.id)})})]});case"kpis-category":return o.jsxs("div",{className:"card",style:{height:"100%"},children:[o.jsx("h3",{style:{marginBottom:"1rem"},children:"KPI Performance"}),o.jsx("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end",height:"calc(100% - 50px)"},children:Object.entries(Z).map(([q,ie])=>{const P=ie.length,M=ie.filter(H=>(H.current_value||0)>=(H.target||90)).length,A=P>0?M/P*100:0;return o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem",height:"100%"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[o.jsx("div",{style:{height:`${100-A}%`,backgroundColor:"#e2e8f0",borderRadius:A>0?"4px 4px 0 0":"4px"}}),o.jsxs("div",{style:{height:`${A}%`,backgroundColor:ne(q),borderRadius:A<100?"0 0 4px 4px":"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"700"},children:[M,"/",P]})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontWeight:"600",fontSize:"0.75rem"},children:q.split(" ")[0]}),o.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:[Math.round(A),"%"]})]})]},q)})})]});case"quality-standards":return o.jsxs("div",{className:"card",style:{height:"100%",overflowY:"auto"},children:[o.jsx("h3",{style:{marginBottom:"1rem"},children:"Quality Standards"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Pe.map(q=>{const ie=q.current_value||0,P=ie>=(q.target||100);return o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[o.jsx("span",{style:{fontFamily:"monospace",fontWeight:"600",minWidth:"45px",color:"#8b5cf6"},children:q.qs_ref}),o.jsx("div",{style:{flex:1},children:o.jsx("div",{style:{height:"8px",backgroundColor:"#e2e8f0",borderRadius:"4px",overflow:"hidden"},children:o.jsx("div",{style:{width:`${ie}%`,height:"100%",backgroundColor:P?"#10b981":"#8b5cf6"}})})}),o.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:"600",minWidth:"45px",color:P?"#10b981":"#64748b"},children:[ie,"%"]})]},q.id)})})]});default:return null}};if(w||c)return o.jsx(Tr,{message:"Loading dashboard...",size:"large",fullPage:!0});const Q=k();return o.jsxs("div",{className:"page-container",children:[o.jsx(Oi,{icon:sn,title:`${s||"Project"} Dashboard`,subtitle:n||"Project Tracker",children:o.jsxs("button",{onClick:()=>E(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem"},children:[o.jsx(Ln,{size:18}),"Customize"]})}),o.jsx(Kc,{className:"layout",layouts:{lg:Q},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:100,onLayoutChange:B,draggableHandle:".drag-handle",margin:[16,16],containerPadding:[0,0],children:Q.map(Y=>o.jsxs("div",{style:{position:"relative"},children:[o.jsx("div",{className:"drag-handle",style:{position:"absolute",top:"8px",right:"8px",width:"24px",height:"24px",cursor:"move",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},title:"Drag to move",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[o.jsx("circle",{cx:"4",cy:"4",r:"1.5",fill:"#64748b"}),o.jsx("circle",{cx:"12",cy:"4",r:"1.5",fill:"#64748b"}),o.jsx("circle",{cx:"4",cy:"8",r:"1.5",fill:"#64748b"}),o.jsx("circle",{cx:"12",cy:"8",r:"1.5",fill:"#64748b"}),o.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"#64748b"}),o.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"#64748b"})]})}),O(Y.i)]},Y.i))}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginTop:"2rem"},children:[o.jsxs(qe,{to:"/milestones",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[o.jsx(ut,{size:32,style:{color:"#3b82f6",marginBottom:"0.5rem"}}),o.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Milestones"})]}),o.jsxs(qe,{to:"/deliverables",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[o.jsx(gr,{size:32,style:{color:"#10b981",marginBottom:"0.5rem"}}),o.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Deliverables"})]}),o.jsxs(qe,{to:"/kpis",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[o.jsx(wt,{size:32,style:{color:"#3b82f6",marginBottom:"0.5rem"}}),o.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"KPIs"})]}),o.jsxs(qe,{to:"/quality-standards",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[o.jsx(jt,{size:32,style:{color:"#8b5cf6",marginBottom:"0.5rem"}}),o.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Quality"})]}),o.jsxs(qe,{to:"/reports",className:"card",style:{textDecoration:"none",padding:"1.5rem",cursor:"pointer",border:"2px solid #e2e8f0"},children:[o.jsx(sn,{size:32,style:{color:"#f59e0b",marginBottom:"0.5rem"}}),o.jsx("h4",{style:{margin:"0 0 0.25rem 0",color:"#1e293b"},children:"Reports"})]})]}),o.jsx(Xc,{isOpen:R,onClose:()=>E(!1),layout:l,role:a,onUpdateVisibility:m,onReset:S,saving:d,lastSaved:h})]})}const Jc=u.lazy(()=>le(()=>import("./ResetPassword-sER4OhAx.js"),__vite__mapDeps([0,1,2,3,4]))),Zc=u.lazy(()=>le(()=>import("./Milestones-Dx8XqXVv.js"),__vite__mapDeps([5,1,6,7,2,3,4]))),ed=u.lazy(()=>le(()=>import("./MilestoneDetail-DFkllmIr.js"),__vite__mapDeps([8,1,2,3,4]))),td=u.lazy(()=>le(()=>import("./Gantt-CgQk36pX.js"),__vite__mapDeps([9,1,6,2,3,4]))),rd=u.lazy(()=>le(()=>import("./Deliverables-B6tPf3qz.js"),__vite__mapDeps([10,1,6,2,3,4]))),nd=u.lazy(()=>le(()=>import("./Resources-Qi60qZv7.js"),__vite__mapDeps([11,1,6,7,2,3,4]))),sd=u.lazy(()=>le(()=>import("./ResourceDetail-B09ec6t8.js"),__vite__mapDeps([12,1,6,2,3,4]))),od=u.lazy(()=>le(()=>import("./Partners-lTf0gHFd.js"),__vite__mapDeps([13,1,6,7,2,3,4]))),id=u.lazy(()=>le(()=>import("./PartnerDetail-B_vz0sJ2.js"),__vite__mapDeps([14,1,6,2,3,4]))),ad=u.lazy(()=>le(()=>import("./Timesheets-Du8wrTIo.js"),__vite__mapDeps([15,1,6,7,2,3,4]))),ld=u.lazy(()=>le(()=>import("./Expenses-DGKLL0Lk.js"),__vite__mapDeps([16,1,6,7,2,3,4,17]))),cd=u.lazy(()=>le(()=>import("./KPIs-WRg1iOlO.js"),__vite__mapDeps([18,1,6,7,2,3,4]))),dd=u.lazy(()=>le(()=>import("./KPIDetail-fV7lHiXc.js"),__vite__mapDeps([19,1,6,2,3,4]))),ud=u.lazy(()=>le(()=>import("./QualityStandards-DLFFfN0N.js"),__vite__mapDeps([20,1,6,7,2,3,4]))),fd=u.lazy(()=>le(()=>import("./QualityStandardDetail-Cj70D-5R.js"),__vite__mapDeps([21,1,2,3,4]))),hd=u.lazy(()=>le(()=>import("./Reports-Ssob1pSn.js"),__vite__mapDeps([22,2,1,3,4]))),pd=u.lazy(()=>le(()=>import("./Users-B8C8iZnE.js"),__vite__mapDeps([23,1,2,3,4]))),md=u.lazy(()=>le(()=>import("./Settings-CFkgeHke.js"),__vite__mapDeps([24,1,6,2,3,4]))),gd=u.lazy(()=>le(()=>import("./AccountSettings-DQsrv8ue.js"),__vite__mapDeps([25,1,2,3,4]))),yd=u.lazy(()=>le(()=>import("./WorkflowSummary-D6SNMKMF.js"),__vite__mapDeps([26,1,2,3,4]))),bd=u.lazy(()=>le(()=>import("./AuditLog-_turm5C7.js"),__vite__mapDeps([27,1,2,3,4]))),vd=u.lazy(()=>le(()=>import("./DeletedItems-CP1n6Q7e.js"),__vite__mapDeps([28,1,7,2,3,4])));function xd(){return o.jsx("div",{className:"page-container",children:o.jsx(lt,{type:"page"})})}function ae({children:r}){const{user:e,isLoading:t}=Tt();return t?o.jsx(Tr,{message:"Loading...",size:"large",fullPage:!0}):e?o.jsx(Xi,{children:o.jsx(u.Suspense,{fallback:o.jsx(xd,{}),children:r||o.jsx(so,{})})}):o.jsx(mr,{to:"/login",replace:!0})}function wd(){return o.jsx(ro,{children:o.jsx(Ci,{children:o.jsx(Ti,{children:o.jsx(mi,{children:o.jsx(gi,{children:o.jsx(yi,{children:o.jsx(xi,{children:o.jsxs(ji,{children:[o.jsxs(no,{children:[o.jsx(te,{path:"/login",element:o.jsx(Ki,{})}),o.jsx(te,{path:"/reset-password",element:o.jsx(u.Suspense,{fallback:o.jsx(Tr,{fullPage:!0}),children:o.jsx(Jc,{})})}),o.jsx(te,{path:"/",element:o.jsx(mr,{to:"/dashboard",replace:!0})}),o.jsx(te,{path:"/dashboard",element:o.jsx(ae,{children:o.jsx(Qc,{})})}),o.jsx(te,{path:"/milestones",element:o.jsx(ae,{children:o.jsx(Zc,{})})}),o.jsx(te,{path:"/milestones/:id",element:o.jsx(ae,{children:o.jsx(ed,{})})}),o.jsx(te,{path:"/gantt",element:o.jsx(ae,{children:o.jsx(td,{})})}),o.jsx(te,{path:"/deliverables",element:o.jsx(ae,{children:o.jsx(rd,{})})}),o.jsx(te,{path:"/resources",element:o.jsx(ae,{children:o.jsx(nd,{})})}),o.jsx(te,{path:"/resources/:id",element:o.jsx(ae,{children:o.jsx(sd,{})})}),o.jsx(te,{path:"/partners",element:o.jsx(ae,{children:o.jsx(od,{})})}),o.jsx(te,{path:"/partners/:id",element:o.jsx(ae,{children:o.jsx(id,{})})}),o.jsx(te,{path:"/timesheets",element:o.jsx(ae,{children:o.jsx(ad,{})})}),o.jsx(te,{path:"/expenses",element:o.jsx(ae,{children:o.jsx(ld,{})})}),o.jsx(te,{path:"/kpis",element:o.jsx(ae,{children:o.jsx(cd,{})})}),o.jsx(te,{path:"/kpis/:id",element:o.jsx(ae,{children:o.jsx(dd,{})})}),o.jsx(te,{path:"/quality-standards",element:o.jsx(ae,{children:o.jsx(ud,{})})}),o.jsx(te,{path:"/quality-standards/:id",element:o.jsx(ae,{children:o.jsx(fd,{})})}),o.jsx(te,{path:"/reports",element:o.jsx(ae,{children:o.jsx(hd,{})})}),o.jsx(te,{path:"/users",element:o.jsx(ae,{children:o.jsx(pd,{})})}),o.jsx(te,{path:"/settings",element:o.jsx(ae,{children:o.jsx(md,{})})}),o.jsx(te,{path:"/account",element:o.jsx(ae,{children:o.jsx(gd,{})})}),o.jsx(te,{path:"/workflow-summary",element:o.jsx(ae,{children:o.jsx(yd,{})})}),o.jsx(te,{path:"/audit-log",element:o.jsx(ae,{children:o.jsx(bd,{})})}),o.jsx(te,{path:"/deleted-items",element:o.jsx(ae,{children:o.jsx(vd,{})})}),o.jsx(te,{path:"*",element:o.jsx(mr,{to:"/dashboard",replace:!0})})]}),o.jsx(Ni,{}),o.jsx(ti,{}),o.jsx(di,{})]})})})})})})})})}yr.createRoot(document.getElementById("root")).render(o.jsx(kn.StrictMode,{children:o.jsx(wd,{})}));export{Tr as L,Oi as P,$i as R,gt as S,Gn as a,Ii as b,bi as c,Lc as d,Md as e,j as f,Pd as g,Ed as h,Td as i,o as j,qc as k,Wi as l,Ic as m,kd as p,$c as q,zd as r,x as s,kc as t,Tt as u};
