import{o as t,R as b,v as u,u as B,w as z,P as H}from"./index-ryn4JIWc.js";function d(e,n){return n.includes(e)}function J(e){return d(e,[u.ADMIN,u.SUPPLIER_PM])}function m(e){return t(e,"timesheets","create")}function g(e){return t(e,"timesheets","createForOthers")}function l(e){return t(e,"timesheets","approve")}function Y(e,n,r,c){if(t(e,"timesheets","createForOthers"))return!0;let i,a,s;return typeof n=="object"&&n!==null?(i=n.status,a=n.created_by||n.resource?.user_id,s=r):(i=n,a=r,s=c),a===s&&(i==="Draft"||i==="Rejected")}function Z(e,n,r,c){if(t(e,"timesheets","delete"))return!0;let i,a,s;return typeof n=="object"&&n!==null?(i=n.status,a=n.created_by||n.resource?.user_id,s=r):(i=n,a=r,s=c),a===s&&i==="Draft"}function $(e,n,r,c){let i,a,s;return typeof n=="object"&&n!==null?(i=n.status,a=n.created_by||n.resource?.user_id,s=r):(i=n,a=r,s=c),i!=="Draft"&&i!=="Rejected"?!1:t(e,"timesheets","createForOthers")?!0:a===s&&t(e,"timesheets","submit")}function f(e){return t(e,"expenses","create")}function p(e){return t(e,"expenses","createForOthers")}function E(e){return t(e,"expenses","validateChargeable")}function A(e){return t(e,"expenses","validateNonChargeable")}function ee(e,n,r){let c,i;return typeof n=="object"&&n!==null?(c=n.status,i=n.chargeable||n.chargeable_to_customer):(c=n,i=r),c!=="Submitted"?!1:i?t(e,"expenses","validateChargeable"):t(e,"expenses","validateNonChargeable")}function ne(e,n,r,c){if(t(e,"expenses","createForOthers"))return!0;let i,a,s;return typeof n=="object"&&n!==null?(i=n.status,a=n.created_by,s=r):(i=n,a=r,s=c),a===s&&(i==="Draft"||i==="Rejected")}function te(e,n,r,c){if(t(e,"expenses","delete"))return!0;let i,a,s;return typeof n=="object"&&n!==null?(i=n.status,a=n.created_by,s=r):(i=n,a=r,s=c),a===s&&i==="Draft"}function v(e){return t(e,"milestones","create")}function y(e){return t(e,"milestones","edit")}function D(e){return t(e,"milestones","delete")}function P(e){return t(e,"milestones","useGantt")}function h(e){return t(e,"deliverables","create")}function M(e){return t(e,"deliverables","edit")}function w(e){return t(e,"deliverables","delete")}function C(e){return t(e,"deliverables","review")}function ae(e){return t(e,"deliverables","submit")}function re(e,n,r){return t(e,"deliverables","edit")?!0:e===u.CONTRIBUTOR?n?.assigned_to===r||n?.resource?.user_id===r:!1}function S(e){return t(e,"kpis","manage")}function ie(e){return t(e,"kpis","create")}function ce(e){return t(e,"kpis","edit")}function se(e){return t(e,"kpis","delete")}function I(e){return t(e,"qualityStandards","manage")}function ue(e){return t(e,"qualityStandards","create")}function oe(e){return t(e,"qualityStandards","edit")}function le(e){return t(e,"qualityStandards","delete")}function T(e){return t(e,"resources","manage")}function de(e){return t(e,"resources","create")}function fe(e){return t(e,"resources","edit")}function _(e){return t(e,"resources","delete")}function R(e){return t(e,"resources","seeCostPrice")}function ge(e){return t(e,"resources","seeResourceType")}function V(e){return t(e,"resources","seeMargins")}function F(e){return t(e,"partners","view")}function N(e){return t(e,"partners","manage")}function be(e){return t(e,"partners","create")}function me(e){return t(e,"partners","edit")}function pe(e){return t(e,"partners","delete")}function G(e){return t(e,"certificates","signAsSupplier")}function j(e){return t(e,"certificates","signAsCustomer")}function Ee(e){return t(e,"certificates","create")}function x(e){return t(e,"settings","access")}function Ae(e){return t(e,"settings","edit")}function L(e){return t(e,"users","manage")}function ve(e){return t(e,"users","view")}function k(e){return t(e,"reports","viewWorkflowSummary")}function U(e){return t(e,"invoices","generateCustomer")}function K(e){return t(e,"invoices","generateThirdParty")}function ye(e){return t(e,"invoices","viewMargins")}function De(e){return t(e,"reports","access")}function Q(e,n,r){return!n||!Array.isArray(n)?[]:g(e)?n:n.filter(c=>c.user_id===r)}function Pe(e,n){return!e||!Array.isArray(e)?null:e.find(r=>r.user_id===n)||null}function q(e,n,r){const c=Q(e,n,r);return c.length===0?null:c.find(a=>a.user_id===r)||c[0]}function he(e,n,r){return q(e,n,r)?.id||null}function W(e){return b[e]||b[u.VIEWER]}function O(e){return W(e).label}function Me(e){return{role:e,roleLabel:O(e),timesheets:{canAdd:m(e),canAddForOthers:g(e),canApprove:l(e)},expenses:{canAdd:f(e),canAddForOthers:p(e),canValidateChargeable:E(e),canValidateNonChargeable:A(e)},milestones:{canCreate:v(e),canEdit:y(e),canDelete:D(e),canUseGantt:P(e)},deliverables:{canCreate:h(e),canEdit:M(e),canDelete:w(e),canReview:C(e)},kpis:{canManage:S(e)},qualityStandards:{canManage:I(e)},resources:{canManage:T(e),canDelete:_(e),canSeeCostPrice:R(e),canSeeMargins:V(e)},partners:{canView:F(e),canManage:N(e)},certificates:{canSignAsSupplier:G(e),canSignAsCustomer:j(e)},admin:{canAccessSettings:x(e),canManageUsers:L(e),canViewWorkflowSummary:k(e)},invoicing:{canGenerateCustomerInvoice:U(e),canGenerateThirdPartyInvoice:K(e)}}}function Ce(){const{user:e,role:n}=B(),r=e?.id||null,c=(a,s)=>t(n,a,s);return{userRole:n,currentUserId:r,can:c,hasPermission:c,PERMISSION_MATRIX:H,canAddTimesheet:m(n),canAddTimesheetForOthers:g(n),canApproveTimesheets:l(n),canApproveTimesheet:l(n),canAddExpense:f(n),canAddExpenseForOthers:p(n),canValidateChargeableExpenses:E(n),canValidateNonChargeableExpenses:A(n),canCreateMilestone:v(n),canEditMilestone:y(n),canDeleteMilestone:D(n),canUseGantt:P(n),canCreateDeliverable:h(n),canEditDeliverable:M(n),canDeleteDeliverable:w(n),canReviewDeliverable:C(n),canSubmitDeliverable:ae(n),canManageKPIs:S(n),canAddKPI:ie(n),canEditKPI:ce(n),canDeleteKPI:se(n),canManageQualityStandards:I(n),canAddQualityStandard:ue(n),canEditQualityStandard:oe(n),canDeleteQualityStandard:le(n),canManageResources:T(n),canAddResource:de(n),canEditResource:fe(n),canDeleteResource:_(n),canSeeCostPrice:R(n),canSeeResourceType:ge(n),canSeeMargins:V(n),canViewPartners:F(n),canManagePartners:N(n),canAddPartner:be(n),canEditPartner:me(n),canDeletePartner:pe(n),canSignAsSupplier:G(n),canSignAsCustomer:j(n),canCreateCertificate:Ee(n),canAccessSettings:x(n),canEditSettings:Ae(n),canManageUsers:L(n),canViewUsers:ve(n),canViewWorkflowSummary:k(n),canGenerateCustomerInvoice:U(n),canGenerateThirdPartyInvoice:K(n),canViewMarginReports:ye(n),canAccessReports:De(n),canEditTimesheet:a=>Y(n,a,r),canDeleteTimesheet:a=>Z(n,a,r),canSubmitTimesheet:a=>$(n,a,r),canValidateTimesheet:a=>a.status!=="Submitted"?!1:l(n),canSubmitExpense:a=>a.status!=="Draft"&&a.status!=="Rejected"?!1:d(n,[u.ADMIN,u.SUPPLIER_PM])?!0:a.created_by===r&&f(n),canValidateExpense:a=>ee(n,a),canEditExpense:a=>ne(n,a,r),canDeleteExpense:a=>te(n,a,r),canUpdateDeliverableStatus:a=>re(n,a,r),getAvailableResources:a=>Q(n,a,r),getCurrentUserResource:a=>Pe(a,r),getDefaultResource:a=>q(n,a,r),getDefaultResourceId:a=>he(n,a,r),getPermissionSummary:()=>Me(n),getRoleConfig:()=>W(n),getRoleLabel:()=>O(n),ROLES:u,ROLE_OPTIONS:z,hasRole:a=>d(n,a),isFullAdmin:J(n)}}export{Ce as u};
